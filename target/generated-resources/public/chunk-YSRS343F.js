import{a as ta,b as ia,c as na,d as ra,e as oa,f as aa,g as la,h as pa}from"./chunk-F62LGFEM.js";import{Ea as ht,Na as Bn,Oa as Mt,f as ea,ga as yn}from"./chunk-MTO4NPLZ.js";import"./chunk-LLNMKMJT.js";import"./chunk-M6ZSIYLJ.js";import"./chunk-I4LTYMGR.js";import"./chunk-GBVWTJHZ.js";import"./chunk-2AOTBPXD.js";import"./chunk-57DBVAFV.js";import{$a as qo,Aa as xi,Bn as Yo,Ca as sn,Da as _i,Dh as Cn,Fa as dn,Fh as Po,Ga as Si,Ha as Fi,Hh as ri,Ja as Vo,Jh as wo,Ka as R,Kl as vt,Mb as un,Mc as fn,Nb as cn,Ob as Bo,Pb as Oo,Pn as Wo,Qc as Qe,Qm as Ho,Rh as It,Rm as zo,Rn as Xo,Sm as Qo,Uc as Je,Wc as ge,Xh as mt,Yh as oi,_h as ai,ab as ko,de as N,ed as qt,fc as Ro,g as Z,gn as Et,ha as pn,he as J,ia as Do,ie as Lt,ja as mn,jb as de,je as gn,l as nn,m as it,n as nt,nj as Go,o as rn,p as rt,pj as Ii,q as Ao,qc as at,rc as kn,sl as jo,so as Zo,ul as Uo,uo as Be,ve as Lo,wl as Ko,xa as Ge,xn as Jo,ym as li,yn as $o,zd as ni}from"./chunk-ZGSNLXDV.js";import{R as pt}from"./chunk-NFY77JBK.js";import"./chunk-QR6ZNJZ6.js";import{$c as Ti,Bc as u,Dc as bi,Ec as S,Fc as x,Gc as on,Ka as Oi,Kc as ei,Mc as fe,Nc as ti,Oc as _,P as Ct,Pc as Vt,Qc as an,Rc as E,T as yt,Vc as ot,Wc as ve,Xa as Ri,Xc as A,Ya as Li,ad as ln,bd as w,cd as G,dc as W,hd as B,id as Q,jd as se,kc as we,ld as oe,oc as _e,od as q,sd as ee,td as ii,uc as X,xc as Se,yc as O,zc as ze}from"./chunk-HBCL52P7.js";import"./chunk-OG6B6UFA.js";import{A as I,J as _o,K as So,M as Fo,N as Io,Y as et,a as ce,ab as Zt,bb as Eo,ca as xt,cb as Mo,db as tn,fa as Xt,jc as tt,m as vi,ob as Bi,pb as No,y as le,z as D}from"./chunk-HA3FE6NY.js";import{$c as c,$e as Y,Ac as a,Bc as n,C as Wi,Cc as f,Dc as go,E as ao,Ea as ue,Ec as Co,Fc as ki,Ga as Ye,Gc as pe,Jb as Pe,Jc as $,Lb as co,Lc as v,Ma as so,Mc as yo,Nc as vo,Ng as en,Oc as h,Pb as r,Qb as y,Qc as ho,Sc as De,Ta as T,Tc as Ve,Ua as We,Uc as qe,Yc as Xe,Zc as l,_c as V,bb as uo,cb as ie,db as ne,dc as M,ed as xe,hd as Ze,ib as yi,id as he,jb as Oe,jc as g,jd as Fe,je as z,kd as Yt,ke as k,kg as F,lb as gt,le as Xi,md as bo,me as Zi,mg as qn,oc as p,od as m,og as hi,pc as fo,pd as s,pe as To,ph as Dt,q as Ke,qa as lo,qc as He,qd as ae,qe as Wt,qg as xo,r as je,td as Rt,ua as po,vc as zt,ve as ke,w as Vn,xc as Qt,ya as mo,yc as Jt,zc as $t}from"./chunk-PQ6EZO2H.js";import{a as Kt,b as Ht,i as b}from"./chunk-GHMOB5KC.js";b();b();b();var On=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.emptyConfigForm}onConfigurationSet(e){this.emptyConfigForm=this.fb.group({})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-node-empty-config"]],features:[M],decls:1,vars:0,template:function(i,o){i&1&&f(0,"div")},encapsulation:2})}}return t})();b();b();b();var pi=tn/Zt,be=function(t){return t.ON_EVERY_MESSAGE="ON_EVERY_MESSAGE",t.DEDUPLICATE="DEDUPLICATE",t.WEBSOCKETS_ONLY="WEBSOCKETS_ONLY",t.ADVANCED="ADVANCED",t.SKIP="SKIP",t}(be||{}),Ei=new Map([[be.ON_EVERY_MESSAGE,"rule-node-config.save-time-series.strategy-type.every-message"],[be.DEDUPLICATE,"rule-node-config.save-time-series.strategy-type.deduplicate"],[be.WEBSOCKETS_ONLY,"rule-node-config.save-time-series.strategy-type.web-sockets-only"],[be.SKIP,"rule-node-config.save-time-series.strategy-type.skip"]]),di={type:be.ON_EVERY_MESSAGE},Rn={timeseries:di,latest:di,webSockets:di,calculatedFields:di};b();var Ln={type:be.ON_EVERY_MESSAGE},Pn={attributes:Ln,webSockets:Ln,calculatedFields:Ln};b();b();var dt=function(t){return t.CUSTOMER="CUSTOMER",t.TENANT="TENANT",t.RELATED="RELATED",t.ALARM_ORIGINATOR="ALARM_ORIGINATOR",t.ENTITY="ENTITY",t}(dt||{}),ma=new Map([[dt.CUSTOMER,"rule-node-config.originator-customer"],[dt.TENANT,"rule-node-config.originator-tenant"],[dt.RELATED,"rule-node-config.originator-related"],[dt.ALARM_ORIGINATOR,"rule-node-config.originator-alarm-originator"],[dt.ENTITY,"rule-node-config.originator-entity"]]),sa=new Map([[dt.CUSTOMER,"rule-node-config.originator-customer-desc"],[dt.TENANT,"rule-node-config.originator-tenant-desc"],[dt.RELATED,"rule-node-config.originator-related-entity-desc"],[dt.ALARM_ORIGINATOR,"rule-node-config.originator-alarm-originator-desc"],[dt.ENTITY,"rule-node-config.originator-entity-by-name-pattern-desc"]]),Ai=[et.createdTime,et.name,{value:"type",name:"rule-node-config.profile-name",keyName:"originatorProfileName"},et.firstName,et.lastName,et.email,et.title,et.country,et.state,et.city,et.address,et.address2,et.zip,et.phone,et.label,{value:"id",name:"rule-node-config.id",keyName:"id"},{value:"additionalInfo",name:"rule-node-config.additional-info",keyName:"additionalInfo"}],da=new Map([["type","profileName"],["createdTime","createdTime"],["name","name"],["firstName","firstName"],["lastName","lastName"],["email","email"],["title","title"],["country","country"],["state","state"],["city","city"],["address","address"],["address2","address2"],["zip","zip"],["phone","phone"],["label","label"],["id","id"],["additionalInfo","additionalInfo"]]),_t=function(t){return t.CIRCLE="CIRCLE",t.POLYGON="POLYGON",t}(_t||{}),vn=new Map([[_t.CIRCLE,"rule-node-config.perimeter-circle"],[_t.POLYGON,"rule-node-config.perimeter-polygon"]]),Re=function(t){return t.MILLISECONDS="MILLISECONDS",t.SECONDS="SECONDS",t.MINUTES="MINUTES",t.HOURS="HOURS",t.DAYS="DAYS",t}(Re||{}),Di=new Map([[Re.MILLISECONDS,"rule-node-config.time-unit-milliseconds"],[Re.SECONDS,"rule-node-config.time-unit-seconds"],[Re.MINUTES,"rule-node-config.time-unit-minutes"],[Re.HOURS,"rule-node-config.time-unit-hours"],[Re.DAYS,"rule-node-config.time-unit-days"]]),kt=function(t){return t.METER="METER",t.KILOMETER="KILOMETER",t.FOOT="FOOT",t.MILE="MILE",t.NAUTICAL_MILE="NAUTICAL_MILE",t}(kt||{}),hn=new Map([[kt.METER,"rule-node-config.range-unit-meter"],[kt.KILOMETER,"rule-node-config.range-unit-kilometer"],[kt.FOOT,"rule-node-config.range-unit-foot"],[kt.MILE,"rule-node-config.range-unit-mile"],[kt.NAUTICAL_MILE,"rule-node-config.range-unit-nautical-mile"]]),st=function(t){return t.ID="ID",t.TITLE="TITLE",t.COUNTRY="COUNTRY",t.STATE="STATE",t.CITY="CITY",t.ZIP="ZIP",t.ADDRESS="ADDRESS",t.ADDRESS2="ADDRESS2",t.PHONE="PHONE",t.EMAIL="EMAIL",t.ADDITIONAL_INFO="ADDITIONAL_INFO",t}(st||{}),ua=new Map([[st.ID,"rule-node-config.entity-details-id"],[st.TITLE,"rule-node-config.entity-details-title"],[st.COUNTRY,"rule-node-config.entity-details-country"],[st.STATE,"rule-node-config.entity-details-state"],[st.CITY,"rule-node-config.entity-details-city"],[st.ZIP,"rule-node-config.entity-details-zip"],[st.ADDRESS,"rule-node-config.entity-details-address"],[st.ADDRESS2,"rule-node-config.entity-details-address2"],[st.PHONE,"rule-node-config.entity-details-phone"],[st.EMAIL,"rule-node-config.entity-details-email"],[st.ADDITIONAL_INFO,"rule-node-config.entity-details-additional_info"]]),bt=function(t){return t.FIRST="FIRST",t.LAST="LAST",t.ALL="ALL",t}(bt||{}),Pi=new Map([[bt.FIRST,"rule-node-config.first"],[bt.LAST,"rule-node-config.last"],[bt.ALL,"rule-node-config.all"]]),ca=new Map([[bt.FIRST,"rule-node-config.first-mode-hint"],[bt.LAST,"rule-node-config.last-mode-hint"],[bt.ALL,"rule-node-config.all-mode-hint"]]),Mi=function(t){return t.ASC="ASC",t.DESC="DESC",t}(Mi||{}),Me=function(t){return t.ATTRIBUTES="ATTRIBUTES",t.LATEST_TELEMETRY="LATEST_TELEMETRY",t.FIELDS="FIELDS",t}(Me||{}),wt=new Map([[Me.ATTRIBUTES,"rule-node-config.attributes"],[Me.LATEST_TELEMETRY,"rule-node-config.latest-telemetry"],[Me.FIELDS,"rule-node-config.fields"]]),fa=new Map([[Me.ATTRIBUTES,"rule-node-config.add-mapped-attribute-to"],[Me.LATEST_TELEMETRY,"rule-node-config.add-mapped-latest-telemetry-to"],[Me.FIELDS,"rule-node-config.add-mapped-fields-to"]]),ga=new Map([[Mi.ASC,"rule-node-config.ascending"],[Mi.DESC,"rule-node-config.descending"]]),Ni=function(t){return t.STANDARD="STANDARD",t.FIFO="FIFO",t}(Ni||{}),Ca=new Map([[Ni.STANDARD,"rule-node-config.sqs-queue-standard"],[Ni.FIFO,"rule-node-config.sqs-queue-fifo"]]),ya=["anonymous","basic","cert.PEM"],va=new Map([["anonymous","rule-node-config.credentials-anonymous"],["basic","rule-node-config.credentials-basic"],["cert.PEM","rule-node-config.credentials-pem"]]),ha=["sas","cert.PEM"],ba=new Map([["sas","rule-node-config.credentials-sas"],["cert.PEM","rule-node-config.credentials-pem"]]),Gn=function(t){return t.GET="GET",t.POST="POST",t.PUT="PUT",t.DELETE="DELETE",t}(Gn||{}),Ta=["US-ASCII","ISO-8859-1","UTF-8","UTF-16BE","UTF-16LE","UTF-16"],xa=new Map([["US-ASCII","rule-node-config.charset-us-ascii"],["ISO-8859-1","rule-node-config.charset-iso-8859-1"],["UTF-8","rule-node-config.charset-utf-8"],["UTF-16BE","rule-node-config.charset-utf-16be"],["UTF-16LE","rule-node-config.charset-utf-16le"],["UTF-16","rule-node-config.charset-utf-16"]]),K=function(t){return t.CUSTOM="CUSTOM",t.ADD="ADD",t.SUB="SUB",t.MULT="MULT",t.DIV="DIV",t.SIN="SIN",t.SINH="SINH",t.COS="COS",t.COSH="COSH",t.TAN="TAN",t.TANH="TANH",t.ACOS="ACOS",t.ASIN="ASIN",t.ATAN="ATAN",t.ATAN2="ATAN2",t.EXP="EXP",t.EXPM1="EXPM1",t.SQRT="SQRT",t.CBRT="CBRT",t.GET_EXP="GET_EXP",t.HYPOT="HYPOT",t.LOG="LOG",t.LOG10="LOG10",t.LOG1P="LOG1P",t.CEIL="CEIL",t.FLOOR="FLOOR",t.FLOOR_DIV="FLOOR_DIV",t.FLOOR_MOD="FLOOR_MOD",t.ABS="ABS",t.MIN="MIN",t.MAX="MAX",t.POW="POW",t.SIGNUM="SIGNUM",t.RAD="RAD",t.DEG="DEG",t}(K||{}),wi=new Map([[K.CUSTOM,{value:K.CUSTOM,name:"Custom Function",description:"Use this function to specify complex mathematical expression.",minArgs:1,maxArgs:16}],[K.ADD,{value:K.ADD,name:"Addition",description:"x + y",minArgs:2,maxArgs:2}],[K.SUB,{value:K.SUB,name:"Subtraction",description:"x - y",minArgs:2,maxArgs:2}],[K.MULT,{value:K.MULT,name:"Multiplication",description:"x * y",minArgs:2,maxArgs:2}],[K.DIV,{value:K.DIV,name:"Division",description:"x / y",minArgs:2,maxArgs:2}],[K.SIN,{value:K.SIN,name:"Sine",description:"Returns the trigonometric sine of an angle in radians.",minArgs:1,maxArgs:1}],[K.SINH,{value:K.SINH,name:"Hyperbolic sine",description:"Returns the hyperbolic sine of an argument.",minArgs:1,maxArgs:1}],[K.COS,{value:K.COS,name:"Cosine",description:"Returns the trigonometric cosine of an angle in radians.",minArgs:1,maxArgs:1}],[K.COSH,{value:K.COSH,name:"Hyperbolic cosine",description:"Returns the hyperbolic cosine of an argument.",minArgs:1,maxArgs:1}],[K.TAN,{value:K.TAN,name:"Tangent",description:"Returns the trigonometric tangent of an angle in radians",minArgs:1,maxArgs:1}],[K.TANH,{value:K.TANH,name:"Hyperbolic tangent",description:"Returns the hyperbolic tangent of an argument",minArgs:1,maxArgs:1}],[K.ACOS,{value:K.ACOS,name:"Arc cosine",description:"Returns the arc cosine of an argument",minArgs:1,maxArgs:1}],[K.ASIN,{value:K.ASIN,name:"Arc sine",description:"Returns the arc sine of an argument",minArgs:1,maxArgs:1}],[K.ATAN,{value:K.ATAN,name:"Arc tangent",description:"Returns the arc tangent of an argument",minArgs:1,maxArgs:1}],[K.ATAN2,{value:K.ATAN2,name:"2-argument arc tangent",description:"Returns the angle theta from the conversion of rectangular coordinates (x, y) to polar coordinates (r, theta)",minArgs:2,maxArgs:2}],[K.EXP,{value:K.EXP,name:"Exponential",description:"Returns Euler's number e raised to the power of an argument",minArgs:1,maxArgs:1}],[K.EXPM1,{value:K.EXPM1,name:"Exponential minus one",description:"Returns Euler's number e raised to the power of an argument minus one",minArgs:1,maxArgs:1}],[K.SQRT,{value:K.SQRT,name:"Square",description:"Returns the correctly rounded positive square root of an argument",minArgs:1,maxArgs:1}],[K.CBRT,{value:K.CBRT,name:"Cube root",description:"Returns the cube root of an argument",minArgs:1,maxArgs:1}],[K.GET_EXP,{value:K.GET_EXP,name:"Get exponent",description:"Returns the unbiased exponent used in the representation of an argument",minArgs:1,maxArgs:1}],[K.HYPOT,{value:K.HYPOT,name:"Square root",description:"Returns the square root of the squares of the arguments",minArgs:2,maxArgs:2}],[K.LOG,{value:K.LOG,name:"Logarithm",description:"Returns the natural logarithm of an argument",minArgs:1,maxArgs:1}],[K.LOG10,{value:K.LOG10,name:"Base 10 logarithm",description:"Returns the base 10 logarithm of an argument",minArgs:1,maxArgs:1}],[K.LOG1P,{value:K.LOG1P,name:"Logarithm of the sum",description:"Returns the natural logarithm of the sum of an argument",minArgs:1,maxArgs:1}],[K.CEIL,{value:K.CEIL,name:"Ceiling",description:"Returns the smallest (closest to negative infinity) of an argument",minArgs:1,maxArgs:1}],[K.FLOOR,{value:K.FLOOR,name:"Floor",description:"Returns the largest (closest to positive infinity) of an argument",minArgs:1,maxArgs:1}],[K.FLOOR_DIV,{value:K.FLOOR_DIV,name:"Floor division",description:"Returns the largest (closest to positive infinity) of the arguments",minArgs:2,maxArgs:2}],[K.FLOOR_MOD,{value:K.FLOOR_MOD,name:"Floor modulus",description:"Returns the floor modulus of the arguments",minArgs:2,maxArgs:2}],[K.ABS,{value:K.ABS,name:"Absolute",description:"Returns the absolute value of an argument",minArgs:1,maxArgs:1}],[K.MIN,{value:K.MIN,name:"Min",description:"Returns the smaller of the arguments",minArgs:2,maxArgs:2}],[K.MAX,{value:K.MAX,name:"Max",description:"Returns the greater of the arguments",minArgs:2,maxArgs:2}],[K.POW,{value:K.POW,name:"Raise to a power",description:"Returns the value of the first argument raised to the power of the second argument",minArgs:2,maxArgs:2}],[K.SIGNUM,{value:K.SIGNUM,name:"Sign of a real number",description:"Returns the signum function of the argument",minArgs:1,maxArgs:1}],[K.RAD,{value:K.RAD,name:"Radian",description:"Converts an angle measured in degrees to an approximately equivalent angle measured in radians",minArgs:1,maxArgs:1}],[K.DEG,{value:K.DEG,name:"Degrees",description:"Converts an angle measured in radians to an approximately equivalent angle measured in degrees.",minArgs:1,maxArgs:1}]]),Nt=function(t){return t.MESSAGE_BODY="MESSAGE_BODY",t.MESSAGE_METADATA="MESSAGE_METADATA",t.ATTRIBUTE="ATTRIBUTE",t.TIME_SERIES="TIME_SERIES",t.CONSTANT="CONSTANT",t}(Nt||{}),Pt=function(t){return t.MESSAGE_BODY="MESSAGE_BODY",t.MESSAGE_METADATA="MESSAGE_METADATA",t.ATTRIBUTE="ATTRIBUTE",t.TIME_SERIES="TIME_SERIES",t}(Pt||{}),ye=function(t){return t.DATA="DATA",t.METADATA="METADATA",t}(ye||{}),_a=new Map([[ye.DATA,"rule-node-config.message-to-metadata"],[ye.METADATA,"rule-node-config.metadata-to-message"]]),Uf=new Map([[ye.DATA,"rule-node-config.from-message"],[ye.METADATA,"rule-node-config.from-metadata"]]),bn=new Map([[ye.DATA,"rule-node-config.message"],[ye.METADATA,"rule-node-config.metadata"]]),Sa=new Map([[ye.DATA,"rule-node-config.message"],[ye.METADATA,"rule-node-config.message-metadata"]]),Fa=new Map([[Nt.MESSAGE_BODY,{name:"rule-node-config.message-body-type",description:"rule-node-config.message-body-type-description"}],[Nt.MESSAGE_METADATA,{name:"rule-node-config.message-metadata-type",description:"rule-node-config.message-metadata-type-description"}],[Nt.ATTRIBUTE,{name:"rule-node-config.attribute-type",description:"rule-node-config.attribute-type-description"}],[Nt.TIME_SERIES,{name:"rule-node-config.time-series-type",description:"rule-node-config.time-series-type-description"}],[Nt.CONSTANT,{name:"rule-node-config.constant-type",description:"rule-node-config.constant-type-description"}]]),Ia=new Map([[Pt.MESSAGE_BODY,{name:"rule-node-config.message-body-type",description:"rule-node-config.message-body-type-result-description"}],[Pt.MESSAGE_METADATA,{name:"rule-node-config.message-metadata-type",description:"rule-node-config.message-metadata-result-description"}],[Pt.ATTRIBUTE,{name:"rule-node-config.attribute-type",description:"rule-node-config.attribute-type-result-description"}],[Pt.TIME_SERIES,{name:"rule-node-config.time-series-type",description:"rule-node-config.time-series-type-result-description"}]]),jn=["x","y","z","a","b","c","d","k","l","m","n","o","p","r","s","t"],ui=function(t){return t.SHARED_SCOPE="SHARED_SCOPE",t.SERVER_SCOPE="SERVER_SCOPE",t.CLIENT_SCOPE="CLIENT_SCOPE",t}(ui||{}),Un=function(t){return t.SHARED_SCOPE="SHARED_SCOPE",t.SERVER_SCOPE="SERVER_SCOPE",t}(Un||{}),Tn=new Map([[ui.SHARED_SCOPE,"rule-node-config.shared-scope"],[ui.SERVER_SCOPE,"rule-node-config.server-scope"],[ui.CLIENT_SCOPE,"rule-node-config.client-scope"]]),wn=function(t){return t.ON_FIRST_MESSAGE="ON_FIRST_MESSAGE",t.ON_EACH_MESSAGE="ON_EACH_MESSAGE",t}(wn||{}),Ea=new Map([[wn.ON_EACH_MESSAGE,{value:!0,name:"rule-node-config.presence-monitoring-strategy-on-each-message"}],[wn.ON_FIRST_MESSAGE,{value:!1,name:"rule-node-config.presence-monitoring-strategy-on-first-message"}]]),Gi=2147483648;var Ja=[[["","matSuffix",""]]],$a=["[matSuffix]"];function Ya(t,d){if(t&1&&(a(0,"mat-label"),l(1),n()),t&2){let e=v();r(),V(e.labelText)}}function Wa(t,d){t&1&&f(0,"mat-hint")}function Xa(t,d){if(t&1&&(a(0,"mat-error"),l(1),n()),t&2){let e=v();r(),c(" ",e.requiredText," ")}}function Za(t,d){if(t&1&&(a(0,"mat-error"),l(1),n()),t&2){let e=v();r(),c(" ",e.minErrorText," ")}}function el(t,d){if(t&1&&(a(0,"mat-error"),l(1),n()),t&2){let e=v();r(),c(" ",e.maxErrorText," ")}}function tl(t,d){if(t&1&&(a(0,"mat-option",8),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),V(s(2,2,i.timeUnitTranslations.get(e)))}}var Tt=class t{constructor(d,e){this.fb=d,this.destroyRef=e,this.minTime=0,this.subscriptSizing="fixed",this.timeUnits=Object.values(Re).filter(i=>i!==Re.MILLISECONDS),this.timeUnitTranslations=Di,this.timeInputForm=this.fb.group({time:[0],timeUnit:[Re.SECONDS]}),this.timeIntervalsInSec=new Map([[Re.DAYS,tn/Zt],[Re.HOURS,Mo/Zt],[Re.MINUTES,Eo/Zt],[Re.SECONDS,Zt/Zt]]),this.propagateChange=()=>{}}ngOnInit(){if(this.required||this.maxTime){let d=this.timeInputForm.get("time"),e=[u.pattern(/^\d*$/)];this.required&&e.push(u.required),this.maxTime&&e.push(i=>u.max(Math.floor(this.maxTime/this.timeIntervalsInSec.get(this.timeInputForm.get("timeUnit").value)))(i)),F(this.minTime)&&e.push(u.min(this.minTime)),d.setValidators(e),d.updateValueAndValidity({emitEvent:!1})}this.timeInputForm.get("timeUnit").valueChanges.pipe(ce(this.destroyRef)).subscribe(()=>{this.timeInputForm.get("time").updateValueAndValidity({onlySelf:!0}),this.timeInputForm.get("time").markAsTouched({onlySelf:!0})}),this.timeInputForm.valueChanges.pipe(ce(this.destroyRef)).subscribe(d=>{this.updatedModel(d)})}registerOnChange(d){this.propagateChange=d}registerOnTouched(d){}setDisabledState(d){d?this.timeInputForm.disable({emitEvent:!1}):(this.timeInputForm.enable({emitEvent:!1}),this.timeInputForm.invalid&&setTimeout(()=>this.updatedModel(this.timeInputForm.value,!0)))}writeValue(d){d!==this.modelValue&&(F(d)&&xo(d)&&Number(d)!==0?(this.timeInputForm.patchValue(this.parseTime(d),{emitEvent:!1}),this.modelValue=d):(this.timeInputForm.patchValue({time:0,timeUnit:Re.SECONDS},{emitEvent:!1}),this.modelValue=0))}validate(){return this.timeInputForm.valid?null:{timeInput:!1}}updatedModel(d,e=!1){let i=F(d.time)?d.time*this.timeIntervalsInSec.get(d.timeUnit):null;(this.modelValue!==i||e)&&(this.modelValue=i,this.propagateChange(i))}parseTime(d){for(let[e,i]of this.timeIntervalsInSec){let o=d/i;if(Number.isInteger(o))return{time:o,timeUnit:e}}}static{this.\u0275fac=function(e){return new(e||t)(y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-time-unit-input"]],inputs:{labelText:"labelText",required:"required",requiredText:"requiredText",minTime:"minTime",minErrorText:"minErrorText",maxTime:"maxTime",maxErrorText:"maxErrorText",subscriptSizing:"subscriptSizing"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:ue(()=>t),multi:!0}])],ngContentSelectors:$a,decls:16,vars:7,consts:[[1,"flex","gap-4",3,"formGroup"],["subscriptSizing","dynamic",1,"max-w-66%","flex-full"],[4,"ngIf"],["type","number","min","0","step","1","matInput","","formControlName","time"],["matSuffix",""],[1,"h-fit","max-w-33%","flex-full",3,"subscriptSizing"],["translate",""],["formControlName","timeUnit"],[3,"value"]],template:function(e,i){e&1&&(yo(Ja),a(0,"section",0)(1,"mat-form-field",1),g(2,Ya,2,1,"mat-label",2),f(3,"input",3),a(4,"div",4),vo(5),n(),g(6,Wa,1,0,"mat-hint",2)(7,Xa,2,1,"mat-error",2)(8,Za,2,1,"mat-error",2)(9,el,2,1,"mat-error",2),n(),a(10,"mat-form-field",5)(11,"mat-label",6),l(12,"rule-node-config.units"),n(),a(13,"mat-select",7),Jt(14,tl,3,4,"mat-option",8,Qt),n()()()),e&2&&(p("formGroup",i.timeInputForm),r(2),p("ngIf",i.labelText),r(4),p("ngIf",i.subscriptSizing==="fixed"),r(),p("ngIf",i.timeInputForm.get("time").hasError("required")&&i.requiredText),r(),p("ngIf",i.timeInputForm.get("time").hasError("min")&&i.minErrorText),r(),p("ngIf",i.timeInputForm.get("time").hasError("max")&&i.maxErrorText),r(),p("subscriptSizing",i.subscriptSizing),r(4),$t(i.timeUnits))},dependencies:[k,R,q,B,se,Q,oe,ee,W,O,fe,S,x,ve,_,E,D,I],encapsulation:2})}};Ke([at(),je("design:type",Boolean)],Tt.prototype,"required",void 0);Ke([kn(),je("design:type",Object)],Tt.prototype,"minTime",void 0);Ke([kn(),je("design:type",Number)],Tt.prototype,"maxTime",void 0);b();b();var il=()=>({maxWidth:"820px"});function nl(t,d){if(t&1&&(f(0,"div",3),m(1,"translate")),t&2){let e=v();h("tb-help-popup",e.popupHelpLink),h("trigger-text",s(1,3,"rule-node-config.key-val.see-examples")),p("tb-help-popup-style",he(5,il))}}var Te=(()=>{class t{constructor(){this.textAlign="left"}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=T({type:t,selectors:[["tb-example-hint"]],inputs:{hintText:"hintText",popupHelpLink:"popupHelpLink",textAlign:"textAlign"},decls:5,vars:10,consts:[[1,"tb-form-hint","tb-primary-fill","flex","justify-between","gap-5",3,"hidden"],[1,"w-full",3,"innerHTML"],["class","flex shrink-0","hintMode","","tb-help-popup-placement","right","trigger-style","letter-spacing:0.25px; font-size:12px",3,"tb-help-popup","tb-help-popup-style","trigger-text",4,"ngIf"],["hintMode","","tb-help-popup-placement","right","trigger-style","letter-spacing:0.25px; font-size:12px",1,"flex","shrink-0",3,"tb-help-popup","tb-help-popup-style","trigger-text"]],template:function(i,o){i&1&&(a(0,"div",0),f(1,"div",1),m(2,"translate"),m(3,"safe"),g(4,nl,2,6,"div",2),n()),i&2&&(p("hidden",!o.hintText),r(),fo("text-align",o.textAlign),p("innerHTML",ae(3,7,s(2,5,o.hintText),"html"),Pe),r(3),p("ngIf",o.popupHelpLink))},dependencies:[k,ni,pt,I],encapsulation:2})}}return t})();b();function rl(t,d){if(t&1&&(a(0,"mat-option",4),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),V(s(2,2,i.ProcessingTypeTranslationMap.get(e)))}}function ol(t,d){if(t&1&&(f(0,"tb-time-unit-input",5),m(1,"translate"),m(2,"translate"),m(3,"translate"),m(4,"translate")),t&2){let e=v();h("labelText",s(1,6,"rule-node-config.save-time-series.deduplication-interval")),h("requiredText",s(2,8,"rule-node-config.save-time-series.deduplication-interval-required")),h("minErrorText",s(3,10,"rule-node-config.save-time-series.deduplication-interval-min-max-range")),h("maxErrorText",s(4,12,"rule-node-config.save-time-series.deduplication-interval-min-max-range")),p("minTime",1)("maxTime",e.maxDeduplicateTime)}}var xn=(()=>{class t{constructor(e){this.fb=e,this.processingSettingRowForm=this.fb.group({type:[di.type],deduplicationIntervalSecs:[{value:60,disabled:!0}]}),this.ProcessingType=be,this.processingStrategies=[be.ON_EVERY_MESSAGE,be.DEDUPLICATE,be.SKIP],this.ProcessingTypeTranslationMap=Ei,this.maxDeduplicateTime=pi,this.propagateChange=()=>{},this.processingSettingRowForm.get("type").valueChanges.pipe(ce()).subscribe(()=>this.updatedValidation()),this.processingSettingRowForm.valueChanges.pipe(ce()).subscribe(i=>this.propagateChange(i))}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}setDisabledState(e){e?this.processingSettingRowForm.disable({emitEvent:!1}):(this.processingSettingRowForm.enable({emitEvent:!1}),this.updatedValidation())}validate(){return this.processingSettingRowForm.valid?null:{processingSettingRow:!1}}writeValue(e){F(e)?this.processingSettingRowForm.patchValue(e,{emitEvent:!1}):this.processingSettingRowForm.patchValue(di)}updatedValidation(){this.processingSettingRowForm.get("type").value===be.DEDUPLICATE?this.processingSettingRowForm.get("deduplicationIntervalSecs").enable({emitEvent:!1}):this.processingSettingRowForm.get("deduplicationIntervalSecs").disable({emitEvent:!1})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-advanced-processing-setting-row"]],inputs:{title:"title"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:ue(()=>t),multi:!0}])],decls:10,vars:3,consts:[[1,"tb-form-panel","stroked","no-gap","no-padding-bottom",3,"formGroup"],[1,"tb-form-panel-title","mb-4"],["translate",""],["formControlName","type"],[3,"value"],["required","","formControlName","deduplicationIntervalSecs",3,"labelText","requiredText","minErrorText","maxErrorText","minTime","maxTime"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),l(2),n(),a(3,"mat-form-field")(4,"mat-label",2),l(5,"rule-node-config.save-time-series.strategy"),n(),a(6,"mat-select",3),Jt(7,rl,3,4,"mat-option",4,Qt),n()(),g(9,ol,5,14,"tb-time-unit-input",5),n()),i&2&&(p("formGroup",o.processingSettingRowForm),r(2),V(o.title),r(5),$t(o.processingStrategies),r(2),zt(o.processingSettingRowForm.get("type").value===o.ProcessingType.DEDUPLICATE?9:-1))},dependencies:[q,B,ee,W,S,x,A,_,E,D,Tt,I],encapsulation:2})}}return t})();function ll(t,d){t&1&&(f(0,"tb-advanced-processing-setting-row",7),m(1,"translate")),t&2&&h("title",s(1,1,"rule-node-config.save-time-series.time-series"))}function pl(t,d){t&1&&(f(0,"tb-advanced-processing-setting-row",8),m(1,"translate")),t&2&&h("title",s(1,1,"rule-node-config.save-attribute.attributes"))}function ml(t,d){t&1&&(f(0,"tb-advanced-processing-setting-row",9),m(1,"translate")),t&2&&h("title",s(1,1,"rule-node-config.save-time-series.latest"))}function sl(t,d){t&1&&(f(0,"tb-advanced-processing-setting-row",10),m(1,"translate")),t&2&&h("title",s(1,1,"rule-node-config.save-time-series.web-sockets"))}function dl(t,d){t&1&&(f(0,"tb-advanced-processing-setting-row",11),m(1,"translate")),t&2&&h("title",s(1,1,"rule-node-config.save-time-series.calculated-fields"))}var St=class t{constructor(d,e){this.fb=d,this.destroyRef=e,this.timeseries=!1,this.attributes=!1,this.latest=!1,this.webSockets=!1,this.calculatedFields=!1,this.propagateChange=()=>{}}ngOnInit(){this.processingForm=this.fb.group({}),this.timeseries&&this.processingForm.addControl("timeseries",this.fb.control(null,[])),this.attributes&&this.processingForm.addControl("attributes",this.fb.control(null,[])),this.latest&&this.processingForm.addControl("latest",this.fb.control(null,[])),this.webSockets&&this.processingForm.addControl("webSockets",this.fb.control(null,[])),this.calculatedFields&&this.processingForm.addControl("calculatedFields",this.fb.control(null,[])),this.processingForm.valueChanges.pipe(ce(this.destroyRef)).subscribe(d=>this.propagateChange(d))}registerOnChange(d){this.propagateChange=d}registerOnTouched(d){}setDisabledState(d){d?this.processingForm.disable({emitEvent:!1}):this.processingForm.enable({emitEvent:!1})}validate(){return this.processingForm.valid?null:{processingForm:!1}}writeValue(d){this.processingForm.patchValue(d,{emitEvent:!1})}static{this.\u0275fac=function(e){return new(e||t)(y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-advanced-processing-settings"]],inputs:{timeseries:"timeseries",attributes:"attributes",latest:"latest",webSockets:"webSockets",calculatedFields:"calculatedFields"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:ue(()=>t),multi:!0}])],decls:7,vars:8,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],[3,"hintText","popupHelpLink"],["formControlName","timeseries",3,"title",4,"ngIf"],["formControlName","attributes",3,"title",4,"ngIf"],["formControlName","latest",3,"title",4,"ngIf"],["formControlName","webSockets",3,"title",4,"ngIf"],["formControlName","calculatedFields",3,"title",4,"ngIf"],["formControlName","timeseries",3,"title"],["formControlName","attributes",3,"title"],["formControlName","latest",3,"title"],["formControlName","webSockets",3,"title"],["formControlName","calculatedFields",3,"title"]],template:function(e,i){e&1&&(a(0,"section",0),f(1,"tb-example-hint",1),g(2,ll,2,3,"tb-advanced-processing-setting-row",2)(3,pl,2,3,"tb-advanced-processing-setting-row",3)(4,ml,2,3,"tb-advanced-processing-setting-row",4)(5,sl,2,3,"tb-advanced-processing-setting-row",5)(6,dl,2,3,"tb-advanced-processing-setting-row",6),n()),e&2&&(p("formGroup",i.processingForm),r(),p("hintText","rule-node-config.save-time-series.advanced-settings-hint")("popupHelpLink",i.timeseries?"rulenode/save_timeseries_node_advanced":"rulenode/save_attributes_node_advanced"),r(),p("ngIf",i.timeseries),r(),p("ngIf",i.attributes),r(),p("ngIf",i.latest),r(),p("ngIf",i.webSockets),r(),p("ngIf",i.calculatedFields))},dependencies:[k,S,x,_,E,Te,xn,I],encapsulation:2})}};Ke([at(),je("design:type",Object)],St.prototype,"timeseries",void 0);Ke([at(),je("design:type",Object)],St.prototype,"attributes",void 0);Ke([at(),je("design:type",Object)],St.prototype,"latest",void 0);Ke([at(),je("design:type",Object)],St.prototype,"webSockets",void 0);Ke([at(),je("design:type",Object)],St.prototype,"calculatedFields",void 0);var ul=()=>({standalone:!0});function cl(t,d){if(t&1&&(a(0,"mat-option",5),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),V(s(2,2,i.ProcessingTypeTranslationMap.get(e)))}}function fl(t,d){if(t&1&&(f(0,"tb-time-unit-input",21),m(1,"translate"),m(2,"translate"),m(3,"translate"),m(4,"translate")),t&2){let e=v(2);h("labelText",s(1,6,"rule-node-config.save-attribute.deduplication-interval")),h("requiredText",s(2,8,"rule-node-config.save-attribute.deduplication-interval-required")),h("minErrorText",s(3,10,"rule-node-config.save-attribute.deduplication-interval-min-max-range")),h("maxErrorText",s(4,12,"rule-node-config.save-attribute.deduplication-interval-min-max-range")),p("maxTime",e.maxDeduplicateTime)("minTime",1)}}function gl(t,d){if(t&1&&(a(0,"mat-form-field")(1,"mat-label",16),l(2,"rule-node-config.save-attribute.strategy"),n(),a(3,"mat-select",20),Jt(4,cl,3,4,"mat-option",5,Qt),n()(),g(6,fl,5,14,"tb-time-unit-input",21)),t&2){let e=v();r(4),$t(e.processingStrategies),r(2),zt(e.attributesConfigForm.get("processingSettings.type").value===e.ProcessingType.DEDUPLICATE?6:-1)}}function Cl(t,d){t&1&&f(0,"tb-advanced-processing-settings",6)}function yl(t,d){if(t&1&&(a(0,"mat-option",5),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.telemetryTypeTranslationsMap.get(e))," ")}}function vl(t,d){t&1&&(a(0,"div",17),m(1,"translate"),a(2,"mat-slide-toggle",22),l(3),m(4,"translate"),n()()),t&2&&(h("tb-hint-tooltip-icon",s(1,2,"rule-node-config.send-attributes-updated-notification-hint")),r(3),c(" ",s(4,4,"rule-node-config.send-attributes-updated-notification")," "))}function hl(t,d){t&1&&(a(0,"div",17),m(1,"translate"),a(2,"mat-slide-toggle",23),l(3),m(4,"translate"),n()()),t&2&&(h("tb-hint-tooltip-icon",s(1,2,"rule-node-config.notify-device-on-update-hint")),r(3),c(" ",s(4,4,"rule-node-config.notify-device")," "))}var zn=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.attributeScopeMap=xt,this.attributeScopes=Object.keys(xt),this.telemetryTypeTranslationsMap=Xt,this.ProcessingType=be,this.processingStrategies=[be.ON_EVERY_MESSAGE,be.DEDUPLICATE,be.WEBSOCKETS_ONLY],this.ProcessingTypeTranslationMap=Ei,this.maxDeduplicateTime=pi}configForm(){return this.attributesConfigForm}validatorTriggers(){return["processingSettings.isAdvanced","processingSettings.type"]}prepareInputConfig(e){let i;if(e?.processingSettings){let o=e?.processingSettings?.type===be.ADVANCED;i={type:o?be.ON_EVERY_MESSAGE:e.processingSettings.type,isAdvanced:o,deduplicationIntervalSecs:e.processingSettings?.deduplicationIntervalSecs??60,advanced:o?e.processingSettings:Pn}}else i={type:be.ON_EVERY_MESSAGE,isAdvanced:!1,deduplicationIntervalSecs:60,advanced:Pn};return Ht(Kt({},e),{processingSettings:i})}prepareOutputConfig(e){let i;return e.processingSettings.isAdvanced?i=Ht(Kt({},e.processingSettings.advanced),{type:be.ADVANCED}):i={type:e.processingSettings.type,deduplicationIntervalSecs:e.processingSettings?.deduplicationIntervalSecs},Ht(Kt({},e),{processingSettings:i})}onConfigurationSet(e){this.attributesConfigForm=this.fb.group({processingSettings:this.fb.group({isAdvanced:[e?.processingSettings?.isAdvanced??!1],type:[e?.processingSettings?.type??be.ON_EVERY_MESSAGE],deduplicationIntervalSecs:[{value:e?.processingSettings?.deduplicationIntervalSecs??60,disabled:!0},[u.required,u.max(pi)]],advanced:[{value:null,disabled:!0}]}),scope:[e?e.scope:null,[u.required]],notifyDevice:[e?e.notifyDevice:!0,[]],sendAttributesUpdatedNotification:[e?e.sendAttributesUpdatedNotification:!1,[]],updateAttributesOnlyOnValueChange:[e?e.updateAttributesOnlyOnValueChange:!1,[]]}),this.attributesConfigForm.get("scope").valueChanges.pipe(ce(this.destroyRef)).subscribe(i=>{i!==xt.SHARED_SCOPE&&this.attributesConfigForm.get("notifyDevice").patchValue(!1,{emitEvent:!1}),i===xt.CLIENT_SCOPE&&this.attributesConfigForm.get("sendAttributesUpdatedNotification").patchValue(!1,{emitEvent:!1}),this.attributesConfigForm.get("updateAttributesOnlyOnValueChange").patchValue(!1,{emitEvent:!1})})}updateValidators(e,i){let o=this.attributesConfigForm.get("processingSettings"),C=o.get("isAdvanced").value,H=o.get("type").value;!C&&H===be.DEDUPLICATE?o.get("deduplicationIntervalSecs").enable({emitEvent:e}):o.get("deduplicationIntervalSecs").disable({emitEvent:e}),C?o.get("advanced").enable({emitEvent:e}):o.get("advanced").disable({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-attributes-config"]],features:[M],decls:47,vars:38,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],["formGroupName","processingSettings",1,"tb-form-panel","stroked","no-padding-bottom","no-gap"],[1,"mb-4","flex","flex-row","items-center","justify-between"],["translate","",1,"tb-form-panel-title",3,"tb-hint-tooltip-icon"],["appearance","fill","selectMediaBreakpoint","xs","formControlName","isAdvanced"],[3,"value"],["formControlName","advanced","attributes","","webSockets","","calculatedFields","",1,"mb-4"],[1,"tb-form-panel","stroked"],[1,"tb-form-row","no-border","no-padding","tb-standard-fields"],["subscriptSizing","dynamic",1,"flex"],["required","","matInput","","formControlName","scope",1,"tb-entity-type-select"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","readonly","","disabled","",3,"ngModel","ngModelOptions"],["type","button","matSuffix","","mat-icon-button","","aria-label","Copy","ngxClipboard","",3,"cbContent","matTooltip"],["aria-hidden","false","aria-label","help-icon"],[1,"tb-settings"],["translate",""],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","updateAttributesOnlyOnValueChange",1,"mat-slide"],["class","tb-form-row no-border no-padding",3,"tb-hint-tooltip-icon",4,"ngIf"],["formControlName","type"],["required","","formControlName","deduplicationIntervalSecs",3,"labelText","requiredText","minErrorText","maxErrorText","maxTime","minTime"],["formControlName","sendAttributesUpdatedNotification",1,"mat-slide"],["formControlName","notifyDevice",1,"mat-slide"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),m(4,"translate"),l(5," rule-node-config.save-attribute.processing-settings "),n(),a(6,"tb-toggle-select",4)(7,"tb-toggle-option",5),l(8),m(9,"translate"),n(),a(10,"tb-toggle-option",5),l(11),m(12,"translate"),n()()(),g(13,gl,7,1)(14,Cl,1,0,"tb-advanced-processing-settings",6),n(),a(15,"div",7)(16,"div",3),m(17,"translate"),l(18," rule-node-config.save-attribute.scope "),n(),a(19,"div",8)(20,"mat-form-field",9)(21,"mat-label"),l(22),m(23,"translate"),n(),a(24,"mat-select",10),g(25,yl,3,4,"mat-option",11),n()(),a(26,"mat-form-field",9)(27,"mat-label"),l(28),m(29,"translate"),n(),f(30,"input",12),a(31,"button",13),m(32,"translate"),a(33,"mat-icon",14),l(34,"content_copy "),n()()()()(),a(35,"section",7)(36,"mat-expansion-panel",15)(37,"mat-expansion-panel-header")(38,"mat-panel-title",16),l(39,"rule-node-config.advanced-settings"),n()(),a(40,"div",17),m(41,"translate"),a(42,"mat-slide-toggle",18),l(43),m(44,"translate"),n()(),g(45,vl,5,6,"div",19)(46,hl,5,6,"div",19),n()()()),i&2&&(p("formGroup",o.attributesConfigForm),r(3),h("tb-hint-tooltip-icon",s(4,19,"rule-node-config.save-attribute.processing-settings-hint")),r(4),p("value",!1),r(),V(s(9,21,"rule-node-config.basic-mode")),r(2),p("value",!0),r(),V(s(12,23,"rule-node-config.advanced-mode")),r(2),zt(o.attributesConfigForm.get("processingSettings.isAdvanced").value?14:13),r(3),h("tb-hint-tooltip-icon",s(17,25,"rule-node-config.attributes-scope-hint")),r(6),V(s(23,27,"rule-node-config.attributes-scope")),r(3),p("ngForOf",o.attributeScopes),r(3),V(s(29,29,"rule-node-config.attributes-scope-value")),r(2),p("ngModel",o.attributesConfigForm.get("scope").value)("ngModelOptions",he(37,ul)),r(),h("matTooltip",s(32,31,"rule-node-config.attributes-scope-value-copy")),p("cbContent",o.attributesConfigForm.get("scope").value),r(9),h("tb-hint-tooltip-icon",s(41,33,o.attributesConfigForm.get("updateAttributesOnlyOnValueChange").value?"rule-node-config.update-attributes-only-on-value-change-hint-enabled":"rule-node-config.update-attributes-only-on-value-change-hint")),r(3),c(" ",s(44,35,"rule-node-config.update-attributes-only-on-value-change")," "),r(2),p("ngIf",o.attributesConfigForm.get("scope").value!==o.attributeScopeMap.CLIENT_SCOPE),r(),p("ngIf",o.attributesConfigForm.get("scope").value===o.attributeScopeMap.SHARED_SCOPE))},dependencies:[z,k,_e,X,R,q,B,oe,ee,W,Z,de,it,nt,rt,qt,O,S,x,A,ei,_,E,Vt,D,Qe,Je,ge,Tt,St,I],encapsulation:2})}}return t})();b();function bl(t,d){if(t&1&&(a(0,"mat-option",5),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),V(s(2,2,i.ProcessingTypeTranslationMap.get(e)))}}function Tl(t,d){if(t&1&&(f(0,"tb-time-unit-input",12),m(1,"translate"),m(2,"translate"),m(3,"translate"),m(4,"translate")),t&2){let e=v(2);h("labelText",s(1,6,"rule-node-config.save-time-series.deduplication-interval")),h("requiredText",s(2,8,"rule-node-config.save-time-series.deduplication-interval-required")),h("minErrorText",s(3,10,"rule-node-config.save-time-series.deduplication-interval-min-max-range")),h("maxErrorText",s(4,12,"rule-node-config.save-time-series.deduplication-interval-min-max-range")),p("maxTime",e.maxDeduplicateTime)("minTime",1)}}function xl(t,d){if(t&1&&(a(0,"mat-form-field")(1,"mat-label",9),l(2,"rule-node-config.save-time-series.strategy"),n(),a(3,"mat-select",11),Jt(4,bl,3,4,"mat-option",5,Qt),n()(),g(6,Tl,5,14,"tb-time-unit-input",12)),t&2){let e=v();r(4),$t(e.processingStrategies),r(2),zt(e.timeseriesConfigForm.get("processingSettings.type").value===e.ProcessingType.DEDUPLICATE?6:-1)}}function _l(t,d){t&1&&f(0,"tb-advanced-processing-settings",6)}function Sl(t,d){t&1&&(a(0,"div",13),m(1,"translate"),a(2,"mat-slide-toggle",14),l(3),m(4,"translate"),n()(),a(5,"tb-time-unit-input",15),m(6,"translate"),m(7,"translate"),m(8,"translate"),a(9,"mat-icon",16),m(10,"translate"),l(11," help "),n()()),t&2&&(h("tb-hint-tooltip-icon",s(1,6,"rule-node-config.use-server-ts-hint")),r(3),c(" ",s(4,8,"rule-node-config.use-server-ts")," "),r(2),h("labelText",s(6,10,"rule-node-config.default-ttl")),h("requiredText",s(7,12,"rule-node-config.default-ttl-required")),h("minErrorText",s(8,14,"rule-node-config.min-default-ttl-message")),r(4),h("matTooltip",s(10,16,"rule-node-config.default-ttl-hint")))}var Qn=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.ProcessingType=be,this.processingStrategies=[be.ON_EVERY_MESSAGE,be.DEDUPLICATE,be.WEBSOCKETS_ONLY],this.ProcessingTypeTranslationMap=Ei,this.maxDeduplicateTime=pi}configForm(){return this.timeseriesConfigForm}validatorTriggers(){return["processingSettings.isAdvanced","processingSettings.type"]}prepareInputConfig(e){let i;if(e?.processingSettings){let o=e?.processingSettings?.type===be.ADVANCED;i={type:o?be.ON_EVERY_MESSAGE:e.processingSettings.type,isAdvanced:o,deduplicationIntervalSecs:e.processingSettings?.deduplicationIntervalSecs??60,advanced:o?e.processingSettings:Rn}}else i={type:be.ON_EVERY_MESSAGE,isAdvanced:!1,deduplicationIntervalSecs:60,advanced:Rn};return Ht(Kt({},e),{processingSettings:i})}prepareOutputConfig(e){let i;return e.processingSettings.isAdvanced?i=Ht(Kt({},e.processingSettings.advanced),{type:be.ADVANCED}):i={type:e.processingSettings.type,deduplicationIntervalSecs:e.processingSettings?.deduplicationIntervalSecs},Ht(Kt({},e),{processingSettings:i})}onConfigurationSet(e){this.timeseriesConfigForm=this.fb.group({processingSettings:this.fb.group({isAdvanced:[e?.processingSettings?.isAdvanced??!1],type:[e?.processingSettings?.type??be.ON_EVERY_MESSAGE],deduplicationIntervalSecs:[{value:e?.processingSettings?.deduplicationIntervalSecs??60,disabled:!0},[u.required,u.max(pi)]],advanced:[{value:null,disabled:!0}]}),defaultTTL:[e?.defaultTTL??null,[u.required,u.min(0)]],useServerTs:[e?.useServerTs??!1]})}updateValidators(e,i){let o=this.timeseriesConfigForm.get("processingSettings"),C=o.get("isAdvanced").value,H=o.get("type").value;!C&&H===be.DEDUPLICATE?o.get("deduplicationIntervalSecs").enable({emitEvent:e}):o.get("deduplicationIntervalSecs").disable({emitEvent:e}),C?o.get("advanced").enable({emitEvent:e}):o.get("advanced").disable({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-timeseries-config"]],features:[M],decls:21,vars:13,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],["formGroupName","processingSettings",1,"tb-form-panel","stroked","no-padding-bottom","no-gap"],[1,"mb-4","flex","flex-row","items-center","justify-between"],["translate","",1,"tb-form-panel-title",3,"tb-hint-tooltip-icon"],["appearance","fill","selectMediaBreakpoint","xs","formControlName","isAdvanced"],[3,"value"],["formControlName","advanced","timeseries","","latest","","webSockets","","calculatedFields","",1,"mb-4"],[1,"tb-form-panel","stroked"],[1,"tb-settings"],["translate",""],["matExpansionPanelContent",""],["formControlName","type"],["required","","formControlName","deduplicationIntervalSecs",3,"labelText","requiredText","minErrorText","maxErrorText","maxTime","minTime"],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","useServerTs",1,"mat-slide"],["required","","subscriptSizing","dynamic","formControlName","defaultTTL",3,"labelText","requiredText","minErrorText"],["aria-hidden","false","aria-label","help-icon","matSuffix","",1,"mr-2","cursor-pointer",3,"matTooltip"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),m(4,"translate"),l(5," rule-node-config.save-time-series.processing-settings "),n(),a(6,"tb-toggle-select",4)(7,"tb-toggle-option",5),l(8),m(9,"translate"),n(),a(10,"tb-toggle-option",5),l(11),m(12,"translate"),n()()(),g(13,xl,7,1)(14,_l,1,0,"tb-advanced-processing-settings",6),n(),a(15,"section",7)(16,"mat-expansion-panel",8)(17,"mat-expansion-panel-header")(18,"mat-panel-title",9),l(19,"rule-node-config.advanced-settings"),n()(),g(20,Sl,12,18,"ng-template",10),n()()()),i&2&&(p("formGroup",o.timeseriesConfigForm),r(3),h("tb-hint-tooltip-icon",s(4,7,"rule-node-config.save-time-series.processing-settings-hint")),r(4),p("value",!1),r(),V(s(9,9,"rule-node-config.basic-mode")),r(2),p("value",!0),r(),V(s(12,11,"rule-node-config.advanced-mode")),r(2),zt(o.timeseriesConfigForm.get("processingSettings.isAdvanced").value?14:13))},dependencies:[X,q,B,oe,ee,W,Z,de,it,nt,rt,nn,S,x,A,_,E,Vt,D,Qe,Je,ge,Tt,St,I],encapsulation:2})}}return t})();b();function Fl(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.timeout-required")," "))}function Il(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-timeout-message")," "))}var Jn=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.rpcRequestConfigForm}onConfigurationSet(e){this.rpcRequestConfigForm=this.fb.group({timeoutInSeconds:[e?e.timeoutInSeconds:null,[u.required,u.min(0)]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-rpc-request-config"]],features:[M],decls:7,vars:3,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"mat-block","flex-1"],["translate",""],["type","number","min","0","step","1","matInput","","formControlName","timeoutInSeconds","required",""],[4,"ngIf"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.timeout-sec"),n(),f(4,"input",3),g(5,Fl,3,3,"mat-error",4)(6,Il,3,3,"mat-error",4),n()()),i&2&&(p("formGroup",o.rpcRequestConfigForm),r(5),p("ngIf",o.rpcRequestConfigForm.get("timeoutInSeconds").hasError("required")),r(),p("ngIf",o.rpcRequestConfigForm.get("timeoutInSeconds").hasError("min")))},dependencies:[k,R,q,B,Q,O,fe,S,x,A,ve,_,E,D,I],encapsulation:2})}}return t})();b();var El=["jsFuncComponent"],Ml=["tbelFuncComponent"],Na=()=>["msg","metadata","msgType"];function Nl(t,d){t&1&&f(0,"tb-script-lang",8)}function Al(t,d){if(t&1){let e=pe();a(0,"tb-js-func",9,0)(2,"button",10),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",11),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(4,Na)),r(2),h("matTooltip",s(3,2,e.testScriptLabel))}}function Dl(t,d){if(t&1){let e=pe();a(0,"tb-js-func",12,1)(2,"button",10),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",11),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(6,Na))("disableUndefinedCheck",!0)("scriptLanguage",e.scriptLanguage.TBEL),r(2),h("matTooltip",s(3,4,e.testScriptLabel))}}var $n=(()=>{class t extends N{constructor(e,i,o){super(),this.fb=e,this.nodeScriptTestService=i,this.translate=o,this.tbelEnabled=Ct(this.store).tbelEnabled,this.scriptLanguage=J,this.changeScript=new gt,this.hasScript=!0,this.testScriptLabel="rule-node-config.test-to-string-function"}configForm(){return this.logConfigForm}onConfigurationSet(e){this.logConfigForm=this.fb.group({scriptLang:[e?e.scriptLang:J.JS,[u.required]],jsScript:[e?e.jsScript:null,[]],tbelScript:[e?e.tbelScript:null,[]]})}validatorTriggers(){return["scriptLang"]}updateValidators(e){let i=this.logConfigForm.get("scriptLang").value;i===J.TBEL&&!this.tbelEnabled&&(i=J.JS,this.logConfigForm.get("scriptLang").patchValue(i,{emitEvent:!1}),setTimeout(()=>{this.logConfigForm.updateValueAndValidity({emitEvent:!0})})),this.logConfigForm.get("jsScript").setValidators(i===J.JS?[u.required]:[]),this.logConfigForm.get("jsScript").updateValueAndValidity({emitEvent:e}),this.logConfigForm.get("tbelScript").setValidators(i===J.TBEL?[u.required]:[]),this.logConfigForm.get("tbelScript").updateValueAndValidity({emitEvent:e})}prepareInputConfig(e){return e&&(e.scriptLang||(e.scriptLang=J.JS)),e}testScript(e){let i=this.logConfigForm.get("scriptLang").value,o=i===J.JS?"jsScript":"tbelScript",C=i===J.JS?"rulenode/log_node_script_fn":"rulenode/tbel/log_node_script_fn",H=this.logConfigForm.get(o).value;this.nodeScriptTestService.testNodeScript(H,"string",this.translate.instant("rule-node-config.to-string"),"ToString",["msg","metadata","msgType"],this.ruleNodeId,C,i,e).subscribe(Ce=>{Ce&&(this.logConfigForm.get(o).setValue(Ce),this.changeScript.emit())})}onValidate(){this.logConfigForm.get("scriptLang").value===J.JS&&this.jsFuncComponent.validateOnSubmit()}static{this.\u0275fac=function(i){return new(i||t)(y(G),y(ht),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-log-config"]],viewQuery:function(i,o){if(i&1&&(De(El,5),De(Ml,5)),i&2){let C;Ve(C=qe())&&(o.jsFuncComponent=C.first),Ve(C=qe())&&(o.tbelFuncComponent=C.first)}},features:[M],decls:8,vars:7,consts:[["jsFuncComponent",""],["tbelFuncComponent",""],[1,"flex","flex-col",3,"formGroup"],["formControlName","scriptLang",4,"ngIf"],["formControlName","jsScript","functionName","ToString","helpId","rulenode/log_node_script_fn","noValidate","true",3,"functionArgs",4,"ngIf"],["formControlName","tbelScript","functionName","ToString","helpId","rulenode/tbel/log_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage",4,"ngIf"],[1,"flex","flex-row"],["mat-button","","mat-raised-button","","color","primary",3,"click"],["formControlName","scriptLang"],["formControlName","jsScript","functionName","ToString","helpId","rulenode/log_node_script_fn","noValidate","true",3,"functionArgs"],["toolbarSuffixButton","","mat-icon-button","","matTooltipPosition","above",1,"tb-mat-32",3,"click","matTooltip"],["color","primary",1,"material-icons"],["formControlName","tbelScript","functionName","ToString","helpId","rulenode/tbel/log_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage"]],template:function(i,o){i&1&&(a(0,"section",2),g(1,Nl,1,0,"tb-script-lang",3)(2,Al,6,5,"tb-js-func",4)(3,Dl,6,7,"tb-js-func",5),a(4,"div",6)(5,"button",7),$("click",function(){return o.testScript()}),l(6),m(7,"translate"),n()()()),i&2&&(p("formGroup",o.logConfigForm),r(),p("ngIf",o.tbelEnabled),r(),p("ngIf",o.logConfigForm.get("scriptLang").value===o.scriptLanguage.JS),r(),p("ngIf",o.logConfigForm.get("scriptLang").value===o.scriptLanguage.TBEL),r(3),c(" ",s(7,5,o.testScriptLabel)," "))},dependencies:[k,vt,we,_e,X,Z,S,x,_,E,Et,I],encapsulation:2})}}return t})();b();function Vl(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.customer-name-pattern-required")," "))}var Yn=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.assignCustomerConfigForm}onConfigurationSet(e){this.assignCustomerConfigForm=this.fb.group({customerNamePattern:[e?e.customerNamePattern:null,[u.required,u.pattern(/.*\S.*/)]],createCustomerIfNotExists:[e?e.createCustomerIfNotExists:!1,[]]})}prepareOutputConfig(e){return e.customerNamePattern=e.customerNamePattern.trim(),e}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-assign-to-customer-config"]],features:[M],decls:13,vars:5,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"tb-form-panel","no-padding","no-border"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","customerNamePattern"],[4,"ngIf"],[1,"tb-form-row"],["formControlName","createCustomerIfNotExists",1,"mat-slide"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-label",3),l(4,"rule-node-config.customer-name-pattern"),n(),f(5,"input",4),g(6,Vl,3,3,"mat-error",5),a(7,"mat-hint",3),l(8,"rule-node-config.customer-name-pattern-hint"),n()(),a(9,"div",6)(10,"mat-slide-toggle",7),l(11),m(12,"translate"),n()()()()),i&2&&(p("formGroup",o.assignCustomerConfigForm),r(6),p("ngIf",o.assignCustomerConfigForm.get("customerNamePattern").hasError("required")||o.assignCustomerConfigForm.get("customerNamePattern").hasError("pattern")),r(5),c(" ",s(12,3,"rule-node-config.create-customer-if-not-exists")," "))},dependencies:[k,R,q,B,se,Q,de,O,S,x,A,_,E,D,I],encapsulation:2})}}return t})();b();var ql=["jsFuncComponent"],kl=["tbelFuncComponent"],Da=()=>["msg","metadata","msgType"];function Bl(t,d){t&1&&f(0,"tb-script-lang",12)}function Ol(t,d){if(t&1){let e=pe();a(0,"tb-js-func",13,0)(2,"button",14),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",15),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(4,Da)),r(2),h("matTooltip",s(3,2,e.testScriptLabel))}}function Rl(t,d){if(t&1){let e=pe();a(0,"tb-js-func",16,1)(2,"button",14),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",15),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(6,Da))("disableUndefinedCheck",!0)("scriptLanguage",e.scriptLanguage.TBEL),r(2),h("matTooltip",s(3,4,e.testScriptLabel))}}function Ll(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.alarm-type-required")," "))}var Wn=(()=>{class t extends N{constructor(e,i,o,C){super(),this.store=e,this.fb=i,this.nodeScriptTestService=o,this.translate=C,this.tbelEnabled=Ct(this.store).tbelEnabled,this.scriptLanguage=J,this.changeScript=new gt,this.hasScript=!0,this.testScriptLabel="rule-node-config.test-details-function"}configForm(){return this.clearAlarmConfigForm}onConfigurationSet(e){this.clearAlarmConfigForm=this.fb.group({scriptLang:[e?e.scriptLang:J.JS,[u.required]],alarmDetailsBuildJs:[e?e.alarmDetailsBuildJs:null,[]],alarmDetailsBuildTbel:[e?e.alarmDetailsBuildTbel:null,[]],alarmType:[e?e.alarmType:null,[u.required]]})}validatorTriggers(){return["scriptLang"]}updateValidators(e){let i=this.clearAlarmConfigForm.get("scriptLang").value;i===J.TBEL&&!this.tbelEnabled&&(i=J.JS,this.clearAlarmConfigForm.get("scriptLang").patchValue(i,{emitEvent:!1}),setTimeout(()=>{this.clearAlarmConfigForm.updateValueAndValidity({emitEvent:!0})})),this.clearAlarmConfigForm.get("alarmDetailsBuildJs").setValidators(i===J.JS?[u.required]:[]),this.clearAlarmConfigForm.get("alarmDetailsBuildJs").updateValueAndValidity({emitEvent:e}),this.clearAlarmConfigForm.get("alarmDetailsBuildTbel").setValidators(i===J.TBEL?[u.required]:[]),this.clearAlarmConfigForm.get("alarmDetailsBuildTbel").updateValueAndValidity({emitEvent:e})}prepareInputConfig(e){return e&&(e.scriptLang||(e.scriptLang=J.JS)),e}testScript(e){let i=this.clearAlarmConfigForm.get("scriptLang").value,o=i===J.JS?"alarmDetailsBuildJs":"alarmDetailsBuildTbel",C=i===J.JS?"rulenode/clear_alarm_node_script_fn":"rulenode/tbel/clear_alarm_node_script_fn",H=this.clearAlarmConfigForm.get(o).value;this.nodeScriptTestService.testNodeScript(H,"json",this.translate.instant("rule-node-config.details"),"Details",["msg","metadata","msgType"],this.ruleNodeId,C,i,e).subscribe(Ce=>{Ce&&(this.clearAlarmConfigForm.get(o).setValue(Ce),this.changeScript.emit())})}onValidate(){this.clearAlarmConfigForm.get("scriptLang").value===J.JS&&this.jsFuncComponent.validateOnSubmit()}static{this.\u0275fac=function(i){return new(i||t)(y(vi),y(G),y(ht),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-clear-alarm-config"]],viewQuery:function(i,o){if(i&1&&(De(ql,5),De(kl,5)),i&2){let C;Ve(C=qe())&&(o.jsFuncComponent=C.first),Ve(C=qe())&&(o.tbelFuncComponent=C.first)}},features:[M],decls:15,vars:8,consts:[["jsFuncComponent",""],["tbelFuncComponent",""],[1,"flex","flex-col",3,"formGroup"],["formControlName","scriptLang",4,"ngIf"],["formControlName","alarmDetailsBuildJs","functionName","Details","helpId","rulenode/clear_alarm_node_script_fn","noValidate","true",3,"functionArgs",4,"ngIf"],["formControlName","alarmDetailsBuildTbel","functionName","Details","helpId","rulenode/tbel/clear_alarm_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage",4,"ngIf"],[1,"flex","flex-row",2,"padding-bottom","16px"],["mat-button","","mat-raised-button","","color","primary",3,"click"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","alarmType"],[4,"ngIf"],["formControlName","scriptLang"],["formControlName","alarmDetailsBuildJs","functionName","Details","helpId","rulenode/clear_alarm_node_script_fn","noValidate","true",3,"functionArgs"],["toolbarSuffixButton","","mat-icon-button","","matTooltipPosition","above",1,"tb-mat-32",3,"click","matTooltip"],["color","primary",1,"material-icons"],["formControlName","alarmDetailsBuildTbel","functionName","Details","helpId","rulenode/tbel/clear_alarm_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage"]],template:function(i,o){i&1&&(a(0,"section",2),g(1,Bl,1,0,"tb-script-lang",3)(2,Ol,6,5,"tb-js-func",4)(3,Rl,6,7,"tb-js-func",5),a(4,"div",6)(5,"button",7),$("click",function(){return o.testScript()}),l(6),m(7,"translate"),n()(),a(8,"mat-form-field",8)(9,"mat-label",9),l(10,"rule-node-config.alarm-type"),n(),f(11,"input",10),g(12,Ll,3,3,"mat-error",11),a(13,"mat-hint",9),l(14,"rule-node-config.general-pattern-hint"),n()()()),i&2&&(p("formGroup",o.clearAlarmConfigForm),r(),p("ngIf",o.tbelEnabled),r(),p("ngIf",o.clearAlarmConfigForm.get("scriptLang").value===o.scriptLanguage.JS),r(),p("ngIf",o.clearAlarmConfigForm.get("scriptLang").value===o.scriptLanguage.TBEL),r(3),c(" ",s(7,6,o.testScriptLabel)," "),r(6),p("ngIf",o.clearAlarmConfigForm.get("alarmType").hasError("required")))},dependencies:[k,vt,we,_e,X,R,q,B,se,Q,Z,O,S,x,A,_,E,D,Et,I],encapsulation:2})}}return t})();b();var Pl=["jsFuncComponent"],wl=["tbelFuncComponent"],Va=()=>["msg","metadata","msgType"];function Gl(t,d){t&1&&(a(0,"mat-checkbox",7),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.overwrite-alarm-details")," "))}function jl(t,d){t&1&&f(0,"tb-script-lang",14)}function Ul(t,d){if(t&1){let e=pe();a(0,"tb-js-func",15,0)(2,"button",16),m(3,"translate"),$("click",function(){ie(e);let o=v(2);return ne(o.testScript())}),a(4,"mat-icon",17),l(5,"bug_report"),n()()()}if(t&2){let e=v(2);p("functionArgs",he(4,Va)),r(2),h("matTooltip",s(3,2,e.testScriptLabel))}}function Kl(t,d){if(t&1){let e=pe();a(0,"tb-js-func",18,1)(2,"button",16),m(3,"translate"),$("click",function(){ie(e);let o=v(2);return ne(o.testScript())}),a(4,"mat-icon",17),l(5,"bug_report"),n()()()}if(t&2){let e=v(2);p("functionArgs",he(6,Va))("disableUndefinedCheck",!0)("scriptLanguage",e.scriptLanguage.TBEL),r(2),h("matTooltip",s(3,4,e.testScriptLabel))}}function Hl(t,d){if(t&1){let e=pe();a(0,"section",8),g(1,jl,1,0,"tb-script-lang",9)(2,Ul,6,5,"tb-js-func",10)(3,Kl,6,7,"tb-js-func",11),a(4,"div",12)(5,"button",13),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),l(6),m(7,"translate"),n()()()}if(t&2){let e=v();r(),p("ngIf",e.tbelEnabled),r(),p("ngIf",e.createAlarmConfigForm.get("scriptLang").value===e.scriptLanguage.JS),r(),p("ngIf",e.createAlarmConfigForm.get("scriptLang").value===e.scriptLanguage.TBEL),r(3),c(" ",s(7,4,e.testScriptLabel)," ")}}function zl(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.alarm-type-required")," "))}function Ql(t,d){if(t&1&&(a(0,"mat-option",32),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(3);p("value",e),r(),c(" ",s(2,2,i.alarmSeverityTranslationMap.get(e))," ")}}function Jl(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.alarm-severity-required")," "))}function $l(t,d){if(t&1&&(a(0,"mat-form-field",29)(1,"mat-label",20),l(2,"rule-node-config.alarm-severity"),n(),a(3,"mat-select",30),g(4,Ql,3,4,"mat-option",31),n(),g(5,Jl,3,3,"mat-error",22),n()),t&2){let e=v(2);r(4),p("ngForOf",e.alarmSeverities),r(),p("ngIf",e.createAlarmConfigForm.get("severity").hasError("required"))}}function Yl(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.alarm-severity-required")," "))}function Wl(t,d){if(t&1&&(a(0,"mat-form-field",19)(1,"mat-label",20),l(2,"rule-node-config.alarm-severity-pattern"),n(),f(3,"input",33),g(4,Yl,3,3,"mat-error",22),f(5,"mat-hint",34),m(6,"translate"),m(7,"safe"),n()),t&2){let e=v(2);r(4),p("ngIf",e.createAlarmConfigForm.get("severity").hasError("required")),r(),p("innerHTML",ae(7,4,s(6,2,"rule-node-config.alarm-severity-pattern-hint"),"html"),Pe)}}function Xl(t,d){if(t&1){let e=pe();a(0,"mat-chip-row",38),$("removed",function(){let o=ie(e).$implicit,C=v(3);return ne(C.removeKey(o,"relationTypes"))}),l(1),a(2,"mat-icon",39),l(3,"close"),n()()}if(t&2){let e=d.$implicit;r(),c(" ",e," ")}}function Zl(t,d){if(t&1){let e=pe();a(0,"section")(1,"mat-form-field",35)(2,"mat-label",20),l(3,"rule-node-config.relation-types-list"),n(),a(4,"mat-chip-grid",null,2),g(6,Xl,4,1,"mat-chip-row",36),a(7,"input",37),m(8,"translate"),$("matChipInputTokenEnd",function(o){ie(e);let C=v(2);return ne(C.addKey(o,"relationTypes"))}),n()(),a(9,"mat-hint",20),l(10,"rule-node-config.relation-types-list-hint"),n()()()}if(t&2){let e=Xe(5),i=v(2);r(6),p("ngForOf",i.createAlarmConfigForm.get("relationTypes").value),r(),h("placeholder",s(8,5,"rule-node-config.relation-types-list")),p("matChipInputFor",e)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes)("matChipInputAddOnBlur",!0)}}function ep(t,d){if(t&1&&(a(0,"section",8)(1,"mat-form-field",19)(2,"mat-label",20),l(3,"rule-node-config.alarm-type"),n(),f(4,"input",21),g(5,zl,3,3,"mat-error",22),a(6,"mat-hint",20),l(7,"rule-node-config.general-pattern-hint"),n()(),a(8,"mat-checkbox",23),l(9),m(10,"translate"),n(),g(11,$l,6,2,"mat-form-field",24)(12,Wl,8,7,"mat-form-field",25),a(13,"mat-checkbox",26),l(14),m(15,"translate"),n(),g(16,Zl,11,7,"section",22),a(17,"mat-checkbox",27),l(18),m(19,"translate"),n(),a(20,"mat-checkbox",28),l(21),m(22,"translate"),n()()),t&2){let e=v();r(5),p("ngIf",e.createAlarmConfigForm.get("alarmType").hasError("required")),r(4),c(" ",s(10,8,"rule-node-config.use-alarm-severity-pattern")," "),r(2),p("ngIf",!e.createAlarmConfigForm.get("dynamicSeverity").value),r(),p("ngIf",e.createAlarmConfigForm.get("dynamicSeverity").value),r(2),c(" ",s(15,10,"rule-node-config.propagate")," "),r(2),p("ngIf",e.createAlarmConfigForm.get("propagate").value===!0),r(2),c(" ",s(19,12,"rule-node-config.propagate-to-owner")," "),r(3),c(" ",s(22,14,"rule-node-config.propagate-to-tenant")," ")}}var Xn=(()=>{class t extends N{constructor(e,i,o,C){super(),this.store=e,this.fb=i,this.nodeScriptTestService=o,this.translate=C,this.alarmSeverities=Object.keys(_o),this.alarmSeverityTranslationMap=Fo,this.separatorKeysCodes=[13,188,186],this.tbelEnabled=Ct(this.store).tbelEnabled,this.scriptLanguage=J,this.changeScript=new gt,this.hasScript=!0,this.testScriptLabel="rule-node-config.test-details-function"}configForm(){return this.createAlarmConfigForm}onConfigurationSet(e){this.createAlarmConfigForm=this.fb.group({scriptLang:[e?e.scriptLang:J.JS,[u.required]],alarmDetailsBuildJs:[e?e.alarmDetailsBuildJs:null,[]],alarmDetailsBuildTbel:[e?e.alarmDetailsBuildTbel:null,[]],useMessageAlarmData:[e?e.useMessageAlarmData:!1,[]],overwriteAlarmDetails:[e?e.overwriteAlarmDetails:!1,[]],alarmType:[e?e.alarmType:null,[]],severity:[e?e.severity:null,[]],propagate:[e?e.propagate:!1,[]],relationTypes:[e?e.relationTypes:null,[]],propagateToOwner:[e?e.propagateToOwner:!1,[]],propagateToTenant:[e?e.propagateToTenant:!1,[]],dynamicSeverity:!1}),this.createAlarmConfigForm.get("dynamicSeverity").valueChanges.pipe(ce(this.destroyRef)).subscribe(i=>{i?this.createAlarmConfigForm.get("severity").patchValue("",{emitEvent:!1}):this.createAlarmConfigForm.get("severity").patchValue(this.alarmSeverities[0],{emitEvent:!1})})}validatorTriggers(){return["useMessageAlarmData","overwriteAlarmDetails","scriptLang"]}updateValidators(e){let i=this.createAlarmConfigForm.get("useMessageAlarmData").value,o=this.createAlarmConfigForm.get("overwriteAlarmDetails").value;i?(this.createAlarmConfigForm.get("alarmType").setValidators([]),this.createAlarmConfigForm.get("severity").setValidators([])):(this.createAlarmConfigForm.get("alarmType").setValidators([u.required]),this.createAlarmConfigForm.get("severity").setValidators([u.required])),this.createAlarmConfigForm.get("alarmType").updateValueAndValidity({emitEvent:e}),this.createAlarmConfigForm.get("severity").updateValueAndValidity({emitEvent:e});let C=this.createAlarmConfigForm.get("scriptLang").value;C===J.TBEL&&!this.tbelEnabled&&(C=J.JS,this.createAlarmConfigForm.get("scriptLang").patchValue(C,{emitEvent:!1}),setTimeout(()=>{this.createAlarmConfigForm.updateValueAndValidity({emitEvent:!0})}));let H=i===!1||o===!0;this.createAlarmConfigForm.get("alarmDetailsBuildJs").setValidators(H&&C===J.JS?[u.required]:[]),this.createAlarmConfigForm.get("alarmDetailsBuildTbel").setValidators(H&&C===J.TBEL?[u.required]:[]),this.createAlarmConfigForm.get("alarmDetailsBuildJs").updateValueAndValidity({emitEvent:e}),this.createAlarmConfigForm.get("alarmDetailsBuildTbel").updateValueAndValidity({emitEvent:e})}prepareInputConfig(e){return e&&(e.scriptLang||(e.scriptLang=J.JS)),e}testScript(e){let i=this.createAlarmConfigForm.get("scriptLang").value,o=i===J.JS?"alarmDetailsBuildJs":"alarmDetailsBuildTbel",C=i===J.JS?"rulenode/create_alarm_node_script_fn":"rulenode/tbel/create_alarm_node_script_fn",H=this.createAlarmConfigForm.get(o).value;this.nodeScriptTestService.testNodeScript(H,"json",this.translate.instant("rule-node-config.details"),"Details",["msg","metadata","msgType"],this.ruleNodeId,C,i,e).subscribe(Ce=>{Ce&&(this.createAlarmConfigForm.get(o).setValue(Ce),this.changeScript.emit())})}removeKey(e,i){let o=this.createAlarmConfigForm.get(i).value,C=o.indexOf(e);C>=0&&(o.splice(C,1),this.createAlarmConfigForm.get(i).setValue(o,{emitEvent:!0}))}addKey(e,i){let o=e.input,C=e.value;if((C||"").trim()){C=C.trim();let H=this.createAlarmConfigForm.get(i).value;(!H||H.indexOf(C)===-1)&&(H||(H=[]),H.push(C),this.createAlarmConfigForm.get(i).setValue(H,{emitEvent:!0}))}o&&(o.value="")}onValidate(){let e=this.createAlarmConfigForm.get("useMessageAlarmData").value,i=this.createAlarmConfigForm.get("overwriteAlarmDetails").value;(!e||i)&&this.createAlarmConfigForm.get("scriptLang").value===J.JS&&this.jsFuncComponent.validateOnSubmit()}static{this.\u0275fac=function(i){return new(i||t)(y(vi),y(G),y(ht),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-create-alarm-config"]],viewQuery:function(i,o){if(i&1&&(De(Pl,5),De(wl,5)),i&2){let C;Ve(C=qe())&&(o.jsFuncComponent=C.first),Ve(C=qe())&&(o.tbelFuncComponent=C.first)}},features:[M],decls:7,vars:7,consts:[["jsFuncComponent",""],["tbelFuncComponent",""],["relationTypesChipList",""],[1,"flex","flex-col",3,"formGroup"],["formControlName","useMessageAlarmData"],["formControlName","overwriteAlarmDetails",4,"ngIf"],["class","flex flex-col",4,"ngIf"],["formControlName","overwriteAlarmDetails"],[1,"flex","flex-col"],["formControlName","scriptLang",4,"ngIf"],["formControlName","alarmDetailsBuildJs","functionName","Details","helpId","rulenode/create_alarm_node_script_fn","noValidate","true",3,"functionArgs",4,"ngIf"],["formControlName","alarmDetailsBuildTbel","functionName","Details","helpId","rulenode/tbel/create_alarm_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage",4,"ngIf"],[1,"flex","flex-row",2,"padding-bottom","16px"],["mat-button","","mat-raised-button","","color","primary",3,"click"],["formControlName","scriptLang"],["formControlName","alarmDetailsBuildJs","functionName","Details","helpId","rulenode/create_alarm_node_script_fn","noValidate","true",3,"functionArgs"],["toolbarSuffixButton","","mat-icon-button","","matTooltipPosition","above",1,"tb-mat-32",3,"click","matTooltip"],["color","primary",1,"material-icons"],["formControlName","alarmDetailsBuildTbel","functionName","Details","helpId","rulenode/tbel/create_alarm_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage"],["subscriptSizing","dynamic",1,"flex-1"],["translate",""],["required","","matInput","","formControlName","alarmType"],[4,"ngIf"],["formControlName","dynamicSeverity"],["class","flex-1",4,"ngIf"],["class","flex-1","subscriptSizing","dynamic",4,"ngIf"],["formControlName","propagate"],["formControlName","propagateToOwner"],["formControlName","propagateToTenant"],[1,"flex-1"],["formControlName","severity","required",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["matInput","","formControlName","severity","required",""],[3,"innerHTML"],["floatLabel","always","subscriptSizing","dynamic",1,"mat-block"],[3,"removed",4,"ngFor","ngForOf"],["matInput","","type","text",3,"matChipInputTokenEnd","placeholder","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur"],[3,"removed"],["matChipRemove",""]],template:function(i,o){i&1&&(a(0,"section",3)(1,"mat-checkbox",4),l(2),m(3,"translate"),n(),g(4,Gl,3,3,"mat-checkbox",5)(5,Hl,8,6,"section",6)(6,ep,23,16,"section",6),n()),i&2&&(p("formGroup",o.createAlarmConfigForm),r(2),c(" ",s(3,5,"rule-node-config.use-message-alarm-data")," "),r(2),p("ngIf",o.createAlarmConfigForm.get("useMessageAlarmData").value===!0),r(),p("ngIf",o.createAlarmConfigForm.get("useMessageAlarmData").value===!1||o.createAlarmConfigForm.get("overwriteAlarmDetails").value===!0),r(),p("ngIf",o.createAlarmConfigForm.get("useMessageAlarmData").value===!1))},dependencies:[z,k,vt,we,_e,Ge,X,R,q,B,se,Q,ee,W,Z,Si,Fi,xi,_i,O,S,x,A,_,E,D,Et,pt,I],encapsulation:2})}}return t})();b();function tp(t,d){if(t&1&&(a(0,"mat-option",21),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.directionTypeTranslations.get(e))," ")}}function ip(t,d){if(t&1&&(a(0,"mat-form-field",22)(1,"mat-label"),l(2),m(3,"translate"),n(),f(4,"input",23),n()),t&2){let e=v();r(2),V(s(3,1,e.entityTypeNamePatternTranslation.get(e.createRelationConfigForm.get("entityType").value)))}}function np(t,d){t&1&&(a(0,"mat-form-field",22)(1,"mat-label",5),l(2,"rule-node-config.profile-name"),n(),f(3,"input",24),n())}function rp(t,d){t&1&&f(0,"tb-example-hint",25),t&2&&p("hintText","rule-node-config.kv-map-pattern-hint")}function op(t,d){t&1&&(a(0,"div",26),m(1,"translate"),a(2,"mat-slide-toggle",27),l(3),m(4,"translate"),n()()),t&2&&(h("tb-hint-tooltip-icon",s(1,2,"rule-node-config.create-entity-if-not-exists-hint")),r(3),c(" ",s(4,4,"rule-node-config.create-entity-if-not-exists")," "))}var tr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.directionTypes=Object.keys(mt),this.directionTypeTranslations=new Map([[mt.FROM,"rule-node-config.search-direction-from"],[mt.TO,"rule-node-config.search-direction-to"]]),this.entityType=Y,this.entityTypeNamePatternTranslation=new Map([[Y.DEVICE,"rule-node-config.device-name-pattern"],[Y.ASSET,"rule-node-config.asset-name-pattern"],[Y.ENTITY_VIEW,"rule-node-config.entity-view-name-pattern"],[Y.CUSTOMER,"rule-node-config.customer-title-pattern"],[Y.USER,"rule-node-config.user-name-pattern"],[Y.DASHBOARD,"rule-node-config.dashboard-name-pattern"],[Y.EDGE,"rule-node-config.edge-name-pattern"]]),this.allowedEntityTypes=[Y.DEVICE,Y.ASSET,Y.ENTITY_VIEW,Y.TENANT,Y.CUSTOMER,Y.USER,Y.DASHBOARD,Y.EDGE]}configForm(){return this.createRelationConfigForm}onConfigurationSet(e){this.createRelationConfigForm=this.fb.group({direction:[e?e.direction:null,[u.required]],entityType:[e?e.entityType:null,[u.required]],entityNamePattern:[e?e.entityNamePattern:null,[]],entityTypePattern:[e?e.entityTypePattern:null,[]],relationType:[e?e.relationType:null,[u.required]],createEntityIfNotExists:[e?e.createEntityIfNotExists:!1,[]],removeCurrentRelations:[e?e.removeCurrentRelations:!1,[]],changeOriginatorToRelatedEntity:[e?e.changeOriginatorToRelatedEntity:!1,[]]})}validatorTriggers(){return["entityType","createEntityIfNotExists"]}updateValidators(e){let i=this.createRelationConfigForm.get("entityType").value;if(i&&i!==Y.TENANT?this.createRelationConfigForm.get("entityNamePattern").setValidators([u.required,u.pattern(/.*\S.*/)]):this.createRelationConfigForm.get("entityNamePattern").setValidators([]),i&&(i===Y.DEVICE||i===Y.ASSET)){let o=[u.pattern(/.*\S.*/)];this.createRelationConfigForm.get("createEntityIfNotExists").value&&o.push(u.required),this.createRelationConfigForm.get("entityTypePattern").setValidators(o)}else this.createRelationConfigForm.get("entityTypePattern").setValidators([]);this.createRelationConfigForm.get("entityNamePattern").updateValueAndValidity({emitEvent:e}),this.createRelationConfigForm.get("entityTypePattern").updateValueAndValidity({emitEvent:e})}prepareOutputConfig(e){return e.entityNamePattern=e.entityNamePattern?e.entityNamePattern.trim():null,e.entityTypePattern=e.entityTypePattern?e.entityTypePattern.trim():null,e}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-create-relation-config"]],features:[M],decls:36,vars:19,consts:[[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],[1,"tb-form-panel","stroked","no-padding-bottom"],["translate","",1,"tb-form-panel-title"],[1,"flex","flex-col"],["hideRequiredMarker","",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","direction"],[3,"value",4,"ngFor","ngForOf"],["required","","formControlName","relationType"],[1,"flex","flex-row","gap-4"],["showLabel","","required","","formControlName","entityType",1,"flex-1",3,"allowedEntityTypes"],["class","mat-block flex-1",4,"ngIf"],[3,"hintText",4,"ngIf"],["style","margin-bottom: 18px","class","tb-form-row no-border no-padding",3,"tb-hint-tooltip-icon",4,"ngIf"],[1,"tb-form-panel","stroked","no-padding"],[1,"tb-settings"],[2,"padding","16px"],[1,"tb-form-panel","no-border","no-padding-top"],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","removeCurrentRelations",1,"mat-slide"],["formControlName","changeOriginatorToRelatedEntity",1,"mat-slide"],[3,"value"],[1,"mat-block","flex-1"],["required","","matInput","","formControlName","entityNamePattern"],["matInput","","formControlName","entityTypePattern"],[3,"hintText"],[1,"tb-form-row","no-border","no-padding",2,"margin-bottom","18px",3,"tb-hint-tooltip-icon"],["formControlName","createEntityIfNotExists",1,"mat-slide"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2),l(3,"rule-node-config.relation-parameters"),n(),a(4,"div",3)(5,"mat-form-field",4)(6,"mat-label",5),l(7,"relation.direction"),n(),a(8,"mat-select",6),g(9,tp,3,4,"mat-option",7),n()(),f(10,"tb-relation-type-autocomplete",8),n()(),a(11,"div",1)(12,"div",2),l(13,"rule-node-config.target-entity"),n(),a(14,"div",9),f(15,"tb-entity-type-select",10),g(16,ip,5,3,"mat-form-field",11)(17,np,4,0,"mat-form-field",11),n(),g(18,rp,1,1,"tb-example-hint",12)(19,op,5,6,"div",13),n(),a(20,"section",14)(21,"mat-expansion-panel",15)(22,"mat-expansion-panel-header",16)(23,"mat-panel-title",5),l(24,"rule-node-config.advanced-settings"),n()(),a(25,"div",17)(26,"div",18),m(27,"translate"),a(28,"mat-slide-toggle",19),l(29),m(30,"translate"),n()(),a(31,"div",18),m(32,"translate"),a(33,"mat-slide-toggle",20),l(34),m(35,"translate"),n()()()()()()),i&2&&(p("formGroup",o.createRelationConfigForm),r(9),p("ngForOf",o.directionTypes),r(6),p("allowedEntityTypes",o.allowedEntityTypes),r(),p("ngIf",o.createRelationConfigForm.get("entityType").value&&o.createRelationConfigForm.get("entityType").value!==o.entityType.TENANT),r(),p("ngIf",o.createRelationConfigForm.get("entityType").value===o.entityType.DEVICE||o.createRelationConfigForm.get("entityType").value===o.entityType.ASSET),r(),p("ngIf",o.createRelationConfigForm.get("entityType").value===o.entityType.CUSTOMER||o.createRelationConfigForm.get("entityType").value===o.entityType.DEVICE||o.createRelationConfigForm.get("entityType").value===o.entityType.ASSET),r(),p("ngIf",o.createRelationConfigForm.get("entityType").value===o.entityType.CUSTOMER||o.createRelationConfigForm.get("entityType").value===o.entityType.DEVICE||o.createRelationConfigForm.get("entityType").value===o.entityType.ASSET),r(7),h("tb-hint-tooltip-icon",s(27,11,"rule-node-config.remove-current-relations-hint")),r(3),c(" ",s(30,13,"rule-node-config.remove-current-relations")," "),r(2),h("tb-hint-tooltip-icon",s(32,15,"rule-node-config.change-originator-to-related-entity-hint")),r(3),c(" ",s(35,17,"rule-node-config.change-originator-to-related-entity")," "))},dependencies:[z,k,ri,ai,R,q,B,ee,W,de,it,nt,rt,O,S,x,A,_,E,D,ge,Te,I],encapsulation:2})}}return t})();b();function ap(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.period-seconds-required")," "))}function lp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-period-0-seconds-message")," "))}function pp(t,d){if(t&1&&(a(0,"mat-form-field",5)(1,"mat-label",6),l(2,"rule-node-config.period-seconds"),n(),f(3,"input",9),g(4,ap,3,3,"mat-error",8)(5,lp,3,3,"mat-error",8),n()),t&2){let e=v();r(4),p("ngIf",e.msgDelayConfigForm.get("periodInSeconds").hasError("required")),r(),p("ngIf",e.msgDelayConfigForm.get("periodInSeconds").hasError("min"))}}function mp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.period-in-seconds-pattern-required")," "))}function sp(t,d){if(t&1&&(a(0,"mat-form-field",10)(1,"mat-label",6),l(2,"rule-node-config.period-in-seconds-pattern"),n(),f(3,"input",11),g(4,mp,3,3,"mat-error",8),a(5,"mat-hint",6),l(6,"rule-node-config.general-pattern-hint"),n()()),t&2){let e=v();r(4),p("ngIf",e.msgDelayConfigForm.get("periodInSecondsPattern").hasError("required"))}}function dp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-pending-messages-required")," "))}function up(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-pending-messages-range")," "))}function cp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-pending-messages-range")," "))}var ir=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.msgDelayConfigForm}onConfigurationSet(e){this.msgDelayConfigForm=this.fb.group({useMetadataPeriodInSecondsPatterns:[e?e.useMetadataPeriodInSecondsPatterns:!1,[]],periodInSeconds:[e?e.periodInSeconds:null,[]],periodInSecondsPattern:[e?e.periodInSecondsPattern:null,[]],maxPendingMsgs:[e?e.maxPendingMsgs:null,[u.required,u.min(1),u.max(1e5)]]})}validatorTriggers(){return["useMetadataPeriodInSecondsPatterns"]}updateValidators(e){this.msgDelayConfigForm.get("useMetadataPeriodInSecondsPatterns").value?(this.msgDelayConfigForm.get("periodInSecondsPattern").setValidators([u.required]),this.msgDelayConfigForm.get("periodInSeconds").setValidators([])):(this.msgDelayConfigForm.get("periodInSecondsPattern").setValidators([]),this.msgDelayConfigForm.get("periodInSeconds").setValidators([u.required,u.min(0)])),this.msgDelayConfigForm.get("periodInSecondsPattern").updateValueAndValidity({emitEvent:e}),this.msgDelayConfigForm.get("periodInSeconds").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-msg-delay-config"]],features:[M],decls:16,vars:9,consts:[["periodInSecondsPattern",""],[1,"flex","flex-col",3,"formGroup"],["formControlName","useMetadataPeriodInSecondsPatterns"],["translate","",1,"tb-hint"],["class","mat-block",4,"ngIf","ngIfElse"],[1,"mat-block"],["translate",""],["required","","type","number","min","1","max","100000","step","1","matInput","","formControlName","maxPendingMsgs"],[4,"ngIf"],["required","","type","number","min","0","step","1","matInput","","formControlName","periodInSeconds"],["subscriptSizing","dynamic",1,"mat-block"],["required","","matInput","","formControlName","periodInSecondsPattern"]],template:function(i,o){if(i&1&&(a(0,"section",1)(1,"mat-checkbox",2),l(2),m(3,"translate"),n(),a(4,"div",3),l(5,"rule-node-config.use-metadata-period-in-seconds-patterns-hint"),n(),g(6,pp,6,2,"mat-form-field",4)(7,sp,7,1,"ng-template",null,0,Rt),a(9,"mat-form-field",5)(10,"mat-label",6),l(11,"rule-node-config.max-pending-messages"),n(),f(12,"input",7),g(13,dp,3,3,"mat-error",8)(14,up,3,3,"mat-error",8)(15,cp,3,3,"mat-error",8),n()()),i&2){let C=Xe(8);p("formGroup",o.msgDelayConfigForm),r(2),c(" ",s(3,7,"rule-node-config.use-metadata-period-in-seconds-patterns")," "),r(4),p("ngIf",o.msgDelayConfigForm.get("useMetadataPeriodInSecondsPatterns").value!==!0)("ngIfElse",C),r(7),p("ngIf",o.msgDelayConfigForm.get("maxPendingMsgs").hasError("required")),r(),p("ngIf",o.msgDelayConfigForm.get("maxPendingMsgs").hasError("min")),r(),p("ngIf",o.msgDelayConfigForm.get("maxPendingMsgs").hasError("max"))}},dependencies:[k,Ge,R,q,B,se,Q,O,fe,S,x,A,ve,ot,_,E,D,I],encapsulation:2})}}return t})();b();function fp(t,d){if(t&1&&(a(0,"mat-option",13),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.directionTypeTranslations.get(e))," ")}}function gp(t,d){if(t&1&&(a(0,"mat-form-field",18)(1,"mat-label"),l(2),m(3,"translate"),n(),f(4,"input",19),n()),t&2){let e=v(2);r(2),V(s(3,1,e.entityTypeNamePatternTranslation.get(e.deleteRelationConfigForm.get("entityType").value)))}}function Cp(t,d){t&1&&f(0,"tb-example-hint",20),t&2&&p("hintText","rule-node-config.kv-map-single-pattern-hint")}function yp(t,d){if(t&1&&(a(0,"div")(1,"div",14),f(2,"tb-entity-type-select",15),g(3,gp,5,3,"mat-form-field",16),n(),g(4,Cp,1,1,"tb-example-hint",17),n()),t&2){let e=v();r(2),p("allowedEntityTypes",e.allowedEntityTypes),r(),p("ngIf",e.deleteRelationConfigForm.get("entityType").value&&e.deleteRelationConfigForm.get("entityType").value!==e.entityType.TENANT),r(),p("ngIf",e.deleteRelationConfigForm.get("entityType").value&&e.deleteRelationConfigForm.get("entityType").value!==e.entityType.TENANT)}}var nr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.directionTypes=Object.keys(mt),this.directionTypeTranslations=new Map([[mt.FROM,"rule-node-config.del-relation-direction-from"],[mt.TO,"rule-node-config.del-relation-direction-to"]]),this.entityTypeNamePatternTranslation=new Map([[Y.DEVICE,"rule-node-config.device-name-pattern"],[Y.ASSET,"rule-node-config.asset-name-pattern"],[Y.ENTITY_VIEW,"rule-node-config.entity-view-name-pattern"],[Y.CUSTOMER,"rule-node-config.customer-title-pattern"],[Y.USER,"rule-node-config.user-name-pattern"],[Y.DASHBOARD,"rule-node-config.dashboard-name-pattern"],[Y.EDGE,"rule-node-config.edge-name-pattern"]]),this.entityType=Y,this.allowedEntityTypes=[Y.DEVICE,Y.ASSET,Y.ENTITY_VIEW,Y.TENANT,Y.CUSTOMER,Y.USER,Y.DASHBOARD,Y.EDGE]}configForm(){return this.deleteRelationConfigForm}onConfigurationSet(e){this.deleteRelationConfigForm=this.fb.group({deleteForSingleEntity:[e?e.deleteForSingleEntity:!1,[]],direction:[e?e.direction:null,[u.required]],entityType:[e?e.entityType:null,[]],entityNamePattern:[e?e.entityNamePattern:null,[]],relationType:[e?e.relationType:null,[u.required]]})}validatorTriggers(){return["deleteForSingleEntity","entityType"]}updateValidators(e){let i=this.deleteRelationConfigForm.get("deleteForSingleEntity").value,o=this.deleteRelationConfigForm.get("entityType").value;i?this.deleteRelationConfigForm.get("entityType").setValidators([u.required]):this.deleteRelationConfigForm.get("entityType").setValidators([]),i&&o&&o!==Y.TENANT?this.deleteRelationConfigForm.get("entityNamePattern").setValidators([u.required,u.pattern(/.*\S.*/)]):this.deleteRelationConfigForm.get("entityNamePattern").setValidators([]),this.deleteRelationConfigForm.get("entityType").updateValueAndValidity({emitEvent:!1}),this.deleteRelationConfigForm.get("entityNamePattern").updateValueAndValidity({emitEvent:e})}prepareOutputConfig(e){return e.entityNamePattern=e.entityNamePattern?e.entityNamePattern.trim():null,e}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-delete-relation-config"]],features:[M],decls:18,vars:9,consts:[[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],[1,"tb-form-panel","stroked","no-padding-bottom"],["translate","",1,"tb-form-panel-title"],[1,"flex","flex-col"],["hideRequiredMarker","",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","direction"],[3,"value",4,"ngFor","ngForOf"],["required","","formControlName","relationType"],[1,"tb-form-panel","stroked"],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","deleteForSingleEntity",1,"mat-slide"],[4,"ngIf"],[3,"value"],[1,"flex","flex-row","gap-2.5"],["showLabel","","required","","formControlName","entityType",1,"flex-1",3,"allowedEntityTypes"],["class","mat-block flex-1",4,"ngIf"],[3,"hintText",4,"ngIf"],[1,"mat-block","flex-1"],["required","","matInput","","formControlName","entityNamePattern"],[3,"hintText"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2),l(3,"rule-node-config.relation-parameters"),n(),a(4,"div",3)(5,"mat-form-field",4)(6,"mat-label",5),l(7,"relation.direction"),n(),a(8,"mat-select",6),g(9,fp,3,4,"mat-option",7),n()(),f(10,"tb-relation-type-autocomplete",8),n()(),a(11,"div",9)(12,"div",10),m(13,"translate"),a(14,"mat-slide-toggle",11),l(15),m(16,"translate"),n()(),g(17,yp,5,3,"div",12),n()()),i&2&&(p("formGroup",o.deleteRelationConfigForm),r(9),p("ngForOf",o.directionTypes),r(3),h("tb-hint-tooltip-icon",s(13,5,"rule-node-config.delete-relation-with-specific-entity-hint")),r(3),c(" ",s(16,7,"rule-node-config.delete-relation-with-specific-entity")," "),r(2),p("ngIf",o.deleteRelationConfigForm.get("deleteForSingleEntity").value))},dependencies:[z,k,ri,ai,R,q,B,ee,W,de,O,S,x,A,_,E,D,ge,Te,I],encapsulation:2})}}return t})();b();var vp=["jsFuncComponent"],hp=["tbelFuncComponent"],qa=()=>["prevMsg","prevMetadata","prevMsgType"];function bp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.message-count-required")," "))}function Tp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-message-count-message")," "))}function xp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.generation-frequency-required")," "))}function _p(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-generation-frequency-message")," "))}function Sp(t,d){if(t&1&&(a(0,"tb-toggle-select",22)(1,"tb-toggle-option",23),l(2),m(3,"translate"),n(),a(4,"tb-toggle-option",23),l(5),m(6,"translate"),n()()),t&2){let e=v(2);r(),p("value",e.scriptLanguage.TBEL),r(),c(" ",s(3,4,"rule-node-config.script-lang-tbel")," "),r(2),p("value",e.scriptLanguage.JS),r(),c(" ",s(6,6,"rule-node-config.script-lang-js")," ")}}function Fp(t,d){if(t&1){let e=pe();a(0,"tb-js-func",18,0),g(2,Sp,7,8,"tb-toggle-select",19),a(3,"button",20),m(4,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(5,"mat-icon",21),l(6,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(5,qa)),r(2),p("ngIf",e.tbelEnabled),r(),h("matTooltip",s(4,3,e.testScriptLabel))}}function Ip(t,d){if(t&1){let e=pe();a(0,"tb-js-func",24,1)(2,"tb-toggle-select",22)(3,"tb-toggle-option",23),l(4),m(5,"translate"),n(),a(6,"tb-toggle-option",23),l(7),m(8,"translate"),n()(),a(9,"button",20),m(10,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(11,"mat-icon",21),l(12,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(14,qa))("disableUndefinedCheck",!0)("scriptLanguage",e.scriptLanguage.TBEL),r(3),p("value",e.scriptLanguage.TBEL),r(),c(" ",s(5,8,"rule-node-config.script-lang-tbel")," "),r(2),p("value",e.scriptLanguage.JS),r(),c(" ",s(8,10,"rule-node-config.script-lang-js")," "),r(2),h("matTooltip",s(10,12,e.testScriptLabel))}}var rr=(()=>{class t extends N{constructor(e,i,o){super(),this.fb=e,this.nodeScriptTestService=i,this.translate=o,this.tbelEnabled=Ct(this.store).tbelEnabled,this.scriptLanguage=J,this.changeScript=new gt,this.allowedEntityTypes=[Y.DEVICE,Y.ASSET,Y.ENTITY_VIEW,Y.CUSTOMER,Y.USER,Y.DASHBOARD],this.additionEntityTypes={TENANT:this.translate.instant("rule-node-config.current-tenant"),RULE_NODE:this.translate.instant("rule-node-config.current-rule-node")},this.hasScript=!0,this.testScriptLabel="rule-node-config.test-generator-function"}configForm(){return this.generatorConfigForm}onConfigurationSet(e){this.generatorConfigForm=this.fb.group({msgCount:[e?e.msgCount:null,[u.required,u.min(0)]],periodInSeconds:[e?e.periodInSeconds:null,[u.required,u.min(1)]],originator:[e?e.originator:{id:null,entityType:Y.RULE_NODE},[]],scriptLang:[e?e.scriptLang:J.JS,[u.required]],jsScript:[e?e.jsScript:null,[]],tbelScript:[e?e.tbelScript:null,[]]})}validatorTriggers(){return["scriptLang"]}updateValidators(e){let i=this.generatorConfigForm.get("scriptLang").value;i===J.TBEL&&!this.tbelEnabled&&(i=J.JS,this.generatorConfigForm.get("scriptLang").patchValue(i,{emitEvent:!1}),setTimeout(()=>{this.generatorConfigForm.updateValueAndValidity({emitEvent:!0})})),this.generatorConfigForm.get("jsScript").setValidators(i===J.JS?[u.required]:[]),this.generatorConfigForm.get("jsScript").updateValueAndValidity({emitEvent:e}),this.generatorConfigForm.get("tbelScript").setValidators(i===J.TBEL?[u.required]:[]),this.generatorConfigForm.get("tbelScript").updateValueAndValidity({emitEvent:e})}prepareInputConfig(e){return{msgCount:F(e?.msgCount)?e?.msgCount:0,periodInSeconds:F(e?.periodInSeconds)?e?.periodInSeconds:1,originator:{id:F(e?.originatorId)?e?.originatorId:null,entityType:F(e?.originatorType)?e?.originatorType:Y.RULE_NODE},scriptLang:F(e?.scriptLang)?e?.scriptLang:J.JS,tbelScript:F(e?.tbelScript)?e?.tbelScript:null,jsScript:F(e?.jsScript)?e?.jsScript:null}}prepareOutputConfig(e){return e.originator?(e.originatorId=e.originator.id,e.originatorType=e.originator.entityType):(e.originatorId=null,e.originatorType=null),delete e.originator,e}testScript(e){let i=this.generatorConfigForm.get("scriptLang").value,o=i===J.JS?"jsScript":"tbelScript",C=i===J.JS?"rulenode/generator_node_script_fn":"rulenode/tbel/generator_node_script_fn",H=this.generatorConfigForm.get(o).value;this.nodeScriptTestService.testNodeScript(H,"generate",this.translate.instant("rule-node-config.generator"),"Generate",["prevMsg","prevMetadata","prevMsgType"],this.ruleNodeId,C,i,e).subscribe(Ce=>{Ce&&(this.generatorConfigForm.get(o).setValue(Ce),this.changeScript.emit())})}onValidate(){this.generatorConfigForm.get("scriptLang").value===J.JS&&this.jsFuncComponent.validateOnSubmit()}static{this.\u0275fac=function(i){return new(i||t)(y(G),y(ht),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-generator-config"]],viewQuery:function(i,o){if(i&1&&(De(vp,5),De(hp,5)),i&2){let C;Ve(C=qe())&&(o.jsFuncComponent=C.first),Ve(C=qe())&&(o.tbelFuncComponent=C.first)}},features:[M],decls:32,vars:12,consts:[["jsFuncComponent",""],["tbelFuncComponent",""],[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],[1,"tb-form-panel","no-padding-bottom","stroked"],["translate","",1,"tb-form-panel-title"],[1,"tb-form-row","no-border","no-padding","tb-standard-fields","column-xs"],[1,"flex"],["translate",""],["required","","type","number","min","0","step","1","matInput","","formControlName","msgCount"],[4,"ngIf"],["required","","type","number","min","1","step","1","matInput","","formControlName","periodInSeconds"],["required","true","useAliasEntityTypes","true","formControlName","originator",1,"flex-1",3,"allowedEntityTypes","additionEntityTypes"],[1,"tb-form-panel","stroked"],["expanded","",1,"tb-settings"],["formControlName","jsScript","functionName","Generate","helpId","rulenode/generator_node_script_fn","noValidate","true",3,"functionArgs",4,"ngIf"],["formControlName","tbelScript","functionName","Generate","helpId","rulenode/tbel/generator_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage",4,"ngIf"],[1,"flex","flex-row",2,"padding-bottom","16px"],["mat-button","","mat-raised-button","","color","primary",3,"click"],["formControlName","jsScript","functionName","Generate","helpId","rulenode/generator_node_script_fn","noValidate","true",3,"functionArgs"],["toolbarPrefixButton","","formControlName","scriptLang","appearance","fill",4,"ngIf"],["toolbarSuffixButton","","mat-icon-button","","matTooltipPosition","above",1,"tb-mat-32",3,"click","matTooltip"],["color","primary",1,"material-icons"],["toolbarPrefixButton","","formControlName","scriptLang","appearance","fill"],[3,"value"],["formControlName","tbelScript","functionName","Generate","helpId","rulenode/tbel/generator_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage"]],template:function(i,o){i&1&&(a(0,"section",2)(1,"div",3)(2,"div",4),l(3,"rule-node-config.generation-parameters"),n(),a(4,"div",5)(5,"mat-form-field",6)(6,"mat-label",7),l(7,"rule-node-config.message-count"),n(),f(8,"input",8),g(9,bp,3,3,"mat-error",9)(10,Tp,3,3,"mat-error",9),n(),a(11,"mat-form-field",6)(12,"mat-label",7),l(13,"rule-node-config.generation-frequency-seconds"),n(),f(14,"input",10),g(15,xp,3,3,"mat-error",9)(16,_p,3,3,"mat-error",9),n()()(),a(17,"div",3)(18,"div",4),l(19,"rule-node-config.originator"),n(),f(20,"tb-entity-select",11),n(),a(21,"div",12)(22,"mat-expansion-panel",13)(23,"mat-expansion-panel-header")(24,"mat-panel-title",7),l(25,"rule-node-config.generator-function"),n()(),g(26,Fp,7,6,"tb-js-func",14)(27,Ip,13,15,"tb-js-func",15),a(28,"div",16)(29,"button",17),$("click",function(){return o.testScript()}),l(30),m(31,"translate"),n()()()()()),i&2&&(p("formGroup",o.generatorConfigForm),r(9),p("ngIf",o.generatorConfigForm.get("msgCount").hasError("required")),r(),p("ngIf",o.generatorConfigForm.get("msgCount").hasError("min")),r(5),p("ngIf",o.generatorConfigForm.get("periodInSeconds").hasError("required")),r(),p("ngIf",o.generatorConfigForm.get("periodInSeconds").hasError("min")),r(4),p("allowedEntityTypes",o.allowedEntityTypes)("additionEntityTypes",o.additionEntityTypes),r(6),p("ngIf",o.generatorConfigForm.get("scriptLang").value===o.scriptLanguage.JS),r(),p("ngIf",o.generatorConfigForm.get("scriptLang").value===o.scriptLanguage.TBEL),r(3),c(" ",s(31,10,o.testScriptLabel)," "))},dependencies:[k,wo,vt,we,_e,X,R,q,B,Q,Z,it,nt,rt,O,fe,S,x,A,ve,_,E,D,Qe,Je,I],styles:['@charset "UTF-8";[_nghost-%COMP%]     .mat-button-toggle-group{min-width:120px;height:24px!important}[_nghost-%COMP%]     .mat-button-toggle-group .mat-button-toggle{font-size:0}[_nghost-%COMP%]     .mat-button-toggle-group .mat-button-toggle .mat-button-toggle-button{height:20px!important;line-height:20px!important;border:none!important}[_nghost-%COMP%]     .mat-button-toggle-group .mat-button-toggle .mat-button-toggle-button .mat-button-toggle-label-content{font-size:14px!important;line-height:20px!important}@media screen and (min-width: 599px){[_nghost-%COMP%]     .tb-entity-select{display:flex;flex-direction:row;gap:16px}}[_nghost-%COMP%]     .tb-entity-select tb-entity-type-select{flex:1}[_nghost-%COMP%]     .tb-entity-select tb-entity-autocomplete{flex:1}[_nghost-%COMP%]     .tb-entity-select tb-entity-autocomplete mat-form-field{width:100%!important}']})}}return t})();b();var ka=t=>({perimeterKeyName:t});function Ep(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.latitude-field-name-required")," "))}function Mp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.longitude-field-name-required")," "))}function Np(t,d){if(t&1&&(a(0,"mat-option",22),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.perimeterTypeTranslationMap.get(e))," ")}}function Ap(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.perimeter-key-name-required")," "))}function Dp(t,d){if(t&1&&(a(0,"mat-form-field",23)(1,"mat-label"),l(2),m(3,"translate"),n(),f(4,"input",24),g(5,Ap,3,3,"mat-error",6),a(6,"mat-hint"),l(7),m(8,"translate"),n()()),t&2){let e=v();r(2),V(s(3,3,"rule-node-config.perimeter-key-name")),r(3),p("ngIf",e.geoActionConfigForm.get("perimeterKeyName").hasError("required")),r(2),V(s(8,5,"rule-node-config.perimeter-key-name-hint"))}}function Vp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.circle-center-latitude-required")," "))}function qp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.circle-center-longitude-required")," "))}function kp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.range-required")," "))}function Bp(t,d){if(t&1&&(a(0,"mat-option",22),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,2,i.rangeUnitTranslationMap.get(e))," ")}}function Op(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.range-units-required")," "))}function Rp(t,d){if(t&1&&(a(0,"div",9)(1,"div",3)(2,"mat-form-field",25)(3,"mat-label"),l(4),m(5,"translate"),n(),f(6,"input",26),g(7,Vp,3,3,"mat-error",6),n(),a(8,"mat-form-field",25)(9,"mat-label"),l(10),m(11,"translate"),n(),f(12,"input",27),g(13,qp,3,3,"mat-error",6),n()(),a(14,"div",3)(15,"mat-form-field",25)(16,"mat-label"),l(17),m(18,"translate"),n(),f(19,"input",28),g(20,kp,3,3,"mat-error",6),n(),a(21,"mat-form-field",25)(22,"mat-label"),l(23),m(24,"translate"),n(),a(25,"mat-select",29),g(26,Bp,3,4,"mat-option",12),n(),g(27,Op,3,3,"mat-error",6),n()()()),t&2){let e=v();r(4),V(s(5,9,"rule-node-config.circle-center-latitude")),r(3),p("ngIf",e.geoActionConfigForm.get("centerLatitude").hasError("required")),r(3),V(s(11,11,"rule-node-config.circle-center-longitude")),r(3),p("ngIf",e.geoActionConfigForm.get("centerLongitude").hasError("required")),r(4),V(s(18,13,"rule-node-config.range")),r(3),p("ngIf",e.geoActionConfigForm.get("range").hasError("required")),r(3),V(s(24,15,"rule-node-config.range-units")),r(3),p("ngForOf",e.rangeUnits),r(),p("ngIf",e.geoActionConfigForm.get("rangeUnit").hasError("required"))}}function Lp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.polygon-definition-required")," "))}function Pp(t,d){if(t&1&&(a(0,"div",9)(1,"mat-form-field",30)(2,"mat-label",31),l(3,"rule-node-config.polygon-definition"),n(),f(4,"input",32),a(5,"mat-icon",33),m(6,"translate"),l(7," help "),n(),g(8,Lp,3,3,"mat-error",6),n()()),t&2){let e=v();r(5),h("matTooltip",s(6,2,"rule-node-config.polygon-definition-hint")),r(3),p("ngIf",e.geoActionConfigForm.get("polygonsDefinition").hasError("required"))}}function wp(t,d){if(t&1&&(a(0,"tb-toggle-option",22),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",i.presenceMonitoringStrategies.get(e).value),r(),c(" ",s(2,2,i.presenceMonitoringStrategies.get(e).name)," ")}}function Gp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-inside-duration-value-required")," "))}function jp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.time-value-range")," "))}function Up(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.time-value-range")," "))}function Kp(t,d){if(t&1&&(a(0,"mat-option",22),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,2,i.timeUnitsTranslationMap.get(e))," ")}}function Hp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-outside-duration-value-required")," "))}function zp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.time-value-range")," "))}function Qp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.time-value-range")," "))}function Jp(t,d){if(t&1&&(a(0,"mat-option",22),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,2,i.timeUnitsTranslationMap.get(e))," ")}}function $p(t,d){if(t&1&&(a(0,"div")(1,"div",34)(2,"mat-form-field",35)(3,"mat-label",31),l(4,"rule-node-config.min-inside-duration"),n(),f(5,"input",36),g(6,Gp,3,3,"mat-error",6)(7,jp,3,3,"mat-error",6)(8,Up,3,3,"mat-error",6),n(),a(9,"mat-form-field",35)(10,"mat-label",31),l(11,"rule-node-config.min-inside-duration-time-unit"),n(),a(12,"mat-select",37),g(13,Kp,3,4,"mat-option",12),n()()(),a(14,"div",34)(15,"mat-form-field",35)(16,"mat-label",31),l(17,"rule-node-config.min-outside-duration"),n(),f(18,"input",38),g(19,Hp,3,3,"mat-error",6)(20,zp,3,3,"mat-error",6)(21,Qp,3,3,"mat-error",6),n(),a(22,"mat-form-field",35)(23,"mat-label",31),l(24,"rule-node-config.min-outside-duration-time-unit"),n(),a(25,"mat-select",39),g(26,Jp,3,4,"mat-option",12),n()()()()),t&2){let e=v();r(6),p("ngIf",e.geoActionConfigForm.get("minInsideDuration").hasError("required")),r(),p("ngIf",e.geoActionConfigForm.get("minInsideDuration").hasError("min")),r(),p("ngIf",e.geoActionConfigForm.get("minInsideDuration").hasError("max")),r(5),p("ngForOf",e.timeUnits),r(6),p("ngIf",e.geoActionConfigForm.get("minOutsideDuration").hasError("required")),r(),p("ngIf",e.geoActionConfigForm.get("minOutsideDuration").hasError("min")),r(),p("ngIf",e.geoActionConfigForm.get("minOutsideDuration").hasError("max")),r(5),p("ngForOf",e.timeUnits)}}var or=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.perimeterType=_t,this.perimeterTypes=Object.keys(_t),this.perimeterTypeTranslationMap=vn,this.rangeUnits=Object.keys(kt),this.rangeUnitTranslationMap=hn,this.presenceMonitoringStrategies=Ea,this.presenceMonitoringStrategyKeys=Array.from(this.presenceMonitoringStrategies.keys()),this.timeUnits=Object.keys(Re),this.timeUnitsTranslationMap=Di,this.defaultPaddingEnable=!0}configForm(){return this.geoActionConfigForm}onConfigurationSet(e){this.geoActionConfigForm=this.fb.group({reportPresenceStatusOnEachMessage:[e?e.reportPresenceStatusOnEachMessage:!0,[u.required]],latitudeKeyName:[e?e.latitudeKeyName:null,[u.required]],longitudeKeyName:[e?e.longitudeKeyName:null,[u.required]],perimeterType:[e?e.perimeterType:null,[u.required]],fetchPerimeterInfoFromMessageMetadata:[e?e.fetchPerimeterInfoFromMessageMetadata:!1,[]],perimeterKeyName:[e?e.perimeterKeyName:null,[]],centerLatitude:[e?e.centerLatitude:null,[]],centerLongitude:[e?e.centerLatitude:null,[]],range:[e?e.range:null,[]],rangeUnit:[e?e.rangeUnit:null,[]],polygonsDefinition:[e?e.polygonsDefinition:null,[]],minInsideDuration:[e?e.minInsideDuration:null,[u.required,u.min(1),u.max(2147483647)]],minInsideDurationTimeUnit:[e?e.minInsideDurationTimeUnit:null,[u.required]],minOutsideDuration:[e?e.minOutsideDuration:null,[u.required,u.min(1),u.max(2147483647)]],minOutsideDurationTimeUnit:[e?e.minOutsideDurationTimeUnit:null,[u.required]]})}validatorTriggers(){return["fetchPerimeterInfoFromMessageMetadata","perimeterType"]}updateValidators(e){let i=this.geoActionConfigForm.get("fetchPerimeterInfoFromMessageMetadata").value,o=this.geoActionConfigForm.get("perimeterType").value;i?this.geoActionConfigForm.get("perimeterKeyName").setValidators([u.required]):this.geoActionConfigForm.get("perimeterKeyName").setValidators([]),!i&&o===_t.CIRCLE?(this.geoActionConfigForm.get("centerLatitude").setValidators([u.required,u.min(-90),u.max(90)]),this.geoActionConfigForm.get("centerLongitude").setValidators([u.required,u.min(-180),u.max(180)]),this.geoActionConfigForm.get("range").setValidators([u.required,u.min(0)]),this.geoActionConfigForm.get("rangeUnit").setValidators([u.required]),this.defaultPaddingEnable=!1):(this.geoActionConfigForm.get("centerLatitude").setValidators([]),this.geoActionConfigForm.get("centerLongitude").setValidators([]),this.geoActionConfigForm.get("range").setValidators([]),this.geoActionConfigForm.get("rangeUnit").setValidators([]),this.defaultPaddingEnable=!0),!i&&o===_t.POLYGON?this.geoActionConfigForm.get("polygonsDefinition").setValidators([u.required]):this.geoActionConfigForm.get("polygonsDefinition").setValidators([]),this.geoActionConfigForm.get("perimeterKeyName").updateValueAndValidity({emitEvent:e}),this.geoActionConfigForm.get("centerLatitude").updateValueAndValidity({emitEvent:e}),this.geoActionConfigForm.get("centerLongitude").updateValueAndValidity({emitEvent:e}),this.geoActionConfigForm.get("range").updateValueAndValidity({emitEvent:e}),this.geoActionConfigForm.get("rangeUnit").updateValueAndValidity({emitEvent:e}),this.geoActionConfigForm.get("polygonsDefinition").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-gps-geofencing-config"]],features:[M],decls:52,vars:42,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],[1,"tb-form-panel","stroked"],["translate","",1,"tb-form-panel-title"],[1,"flex","flex-row","gap-4"],[1,"mat-block","max-w-50%","flex-full"],["matInput","","formControlName","latitudeKeyName","required",""],[4,"ngIf"],["matInput","","formControlName","longitudeKeyName","required",""],["translate","",1,"tb-form-hint","tb-primary-fill"],[1,"flex","flex-col"],["hideRequiredMarker","",1,"mat-block","flex-1"],["formControlName","perimeterType"],[3,"value",4,"ngFor","ngForOf"],[1,"tb-form-row","no-border","no-padding","slide-toggle",3,"tb-hint-tooltip-icon"],["formControlName","fetchPerimeterInfoFromMessageMetadata",1,"mat-slide"],["class","mat-block",4,"ngIf"],["class","flex flex-col",4,"ngIf"],[1,"tb-form-panel","stroked","no-padding-bottom"],[1,"flex","flex-col","items-stretch","justify-between","gt-sm:flex-row","lt-md:gap-4"],[1,"tb-form-panel-title"],["formControlName","reportPresenceStatusOnEachMessage","appearance","fill",1,"fetch-to-data-toggle"],[1,"tb-form-hint","tb-primary-fill"],[3,"value"],[1,"mat-block"],["matInput","","formControlName","perimeterKeyName","required",""],[1,"flex-1"],["type","number","min","-90","max","90","step","0.1","matInput","","formControlName","centerLatitude","required",""],["type","number","min","-180","max","180","step","0.1","matInput","","formControlName","centerLongitude","required",""],["type","number","min","0","step","0.1","matInput","","formControlName","range","required",""],["formControlName","rangeUnit","required",""],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["matInput","","formControlName","polygonsDefinition","required",""],["matSuffix","","aria-hidden","false","aria-label","help-icon","color","primary",1,"margin-8","cursor-pointer",3,"matTooltip"],[1,"flex","flex-col","gt-sm:flex-row","gt-sm:gap-2"],[1,"mat-block","flex-1"],["type","number","step","1","min","1","max","2147483647","matInput","","formControlName","minInsideDuration","required",""],["formControlName","minInsideDurationTimeUnit","required",""],["type","number","step","1","min","1","max","2147483647","matInput","","formControlName","minOutsideDuration","required",""],["formControlName","minOutsideDurationTimeUnit","required",""]],template:function(i,o){i&1&&(a(0,"section",0)(1,"section",1)(2,"div",2),l(3,"rule-node-config.coordinate-field-names"),n(),a(4,"section")(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),l(8),m(9,"translate"),n(),f(10,"input",5),g(11,Ep,3,3,"mat-error",6),n(),a(12,"mat-form-field",4)(13,"mat-label"),l(14),m(15,"translate"),n(),f(16,"input",7),g(17,Mp,3,3,"mat-error",6),n()(),a(18,"div",8),l(19,"rule-node-config.coordinate-field-hint"),n()()(),a(20,"section",1)(21,"div",2),l(22,"rule-node-config.geofence-configuration"),n(),a(23,"section",9)(24,"mat-form-field",10)(25,"mat-label"),l(26),m(27,"translate"),n(),a(28,"mat-select",11),g(29,Np,3,4,"mat-option",12),n()(),a(30,"div",13),m(31,"translate"),m(32,"translate"),a(33,"mat-slide-toggle",14),l(34),m(35,"translate"),n()(),g(36,Dp,9,7,"mat-form-field",15)(37,Rp,28,17,"div",16)(38,Pp,9,4,"div",16),n()(),a(39,"section",17)(40,"div",18)(41,"div",19),l(42),m(43,"translate"),n(),a(44,"tb-toggle-select",20),g(45,wp,3,4,"tb-toggle-option",12),n()(),a(46,"div",21),l(47),m(48,"translate"),m(49,"translate"),n(),a(50,"section",9),g(51,$p,27,8,"div",6),n()()()),i&2&&(p("formGroup",o.geoActionConfigForm),r(8),V(s(9,18,"rule-node-config.latitude-field-name")),r(3),p("ngIf",o.geoActionConfigForm.get("latitudeKeyName").hasError("required")),r(3),V(s(15,20,"rule-node-config.longitude-field-name")),r(3),p("ngIf",o.geoActionConfigForm.get("longitudeKeyName").hasError("required")),r(3),He("no-padding-bottom",!o.defaultPaddingEnable),r(6),V(s(27,22,"rule-node-config.perimeter-type")),r(3),p("ngForOf",o.perimeterTypes),r(),h("tb-hint-tooltip-icon",o.geoActionConfigForm.get("perimeterType").value===o.perimeterType.CIRCLE?ae(31,24,"rule-node-config.fetch-circle-parameter-info-from-metadata-hint",Fe(38,ka,o.geoActionConfigForm.get("perimeterKeyName").valid?o.geoActionConfigForm.get("perimeterKeyName").value:"ss_perimeter")):ae(32,27,"rule-node-config.fetch-poligon-parameter-info-from-metadata-hint",Fe(40,ka,o.geoActionConfigForm.get("perimeterKeyName").valid?o.geoActionConfigForm.get("perimeterKeyName").value:"ss_perimeter"))),r(4),c(" ",s(35,30,"rule-node-config.fetch-perimeter-info-from-metadata")," "),r(2),p("ngIf",o.geoActionConfigForm.get("fetchPerimeterInfoFromMessageMetadata").value),r(),p("ngIf",o.geoActionConfigForm.get("perimeterType").value===o.perimeterType.CIRCLE&&!o.geoActionConfigForm.get("fetchPerimeterInfoFromMessageMetadata").value),r(),p("ngIf",o.geoActionConfigForm.get("perimeterType").value===o.perimeterType.POLYGON&&!o.geoActionConfigForm.get("fetchPerimeterInfoFromMessageMetadata").value),r(4),V(s(43,32,"rule-node-config.presence-monitoring-strategy")),r(3),p("ngForOf",o.presenceMonitoringStrategyKeys),r(2),c(" ",o.geoActionConfigForm.get("reportPresenceStatusOnEachMessage").value===!1?s(48,34,"rule-node-config.presence-monitoring-strategy-on-first-message-hint"):s(49,36,"rule-node-config.presence-monitoring-strategy-on-each-message-hint")," "),r(4),p("ngIf",o.geoActionConfigForm.get("reportPresenceStatusOnEachMessage").value===!1))},dependencies:[z,k,X,R,q,B,se,Q,oe,ee,W,Z,de,O,fe,S,x,A,ve,ot,_,E,D,Qe,Je,ge,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .slide-toggle[_ngcontent-%COMP%]{margin-bottom:18px}']})}}return t})();b();function Yp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.interval-seconds-required")," "))}function Wp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-interval-seconds-message")," "))}function Xp(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.output-timeseries-key-prefix-required")," "))}var ar=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.msgCountConfigForm}onConfigurationSet(e){this.msgCountConfigForm=this.fb.group({interval:[e?e.interval:null,[u.required,u.min(1)]],telemetryPrefix:[e?e.telemetryPrefix:null,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-msg-count-config"]],features:[M],decls:12,vars:4,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"mat-block"],["translate",""],["required","","type","number","min","1","step","1","matInput","","formControlName","interval"],[4,"ngIf"],["required","","matInput","","formControlName","telemetryPrefix"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.interval-seconds"),n(),f(4,"input",3),g(5,Yp,3,3,"mat-error",4)(6,Wp,3,3,"mat-error",4),n(),a(7,"mat-form-field",1)(8,"mat-label",2),l(9,"rule-node-config.output-timeseries-key-prefix"),n(),f(10,"input",5),g(11,Xp,3,3,"mat-error",4),n()()),i&2&&(p("formGroup",o.msgCountConfigForm),r(5),p("ngIf",o.msgCountConfigForm.get("interval").hasError("required")),r(),p("ngIf",o.msgCountConfigForm.get("interval").hasError("min")),r(5),p("ngIf",o.msgCountConfigForm.get("telemetryPrefix").hasError("required")))},dependencies:[k,R,q,B,Q,O,fe,S,x,A,ve,_,E,D,I],encapsulation:2})}}return t})();b();var lr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.rpcReplyConfigForm}onConfigurationSet(e){this.rpcReplyConfigForm=this.fb.group({serviceIdMetaDataAttribute:[e?e.serviceIdMetaDataAttribute:null,[]],sessionIdMetaDataAttribute:[e?e.sessionIdMetaDataAttribute:null,[]],requestIdMetaDataAttribute:[e?e.requestIdMetaDataAttribute:null,[]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-rpc-reply-config"]],features:[M],decls:17,vars:2,consts:[[1,"tb-form-panel","stroked","no-padding-bottom",3,"formGroup"],["translate","",1,"tb-form-panel-title"],[3,"hintText"],[1,"tb-form-row","no-border","no-padding","tb-standard-fields","column-xs"],[1,"flex"],["translate",""],["matInput","","formControlName","serviceIdMetaDataAttribute"],["matInput","","formControlName","sessionIdMetaDataAttribute"],["matInput","","formControlName","requestIdMetaDataAttribute"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),l(2,"rule-node-config.reply-routing-configuration"),n(),f(3,"tb-example-hint",2),a(4,"div",3)(5,"mat-form-field",4)(6,"mat-label",5),l(7,"rule-node-config.service-id-metadata-attribute"),n(),f(8,"input",6),n(),a(9,"mat-form-field",4)(10,"mat-label",5),l(11,"rule-node-config.session-id-metadata-attribute"),n(),f(12,"input",7),n(),a(13,"mat-form-field",4)(14,"mat-label",5),l(15,"rule-node-config.request-id-metadata-attribute"),n(),f(16,"input",8),n()()()),i&2&&(p("formGroup",o.rpcReplyConfigForm),r(3),p("hintText","rule-node-config.rpc-reply-routing-configuration-hint"))},dependencies:[R,q,B,O,S,x,_,E,D,Te],encapsulation:2})}}return t})();b();b();var Zp=(t,d)=>({valText:t,keyText:d});function em(t,d){if(t&1&&(a(0,"div",13),l(1),n()),t&2){let e=v();r(),c(" ",e.requiredText," ")}}function tm(t,d){t&1&&(a(0,"div",13),l(1," rule-node-config.map-fields-required "),n())}function im(t,d){if(t&1&&(a(0,"div",13),l(1),m(2,"translate"),n()),t&2){let e=v();r(),c(" ",ae(2,1,"rule-node-config.key-val.unique-key-value-pair-error",Yt(4,Zp,e.valText,e.keyText))," ")}}function nm(t,d){if(t&1){let e=pe();a(0,"div",14)(1,"mat-form-field",15),f(2,"input",16),n(),a(3,"mat-form-field",15),f(4,"input",16),n(),a(5,"div",17)(6,"button",18),m(7,"translate"),$("click",function(){let o=ie(e).index,C=v();return ne(C.removeKeyVal(o))}),a(8,"mat-icon"),l(9,"delete"),n()()()()}if(t&2){let e=d.$implicit,i=v();r(2),p("placeholder",i.keyText+"*")("formControl",e.get("key")),r(2),p("placeholder",i.valText+"*")("formControl",e.get("value")),r(2),He("tb-hidden",i.keyValsFormArray().controls.length===1),h("matTooltip",s(7,8,"rule-node-config.key-val.remove-mapping-entry")),p("disabled",i.disabled)}}function rm(t,d){if(t&1&&f(0,"tb-example-hint",19),t&2){let e=v();p("hintText",e.hintText)("popupHelpLink",e.popupHelpLink)}}var lt=class t{constructor(d,e,i){this.injector=d,this.fb=e,this.destroyRef=i,this.propagateChange=()=>{},this.disabled=!1,this.uniqueKeyValuePairValidator=!1,this.required=!1,this.duplicateValuesValidator=o=>o.controls.key.value===o.controls.value.value&&o.controls.key.value&&o.controls.value.value?{uniqueKeyValuePair:!0}:null,this.oneMapRequiredValidator=o=>o.get("keyVals").value.length,this.propagateNestedErrors=o=>{if(this.kvListFormGroup&&this.kvListFormGroup.get("keyVals")&&this.kvListFormGroup.get("keyVals")?.status==="VALID")return null;let C={};if(this.kvListFormGroup&&this.kvListFormGroup.setErrors(null),o instanceof ln||o instanceof on){if(o.errors)for(let H of Object.keys(o.errors))C[H]=!0;for(let H of Object.keys(o.controls)){let Ce=this.propagateNestedErrors(o.controls[H]);if(Ce&&Object.keys(Ce).length)for(let si of Object.keys(Ce))C[si]=!0}return C}else if(o.errors)for(let H of Object.keys(o.errors))C[H]=!0;return en(C,{})?null:C}}ngOnInit(){this.ngControl=this.injector.get(bi),this.ngControl!=null&&(this.ngControl.valueAccessor=this),this.kvListFormGroup=this.fb.group({keyVals:this.fb.array([])},{validators:[this.propagateNestedErrors,this.oneMapRequiredValidator]}),this.kvListFormGroup.valueChanges.pipe(ce(this.destroyRef)).subscribe(()=>{this.updateModel()})}keyValsFormArray(){return this.kvListFormGroup.get("keyVals")}registerOnChange(d){this.propagateChange=d}registerOnTouched(d){}setDisabledState(d){this.disabled=d,this.disabled?this.kvListFormGroup.disable({emitEvent:!1}):this.kvListFormGroup.enable({emitEvent:!1})}writeValue(d){let e=Object.keys(d).map(i=>({key:i,value:d[i]}));if(this.keyValsFormArray().length===e.length)this.keyValsFormArray().patchValue(e,{emitEvent:!1});else{let i=[];e.forEach(o=>{i.push(this.fb.group({key:[o.key,[u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)]],value:[o.value,[u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)]]},{validators:this.uniqueKeyValuePairValidator?[this.duplicateValuesValidator]:[]}))}),this.kvListFormGroup.setControl("keyVals",this.fb.array(i,this.propagateNestedErrors),{emitEvent:!1})}}removeKeyVal(d){this.keyValsFormArray().removeAt(d)}addKeyVal(){this.keyValsFormArray().push(this.fb.group({key:["",[u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)]],value:["",[u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)]]},{validators:this.uniqueKeyValuePairValidator?[this.duplicateValuesValidator]:[]}))}validate(){let d=this.kvListFormGroup.get("keyVals").value;if(!d.length&&this.required)return{kvMapRequired:!0};if(!this.kvListFormGroup.valid)return{kvFieldsRequired:!0};if(this.uniqueKeyValuePairValidator){for(let e of d)if(e.key===e.value)return{uniqueKeyValuePair:!0}}return null}updateModel(){let d=this.kvListFormGroup.get("keyVals").value;if(this.required&&!d.length||!this.kvListFormGroup.valid)this.propagateChange(null);else{let e={};d.forEach(i=>{e[i.key]=i.value}),this.propagateChange(e)}}static{this.\u0275fac=function(e){return new(e||t)(y(yi),y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-kv-map-config"]],inputs:{disabled:"disabled",uniqueKeyValuePairValidator:"uniqueKeyValuePairValidator",labelText:"labelText",requiredText:"requiredText",keyText:"keyText",keyRequiredText:"keyRequiredText",valText:"valText",valRequiredText:"valRequiredText",hintText:"hintText",popupHelpLink:"popupHelpLink",required:"required"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:ue(()=>t),multi:!0}])],decls:22,vars:12,consts:[[1,"tb-form-panel","stroked",3,"formGroup"],[1,"tb-form-row","no-padding","no-border","space-between"],[1,"tb-form-panel-title"],["class","tb-form-panel-hint tb-error","translate","",4,"ngIf"],[1,"tb-form-panel","no-border","no-padding"],[1,"tb-form-table"],[1,"tb-form-table-header"],[1,"tb-form-table-header-cell","field-space"],[1,"tb-form-table-header-cell","actions-header"],[1,"tb-form-table-body"],["class","tb-form-table-row",4,"ngFor","ngForOf"],["type","button","mat-stroked-button","","color","primary",3,"click"],[3,"hintText","popupHelpLink",4,"ngIf"],["translate","",1,"tb-form-panel-hint","tb-error"],[1,"tb-form-table-row"],["appearance","outline","subscriptSizing","dynamic",1,"tb-inline-field","field-space"],["matInput","",3,"placeholder","formControl"],[1,"tb-form-table-row-cell-buttons"],["type","button","mat-icon-button","","matTooltipPosition","above",3,"click","disabled","matTooltip"],[3,"hintText","popupHelpLink"]],template:function(e,i){e&1&&(a(0,"section",0)(1,"div",1)(2,"div",2),l(3),n(),g(4,em,2,1,"div",3)(5,tm,2,0,"div",3)(6,im,3,7,"div",3),n(),a(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7),l(11),n(),a(12,"div",7),l(13),n(),f(14,"div",8),n(),a(15,"div",9),g(16,nm,10,10,"div",10),n()()(),a(17,"div")(18,"button",11),$("click",function(){return i.addKeyVal()}),l(19),m(20,"translate"),n()(),g(21,rm,1,2,"tb-example-hint",12),n()),e&2&&(p("formGroup",i.kvListFormGroup),r(3),V(i.labelText),r(),p("ngIf",i.kvListFormGroup.hasError("kvMapRequired")),r(),p("ngIf",i.kvListFormGroup.hasError("required")),r(),p("ngIf",i.kvListFormGroup.hasError("uniqueKeyValuePair")),r(5),V(i.keyText),r(2),V(i.valText),r(3),p("ngForOf",i.keyValsFormArray().controls),r(3),c(" ",s(20,10,"rule-node-config.key-val.add-mapping-entry")," "),r(2),p("ngIf",i.popupHelpLink||i.hintText))},dependencies:[z,k,we,_e,X,R,q,Z,O,S,x,ti,_,D,Te,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .field-space[_ngcontent-%COMP%]{flex:1 1 50%}[_nghost-%COMP%]   .actions-header[_ngcontent-%COMP%]{width:40px}']})}};Ke([at(),je("design:type",Object)],lt.prototype,"disabled",void 0);Ke([at(),je("design:type",Object)],lt.prototype,"uniqueKeyValuePairValidator",void 0);Ke([at(),je("design:type",Object)],lt.prototype,"required",void 0);function om(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.custom-table-name-required")," "))}function am(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-default-ttl-message")," "))}function lm(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.default-ttl-required")," "))}var pr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.saveToCustomTableConfigForm}onConfigurationSet(e){this.saveToCustomTableConfigForm=this.fb.group({tableName:[e?e.tableName:null,[u.required,u.pattern(/.*\S.*/)]],fieldsMapping:[e?e.fieldsMapping:null,[u.required]],defaultTtl:[e?e.defaultTtl:0,[u.required,u.min(0)]]})}prepareOutputConfig(e){return e.tableName=e.tableName.trim(),e}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-custom-table-config"]],features:[M],decls:24,vars:26,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","tableName"],["aria-hidden","false","aria-label","help-icon","matSuffix","",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],[4,"ngIf"],["required","","formControlName","fieldsMapping",3,"labelText","requiredText","keyText","keyRequiredText","valText","valRequiredText","hintText"],[1,"mat-block","flex-1"],["type","number","min","0","step","1","matInput","","formControlName","defaultTtl","required",""]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.custom-table-name"),n(),f(4,"input",3),a(5,"mat-icon",4),m(6,"translate"),l(7," help "),n(),g(8,om,3,3,"mat-error",5),n(),f(9,"tb-kv-map-config",6),m(10,"translate"),m(11,"translate"),m(12,"translate"),m(13,"translate"),m(14,"translate"),m(15,"translate"),a(16,"mat-form-field",7)(17,"mat-label",2),l(18,"rule-node-config.default-ttl"),n(),f(19,"input",8),a(20,"mat-hint",2),l(21,"rule-node-config.default-ttl-zero-hint"),n(),g(22,am,3,3,"mat-error",5)(23,lm,3,3,"mat-error",5),n()()),i&2&&(p("formGroup",o.saveToCustomTableConfigForm),r(5),h("matTooltip",s(6,12,"rule-node-config.custom-table-hint")),r(3),p("ngIf",o.saveToCustomTableConfigForm.get("tableName").hasError("required")||o.saveToCustomTableConfigForm.get("tableName").hasError("pattern")),r(),p("labelText",s(10,14,"rule-node-config.fields-mapping"))("requiredText",s(11,16,"rule-node-config.fields-mapping-required"))("keyText",s(12,18,"rule-node-config.message-field"))("keyRequiredText",s(13,20,"rule-node-config.message-field-required"))("valText",s(14,22,"rule-node-config.table-col"))("valRequiredText",s(15,24,"rule-node-config.table-col-required"))("hintText","rule-node-config.fields-mapping-hint"),r(13),p("ngIf",o.saveToCustomTableConfigForm.get("defaultTtl").hasError("min")),r(),p("ngIf",o.saveToCustomTableConfigForm.get("defaultTtl").hasError("required")))},dependencies:[k,X,R,q,B,se,Q,oe,Z,O,fe,S,x,A,ve,_,E,D,lt,I],encapsulation:2})}}return t})();b();b();var pm=t=>({inputName:t});function mm(t,d){if(t&1&&(a(0,"mat-option",13),l(1),m(2,"translate"),a(3,"span",3),l(4,"rule-node-config.relations-query-config-direction-suffix"),n()()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.directionTypeTranslations.get(e))," ")}}function sm(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-relation-level-error")," "))}function dm(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-relation-level-invalid")," "))}function um(t,d){t&1&&(a(0,"div",14),m(1,"translate"),a(2,"mat-slide-toggle",15),l(3),m(4,"translate"),n()()),t&2&&(h("tb-hint-tooltip-icon",s(1,2,"rule-node-config.last-level-device-relation-tooltip")),r(3),c(" ",s(4,4,"alias.last-level-relation")," "))}var Ki=(()=>{class t extends tt{get required(){return this.requiredValue}set required(e){this.requiredValue=yt(e)}constructor(e,i){super(),this.fb=e,this.destroyRef=i,this.directionTypes=Object.values(mt),this.directionTypeTranslations=oi,this.entityType=Y,this.propagateChange=null}ngOnInit(){this.deviceRelationsQueryFormGroup=this.fb.group({fetchLastLevelOnly:[!1,[]],direction:[null,[u.required]],maxLevel:[null,[u.min(1)]],relationType:[null],deviceTypes:[null,[u.required]]}),this.deviceRelationsQueryFormGroup.valueChanges.pipe(ce(this.destroyRef)).subscribe(e=>{this.deviceRelationsQueryFormGroup.valid?this.propagateChange(e):this.propagateChange(null)})}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}setDisabledState(e){this.disabled=e,this.disabled?this.deviceRelationsQueryFormGroup.disable({emitEvent:!1}):this.deviceRelationsQueryFormGroup.enable({emitEvent:!1})}writeValue(e){this.deviceRelationsQueryFormGroup.reset(e,{emitEvent:!1})}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-device-relations-query-config"]],inputs:{disabled:"disabled",required:"required"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0}]),M],decls:24,vars:26,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"flex","flex-row","gap-5"],["subscriptSizing","dynamic","hideRequiredMarker","",1,"mat-block","max-w-50%","flex-full",2,"min-width","100px"],["translate",""],["required","","formControlName","direction"],[3,"value",4,"ngFor","ngForOf"],["floatLabel","always",1,"mat-block","max-w-50%","flex-full"],["matInput","","type","text","pattern","[0-9]*","inputmode","numeric","min","1","formControlName","maxLevel",3,"placeholder"],[4,"ngIf"],["class","tb-form-row no-border no-padding last-level-slide-toggle",3,"tb-hint-tooltip-icon",4,"ngIf"],["formControlName","relationType",1,"flex-1"],["required","","formControlName","deviceTypes",3,"label","entityType","emptyInputPlaceholder","filledInputPlaceholder"],["matSuffix","","aria-hidden","false","aria-label","help-icon","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],[3,"value"],[1,"tb-form-row","no-border","no-padding","last-level-slide-toggle",3,"tb-hint-tooltip-icon"],["formControlName","fetchLastLevelOnly",1,"mat-slide"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-label",3),l(4,"relation.direction"),n(),a(5,"mat-select",4),g(6,mm,5,4,"mat-option",5),n()(),a(7,"mat-form-field",6)(8,"mat-label",3),l(9,"rule-node-config.max-relation-level"),n(),f(10,"input",7),m(11,"translate"),g(12,sm,3,3,"mat-error",8)(13,dm,3,3,"mat-error",8),n()(),g(14,um,5,6,"div",9),f(15,"tb-relation-type-autocomplete",10),a(16,"tb-entity-subtype-list",11),m(17,"translate"),m(18,"translate"),m(19,"translate"),a(20,"mat-icon",12),m(21,"translate"),m(22,"translate"),l(23,"help"),n()()()),i&2&&(p("formGroup",o.deviceRelationsQueryFormGroup),r(6),p("ngForOf",o.directionTypes),r(4),h("placeholder",s(11,11,"rule-node-config.unlimited-level")),r(2),p("ngIf",o.deviceRelationsQueryFormGroup.get("maxLevel").hasError("min")),r(),p("ngIf",o.deviceRelationsQueryFormGroup.get("maxLevel").invalid),r(),p("ngIf",o.deviceRelationsQueryFormGroup.get("maxLevel").value>1),r(2),p("label",s(17,13,"rule-node-config.device-profiles"))("entityType",o.entityType.DEVICE)("emptyInputPlaceholder",s(18,15,"rule-node-config.add-device-profile"))("filledInputPlaceholder",s(19,17,"rule-node-config.add-device-profile")),r(4),h("matTooltip",ae(22,21,"rule-node-config.chip-help",Fe(24,pm,s(21,19,"rule-node-config.device-profile")))))},dependencies:[z,k,Uo,ai,X,R,q,B,Q,oe,ee,W,Z,de,O,S,x,A,Ti,_,E,D,ge,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .last-level-slide-toggle[_ngcontent-%COMP%]{margin:8px 0 24px}']})}}return t})();b();function gm(t,d){if(t&1&&(a(0,"mat-option",13),l(1),m(2,"translate"),a(3,"span",4),l(4,"rule-node-config.relations-query-config-direction-suffix"),n()()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.directionTypeTranslations.get(e))," ")}}function Cm(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-relation-level-error")," "))}function ym(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-relation-level-invalid")," "))}function vm(t,d){t&1&&(a(0,"div",14),m(1,"translate"),a(2,"mat-slide-toggle",15),l(3),m(4,"translate"),n()()),t&2&&(h("tb-hint-tooltip-icon",s(1,2,"rule-node-config.last-level-relation-tooltip")),r(3),c(" ",s(4,4,"alias.last-level-relation")," "))}var fi=(()=>{class t extends tt{get required(){return this.requiredValue}set required(e){this.requiredValue=yt(e)}constructor(e,i){super(),this.fb=e,this.destroyRef=i,this.directionTypes=Object.values(mt),this.directionTypeTranslations=oi,this.propagateChange=null}ngOnInit(){this.relationsQueryFormGroup=this.fb.group({fetchLastLevelOnly:[!1,[]],direction:[null,[u.required]],maxLevel:[null,[u.min(1)]],filters:[null]}),this.relationsQueryFormGroup.valueChanges.pipe(ce(this.destroyRef)).subscribe(e=>{this.relationsQueryFormGroup.valid?this.propagateChange(e):this.propagateChange(null)})}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}setDisabledState(e){this.disabled=e,this.disabled?this.relationsQueryFormGroup.disable({emitEvent:!1}):this.relationsQueryFormGroup.enable({emitEvent:!1})}writeValue(e){this.relationsQueryFormGroup.reset(e||{},{emitEvent:!1})}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-relations-query-config"]],inputs:{disabled:"disabled",required:"required"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0}]),M],decls:22,vars:9,consts:[[1,"tb-form-panel","stroked",3,"formGroup"],["translate","",1,"tb-form-panel-title","tb-required"],[1,"flex","flex-row","gap-4"],["hideRequiredMarker","",1,"mat-block","max-w-50%","flex-full",2,"min-width","100px"],["translate",""],["required","","formControlName","direction"],[3,"value",4,"ngFor","ngForOf"],["floatLabel","always",1,"mat-block","max-w-50%","flex-full"],["matInput","","type","text","pattern","[0-9]*","min","1","inputmode","numeric","formControlName","maxLevel",3,"placeholder"],[4,"ngIf"],["class","tb-form-row no-border no-padding last-level-slide-toggle",3,"tb-hint-tooltip-icon",4,"ngIf"],["translate","",1,"tb-form-panel-title"],["formControlName","filters"],[3,"value"],[1,"tb-form-row","no-border","no-padding","last-level-slide-toggle",3,"tb-hint-tooltip-icon"],["formControlName","fetchLastLevelOnly",1,"mat-slide"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),l(2,"rule-node-config.relations-query"),n(),a(3,"section")(4,"div",2)(5,"mat-form-field",3)(6,"mat-label",4),l(7,"relation.direction"),n(),a(8,"mat-select",5),g(9,gm,5,4,"mat-option",6),n()(),a(10,"mat-form-field",7)(11,"mat-label",4),l(12,"rule-node-config.max-relation-level"),n(),f(13,"input",8),m(14,"translate"),g(15,Cm,3,3,"mat-error",9)(16,ym,3,3,"mat-error",9),n()(),g(17,vm,5,6,"div",10),n(),a(18,"section",0)(19,"div",11),l(20,"relation.relation-filters"),n(),f(21,"tb-relation-filters",12),n()()),i&2&&(p("formGroup",o.relationsQueryFormGroup),r(9),p("ngForOf",o.directionTypes),r(4),h("placeholder",s(14,7,"rule-node-config.unlimited-level")),r(2),p("ngIf",o.relationsQueryFormGroup.get("maxLevel").hasError("min")),r(),p("ngIf",o.relationsQueryFormGroup.get("maxLevel").invalid),r(),p("ngIf",o.relationsQueryFormGroup.get("maxLevel").value>1),r(),p("formGroup",o.relationsQueryFormGroup))},dependencies:[z,k,R,q,B,Q,ee,W,de,O,S,x,A,Ti,_,E,D,ge,yn,I],encapsulation:2})}}return t})();b();var Tm=["chipList"],xm=["messageTypeAutocomplete"],_m=["messageTypeInput"],Sm=t=>({inputName:t}),Fm=t=>({messageType:t});function Im(t,d){if(t&1&&(a(0,"mat-label"),l(1),n()),t&2){let e=v();r(),V(e.label)}}function Em(t,d){if(t&1){let e=pe();a(0,"mat-chip-row",13),$("removed",function(){let o=ie(e).$implicit,C=v();return ne(C.remove(o))}),l(1),a(2,"mat-icon",14),l(3,"close"),n()()}if(t&2){let e=d.$implicit;p("removable",!0),r(),c(" ",e.name," ")}}function Mm(t,d){if(t&1&&(a(0,"mat-option",15),f(1,"span",16),m(2,"highlight"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),p("innerHTML",ae(2,2,e.name,i.searchText),Pe)}}function Nm(t,d){t&1&&(a(0,"div")(1,"span",21),l(2,"rule-node-config.no-message-types-found"),n()())}function Am(t,d){if(t&1&&(a(0,"span"),l(1),m(2,"translate"),n()),t&2){let e=v(2);r(),c(" ",ae(2,1,"rule-node-config.no-message-type-matching",Fe(4,Fm,e.truncate.transform(e.searchText,!0,6,"...")))," ")}}function Dm(t,d){if(t&1){let e=pe();a(0,"mat-option",17)(1,"div",18),$("click",function(o){return ie(e),ne(o.stopPropagation())}),g(2,Nm,3,0,"div",19)(3,Am,3,6,"ng-template",null,3,Rt),a(5,"span")(6,"a",20),$("click",function(o){ie(e);let C=v();return ne(C.createMessageType(o,C.searchText))}),l(7,"rule-node-config.create-new-message-type"),n()()()()}if(t&2){let e=Xe(4),i=v();p("value",null),r(2),p("ngIf",!i.textIsNotEmpty(i.searchText))("ngIfElse",e)}}function Vm(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.select-message-types-required")," "))}var Hi=(()=>{class t extends tt{get required(){return this.requiredValue}set required(e){this.requiredValue=yt(e)}constructor(e,i,o){super(),this.translate=e,this.truncate=i,this.fb=o,this.placeholder="rule-node-config.add-message-type",this.separatorKeysCodes=[13,188,186],this.messageTypes=[],this.messageTypesList=[],this.searchText="",this.propagateChange=C=>{},this.messageTypeConfigForm=this.fb.group({messageType:[null]});for(let C of Object.keys(Lt))this.messageTypesList.push({name:gn.get(Lt[C]),value:C})}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}ngOnInit(){this.filteredMessageTypes=this.messageTypeConfigForm.get("messageType").valueChanges.pipe(po(""),Wi(e=>e||""),ao(e=>this.fetchMessageTypes(e)),lo())}setDisabledState(e){this.disabled=e,this.disabled?this.messageTypeConfigForm.disable({emitEvent:!1}):this.messageTypeConfigForm.enable({emitEvent:!1})}writeValue(e){this.searchText="",this.messageTypes.length=0,e&&e.forEach(i=>{let o=this.messageTypesList.find(C=>C.value===i);o?this.messageTypes.push({name:o.name,value:o.value}):this.messageTypes.push({name:i,value:i})})}displayMessageTypeFn(e){return e?e.name:void 0}textIsNotEmpty(e){return e&&e.length>0}createMessageType(e,i){e.preventDefault(),this.transformMessageType(i)}add(e){this.transformMessageType(e.value)}fetchMessageTypes(e){if(this.searchText=e,this.searchText&&this.searchText.length){let i=this.searchText.toUpperCase();return Vn(this.messageTypesList.filter(o=>o.name.toUpperCase().includes(i)))}else return Vn(this.messageTypesList)}transformMessageType(e){if((e||"").trim()){let i,o=e.trim(),C=this.messageTypesList.find(H=>H.name===o);C?i={name:C.name,value:C.value}:i={name:o,value:o},i&&this.addMessageType(i)}this.clear("")}remove(e){let i=this.messageTypes.indexOf(e);i>=0&&(this.messageTypes.splice(i,1),this.updateModel())}selected(e){this.addMessageType(e.option.value),this.clear("")}addMessageType(e){this.messageTypes.findIndex(o=>o.value===e.value)===-1&&(this.messageTypes.push(e),this.updateModel())}onFocus(){this.messageTypeConfigForm.get("messageType").updateValueAndValidity({onlySelf:!0,emitEvent:!0})}clear(e=""){this.messageTypeInput.nativeElement.value=e,this.messageTypeConfigForm.get("messageType").patchValue(null,{emitEvent:!0}),setTimeout(()=>{this.messageTypeInput.nativeElement.blur(),this.messageTypeInput.nativeElement.focus()},0)}updateModel(){let e=this.messageTypes.map(i=>i.value);this.required?(this.chipList.errorState=!e.length,this.propagateChange(e.length>0?e:null)):(this.chipList.errorState=!1,this.propagateChange(e))}static{this.\u0275fac=function(i){return new(i||t)(y(le),y(Ko),y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-message-types-config"]],viewQuery:function(i,o){if(i&1&&(De(Tm,5),De(xm,5),De(_m,5)),i&2){let C;Ve(C=qe())&&(o.chipList=C.first),Ve(C=qe())&&(o.matAutocomplete=C.first),Ve(C=qe())&&(o.messageTypeInput=C.first)}},inputs:{required:"required",label:"label",placeholder:"placeholder",disabled:"disabled"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0}]),M],decls:20,vars:27,consts:[["chipList",""],["messageTypeInput","","origin","matAutocompleteOrigin"],["messageTypeAutocomplete","matAutocomplete"],["searchNotEmpty",""],[2,"width","100%",3,"formGroup"],[4,"ngIf"],[3,"required"],[3,"removable","removed",4,"ngFor","ngForOf"],["matInput","","type","text","formControlName","messageType","matAutocompleteOrigin","",3,"focusin","matChipInputTokenEnd","placeholder","matAutocompleteConnectedTo","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes"],[1,"tb-autocomplete",3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],["class","tb-not-found",3,"value",4,"ngIf"],["aria-hidden","false","aria-label","help-icon","matSuffix","","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],[3,"removed","removable"],["matChipRemove",""],[3,"value"],[3,"innerHTML"],[1,"tb-not-found",3,"value"],[1,"tb-not-found-content",3,"click"],[4,"ngIf","ngIfElse"],["translate","",3,"click"],["translate",""]],template:function(i,o){if(i&1){let C=pe();a(0,"mat-form-field",4),g(1,Im,2,1,"mat-label",5),a(2,"mat-chip-grid",6,0),g(4,Em,4,2,"mat-chip-row",7),a(5,"input",8,1),m(8,"translate"),$("focusin",function(){return ie(C),ne(o.onFocus())})("matChipInputTokenEnd",function(Ce){return ie(C),ne(o.add(Ce))}),n()(),a(9,"mat-autocomplete",9,2),$("optionSelected",function(Ce){return ie(C),ne(o.selected(Ce))}),g(11,Mm,3,5,"mat-option",10),m(12,"async"),g(13,Dm,8,3,"mat-option",11),m(14,"async"),n(),a(15,"mat-icon",12),m(16,"translate"),m(17,"translate"),l(18,"help"),n(),g(19,Vm,3,3,"mat-error",5),n()}if(i&2){let C,H=Xe(3),Ce=Xe(7),si=Xe(10);p("formGroup",o.messageTypeConfigForm),r(),p("ngIf",o.label),r(),p("required",o.required),r(2),p("ngForOf",o.messageTypes),r(),h("placeholder",s(8,14,o.placeholder)),p("matAutocompleteConnectedTo",Ce)("matAutocomplete",si)("matChipInputFor",H)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes),r(4),p("displayWith",o.displayMessageTypeFn),r(2),p("ngForOf",s(12,16,o.filteredMessageTypes)),r(2),p("ngIf",((C=s(14,18,o.filteredMessageTypes))==null?null:C.length)===0),r(2),h("matTooltip",ae(17,22,"rule-node-config.chip-help",Fe(25,Sm,s(16,20,"rule-node-config.message-type")))),r(4),p("ngIf",H.errorState)}},dependencies:[z,k,X,R,q,B,Q,oe,W,Z,pn,mn,Do,Si,Fi,xi,_i,O,S,x,_,E,D,Wt,fn,I],encapsulation:2})}}return t})();b();function km(t,d){if(t&1&&(a(0,"mat-option",12),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e)("disabled",e==="cert.PEM"&&i.disableCertPemCredentials),r(),c(" ",s(2,3,i.credentialsTypeTranslationsMap.get(e))," ")}}function Bm(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.credentials-type-required")," "))}function Om(t,d){}function Rm(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.username-required")," "))}function Lm(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.password-required")," "))}function Pm(t,d){if(t&1&&(a(0,"mat-form-field",4)(1,"mat-label",2),l(2,"rule-node-config.username"),n(),f(3,"input",13),g(4,Rm,3,3,"mat-error",7),n(),a(5,"mat-form-field",4)(6,"mat-label",2),l(7,"rule-node-config.password"),n(),f(8,"input",14)(9,"tb-toggle-password",15),g(10,Lm,3,3,"mat-error",7),n()),t&2){let e=v(2);r(4),p("ngIf",e.credentialsConfigFormGroup.get("username").hasError("required")),r(4),p("required",e.passwordFieldRequired),r(2),p("ngIf",e.credentialsConfigFormGroup.get("password").hasError("required"))}}function wm(t,d){if(t&1){let e=pe();a(0,"div",16),l(1),m(2,"translate"),n(),a(3,"tb-file-input",17),m(4,"translate"),m(5,"translate"),$("fileNameChanged",function(o){ie(e);let C=v(2);return ne(C.credentialsConfigFormGroup.get("caCertFileName").setValue(o))}),n(),a(6,"tb-file-input",18),m(7,"translate"),m(8,"translate"),$("fileNameChanged",function(o){ie(e);let C=v(2);return ne(C.credentialsConfigFormGroup.get("certFileName").setValue(o))}),n(),a(9,"tb-file-input",19),m(10,"translate"),m(11,"translate"),$("fileNameChanged",function(o){ie(e);let C=v(2);return ne(C.credentialsConfigFormGroup.get("privateKeyFileName").setValue(o))}),n(),a(12,"mat-form-field",4)(13,"mat-label",2),l(14,"rule-node-config.private-key-password"),n(),f(15,"input",20)(16,"tb-toggle-password",15),n()}if(t&2){let e=v(2);r(),V(s(2,10,"rule-node-config.credentials-pem-hint")),r(2),h("label",s(4,12,"rule-node-config.ca-cert")),h("dropLabel",s(5,14,"rule-node-config.drop-file")),p("existingFileName",e.credentialsConfigFormGroup.get("caCertFileName").value),r(3),h("label",s(7,16,"rule-node-config.cert")),h("dropLabel",s(8,18,"rule-node-config.drop-file")),p("existingFileName",e.credentialsConfigFormGroup.get("certFileName").value),r(3),h("label",s(10,20,"rule-node-config.private-key")),h("dropLabel",s(11,22,"rule-node-config.drop-file")),p("existingFileName",e.credentialsConfigFormGroup.get("privateKeyFileName").value)}}function Gm(t,d){if(t&1&&(a(0,"mat-form-field",4)(1,"mat-label",2),l(2,"rule-node-config.credentials-type"),n(),a(3,"mat-select",5),g(4,km,3,5,"mat-option",6),n(),g(5,Bm,3,3,"mat-error",7),n(),a(6,"section",8),g(7,Om,0,0,"ng-template",9)(8,Pm,11,3,"ng-template",10)(9,wm,17,24,"ng-template",11),n()),t&2){let e=v();r(4),p("ngForOf",e.allCredentialsTypes),r(),p("ngIf",e.credentialsConfigFormGroup.get("type").hasError("required")),r(),p("ngSwitch",e.credentialsConfigFormGroup.get("type").value)}}var gi=(()=>{class t extends tt{get required(){return this.requiredValue}set required(e){this.requiredValue=yt(e)}constructor(e,i){super(),this.fb=e,this.destroyRef=i,this.disableCertPemCredentials=!1,this.passwordFieldRequired=!0,this.allCredentialsTypes=ya,this.credentialsTypeTranslationsMap=va,this.propagateChange=o=>{}}ngOnInit(){this.credentialsConfigFormGroup=this.fb.group({type:[null,[u.required]],username:[null,[]],password:[null,[]],caCert:[null,[]],caCertFileName:[null,[]],privateKey:[null,[]],privateKeyFileName:[null,[]],cert:[null,[]],certFileName:[null,[]]}),this.credentialsConfigFormGroup.valueChanges.pipe(ce(this.destroyRef)).subscribe(()=>{this.updateView()}),this.credentialsConfigFormGroup.get("type").valueChanges.pipe(ce(this.destroyRef)).subscribe(()=>{this.credentialsTypeChanged()})}ngOnChanges(e){for(let i of Object.keys(e)){let o=e[i];!o.firstChange&&o.currentValue!==o.previousValue&&o.currentValue&&i==="disableCertPemCredentials"&&this.credentialsConfigFormGroup.get("type").value==="cert.PEM"&&setTimeout(()=>{this.credentialsConfigFormGroup.get("type").patchValue("anonymous",{emitEvent:!0})})}}writeValue(e){F(e)&&(this.credentialsConfigFormGroup.reset(e,{emitEvent:!1}),this.updateValidators())}setDisabledState(e){e?this.credentialsConfigFormGroup.disable({emitEvent:!1}):(this.credentialsConfigFormGroup.enable({emitEvent:!1}),this.updateValidators())}updateView(){let e=this.credentialsConfigFormGroup.value,i=e.type;switch(i){case"anonymous":e={type:i};break;case"basic":e={type:i,username:e.username,password:e.password};break;case"cert.PEM":delete e.username;break}this.propagateChange(e)}registerOnChange(e){this.propagateChange=e}registerOnTouched(){}validate(){return this.credentialsConfigFormGroup.valid?null:{credentialsConfig:{valid:!1}}}credentialsTypeChanged(){this.credentialsConfigFormGroup.patchValue({username:null,password:null,caCert:null,caCertFileName:null,privateKey:null,privateKeyFileName:null,cert:null,certFileName:null}),this.updateValidators()}updateValidators(e=!1){let i=this.credentialsConfigFormGroup.get("type").value;switch(e&&this.credentialsConfigFormGroup.reset({type:i},{emitEvent:!1}),this.credentialsConfigFormGroup.setValidators([]),this.credentialsConfigFormGroup.get("username").setValidators([]),this.credentialsConfigFormGroup.get("password").setValidators([]),i){case"anonymous":break;case"basic":this.credentialsConfigFormGroup.get("username").setValidators([u.required]),this.credentialsConfigFormGroup.get("password").setValidators(this.passwordFieldRequired?[u.required]:[]);break;case"cert.PEM":this.credentialsConfigFormGroup.setValidators([this.requiredFilesSelected(u.required,[["caCert","caCertFileName"],["privateKey","privateKeyFileName","cert","certFileName"]])]);break}this.credentialsConfigFormGroup.get("username").updateValueAndValidity({emitEvent:e}),this.credentialsConfigFormGroup.get("password").updateValueAndValidity({emitEvent:e}),this.credentialsConfigFormGroup.updateValueAndValidity({emitEvent:e})}requiredFilesSelected(e,i=null){return o=>(i||(i=[Object.keys(o.controls)]),o?.controls&&i.some(H=>H.every(Ce=>!e(o.controls[Ce])))?null:{notAllRequiredFilesSelected:!0})}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-credentials-config"]],inputs:{required:"required",disableCertPemCredentials:"disableCertPemCredentials",passwordFieldRequired:"passwordFieldRequired"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:ue(()=>t),multi:!0}]),M,uo],decls:9,vars:4,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"tb-credentials-config-panel-group"],["translate",""],["matExpansionPanelContent",""],[1,"mat-block"],["formControlName","type","required",""],[3,"value","disabled",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"flex","flex-col",3,"ngSwitch"],["ngSwitchCase","anonymous"],["ngSwitchCase","basic"],["ngSwitchCase","cert.PEM"],[3,"value","disabled"],["required","","matInput","","formControlName","username"],["type","password","matInput","","formControlName","password",3,"required"],["matSuffix",""],[1,"tb-hint"],["formControlName","caCert","inputId","caCertSelect","noFileText","rule-node-config.no-file",3,"fileNameChanged","existingFileName","label","dropLabel"],["formControlName","cert","inputId","CertSelect","noFileText","rule-node-config.no-file",3,"fileNameChanged","existingFileName","label","dropLabel"],["formControlName","privateKey","inputId","privateKeySelect","noFileText","rule-node-config.no-file",2,"padding-bottom","8px",3,"fileNameChanged","existingFileName","label","dropLabel"],["type","password","matInput","","formControlName","password"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-expansion-panel",1)(2,"mat-expansion-panel-header")(3,"mat-panel-title",2),l(4,"rule-node-config.credentials"),n(),a(5,"mat-panel-description"),l(6),m(7,"translate"),n()(),g(8,Gm,10,3,"ng-template",3),n()()),i&2&&(p("formGroup",o.credentialsConfigFormGroup),r(6),c(" ",s(7,2,o.credentialsTypeTranslationsMap.get(o.credentialsConfigFormGroup.get("type").value))," "))},dependencies:[z,k,Xi,Zi,R,q,B,Q,oe,ee,W,it,nt,rt,rn,nn,O,S,x,A,_,E,Ii,D,li,I],encapsulation:2})}}return t})();b();function jm(t,d){t&1&&(a(0,"button",22),m(1,"translate"),a(2,"mat-icon"),l(3,"drag_handle"),n()()),t&2&&h("matTooltip",s(1,1,"action.drag"))}function Um(t,d){if(t&1&&(a(0,"span",23),l(1),n()),t&2){let e=v().$implicit;r(),c("",e.get("name").value,".")}}function Km(t,d){if(t&1&&(a(0,"mat-option",24),l(1),m(2,"translate"),a(3,"small",25),l(4),m(5,"translate"),n()()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,3,i.argumentTypeMap.get(e).name)," "),r(3),c(" ",s(5,5,i.argumentTypeMap.get(e).description)," ")}}function Hm(t,d){t&1&&(a(0,"mat-error",13),l(1," rule-node-config.argument-source-field-input-required "),n())}function zm(t,d){t&1&&(a(0,"mat-error",13),l(1," rule-node-config.argument-key-field-input-required "),n())}function Qm(t,d){if(t&1&&(a(0,"mat-form-field",26)(1,"mat-label",13),l(2,"rule-node-config.argument-key-field-input"),n(),f(3,"input",27),a(4,"mat-icon",28),m(5,"translate"),l(6," help "),n(),g(7,zm,2,0,"mat-error",16),n()),t&2){let e=v().$implicit;r(3),p("formControl",e.get("key")),r(),h("matTooltip",s(5,3,"rule-node-config.math-templatization-tooltip")),r(3),p("ngIf",e.get("key").hasError("required"))}}function Jm(t,d){t&1&&(a(0,"mat-error",13),l(1," rule-node-config.constant-value-field-input-required "),n())}function $m(t,d){if(t&1&&(a(0,"mat-form-field",29)(1,"mat-label",13),l(2,"rule-node-config.constant-value-field-input"),n(),f(3,"input",30),g(4,Jm,2,0,"mat-error",16),n()),t&2){let e=v().$implicit;r(3),p("formControl",e.get("key")),r(),p("ngIf",e.get("key").hasError("required"))}}function Ym(t,d){if(t&1&&(a(0,"mat-form-field",26)(1,"mat-label",13),l(2,"rule-node-config.default-value-field-input"),n(),f(3,"input",31),n()),t&2){let e=v().$implicit;r(3),p("formControl",e.get("defaultValue"))}}function Wm(t,d){if(t&1&&(a(0,"mat-option",33),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(3);p("value",e),r(),c(" ",s(2,2,i.attributeScopeMap.get(e))," ")}}function Xm(t,d){t&1&&(a(0,"mat-error",13),l(1," rule-node-config.attribute-scope-field-input-required "),n())}function Zm(t,d){if(t&1&&(a(0,"mat-form-field",12)(1,"mat-label",13),l(2,"rule-node-config.attribute-scope-field-input"),n(),a(3,"mat-select",14),g(4,Wm,3,4,"mat-option",32),n(),g(5,Xm,2,0,"mat-error",16),n()),t&2){let e=v().$implicit,i=v();r(3),p("formControl",e.get("attributeScope")),r(),p("ngForOf",i.attributeScope),r(),p("ngIf",e.get("attributeScope").hasError("required"))}}function es(t,d){if(t&1){let e=pe();a(0,"button",34),m(1,"translate"),$("click",function(){ie(e);let o=v().index,C=v();return ne(C.removeArgument(o))}),a(2,"mat-icon"),l(3,"close"),n()()}t&2&&h("matTooltip",s(1,1,"action.remove"))}function ts(t,d){if(t&1&&(a(0,"mat-list-item",6)(1,"div",7),g(2,jm,4,3,"button",8),a(3,"div",9),g(4,Um,2,1,"span",10),a(5,"div",11)(6,"mat-form-field",12)(7,"mat-label",13),l(8,"rule-node-config.argument-source-field-input"),n(),a(9,"mat-select",14)(10,"mat-select-trigger"),l(11),m(12,"translate"),n(),g(13,Km,6,7,"mat-option",15),n(),g(14,Hm,2,0,"mat-error",16),n(),a(15,"div",17),g(16,Qm,8,5,"mat-form-field",18)(17,$m,5,2,"mat-form-field",19)(18,Ym,4,1,"mat-form-field",18),n(),g(19,Zm,6,3,"mat-form-field",20),n(),g(20,es,4,3,"button",21),n()()()),t&2){let e,i=d.$implicit,o=v();p("cdkDragDisabled",o.disabled),r(2),p("ngIf",!o.disabled),r(2),p("ngIf",o.displayArgumentName),r(5),p("formControl",i.get("type")),r(2),c(" ",s(12,12,(e=o.argumentTypeMap.get(i.get("type").value))==null?null:e.name)," "),r(2),p("ngForOf",o.arguments),r(),p("ngIf",i.get("type").hasError("required")),r(2),p("ngIf",i.get("type").value&&i.get("type").value!==o.ArgumentType.CONSTANT),r(),p("ngIf",i.get("type").value===o.ArgumentType.CONSTANT),r(),p("ngIf",i.get("type").value&&i.get("type").value!==o.ArgumentType.CONSTANT),r(),p("ngIf",i.get("type").value===o.ArgumentType.ATTRIBUTE),r(),p("ngIf",!o.disabled)}}function is(t,d){t&1&&(a(0,"div")(1,"span",35),l(2,"rule-node-config.no-arguments-prompt"),n()())}var zi=(()=>{class t extends tt{get function(){return this.functionValue}set function(e){e&&this.functionValue!==e&&(this.functionValue=e,this.setupArgumentsFormGroup(!0))}constructor(e,i){super(),this.fb=e,this.destroyRef=i,this.maxArgs=16,this.minArgs=1,this.displayArgumentName=!1,this.mathFunctionMap=wi,this.ArgumentType=Nt,this.attributeScopeMap=Tn,this.argumentTypeMap=Fa,this.arguments=Object.values(Nt),this.attributeScope=Object.values(ui),this.propagateChange=null}ngOnInit(){this.argumentsFormGroup=this.fb.group({arguments:this.fb.array([])}),this.argumentsFormGroup.valueChanges.pipe(ce(this.destroyRef)).subscribe(()=>{this.updateModel()}),this.setupArgumentsFormGroup()}onDrop(e){let i=this.argumentsFormArray,o=i.at(e.previousIndex);i.removeAt(e.previousIndex),i.insert(e.currentIndex,o),this.updateArgumentNames()}get argumentsFormArray(){return this.argumentsFormGroup.get("arguments")}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}setDisabledState(e){this.disabled=e,this.disabled?this.argumentsFormGroup.disable({emitEvent:!1}):(this.argumentsFormGroup.enable({emitEvent:!1}),this.argumentsFormArray.controls.forEach(i=>this.updateArgumentControlValidators(i)))}writeValue(e){let i=[];e&&e.forEach((o,C)=>{i.push(this.createArgumentControl(o,C))}),this.argumentsFormGroup.setControl("arguments",this.fb.array(i),{emitEvent:!1}),this.setupArgumentsFormGroup()}removeArgument(e){this.argumentsFormArray.removeAt(e),this.updateArgumentNames()}addArgument(e=!0){let i=this.argumentsFormArray,o=this.createArgumentControl(null,i.length);i.push(o,{emitEvent:e})}validate(){return this.argumentsFormGroup.valid?null:{argumentsRequired:!0}}setupArgumentsFormGroup(e=!1){if(this.function&&(this.maxArgs=this.mathFunctionMap.get(this.function).maxArgs,this.minArgs=this.mathFunctionMap.get(this.function).minArgs,this.displayArgumentName=this.function===K.CUSTOM),this.argumentsFormGroup){for(this.argumentsFormGroup.get("arguments").setValidators([u.minLength(this.minArgs),u.maxLength(this.maxArgs)]);this.argumentsFormArray.length>this.maxArgs;)this.removeArgument(this.maxArgs-1);for(;this.argumentsFormArray.length<this.minArgs;)this.addArgument(e);this.argumentsFormGroup.get("arguments").updateValueAndValidity({emitEvent:!1})}}createArgumentControl(e,i){let o=this.fb.group({type:[e?.type,[u.required]],key:[e?.key,[u.required]],name:[jn[i],[u.required]],attributeScope:[e?.attributeScope??ui.SERVER_SCOPE,[u.required]],defaultValue:[e?.defaultValue?e?.defaultValue:null]});return this.updateArgumentControlValidators(o),o.get("type").valueChanges.pipe(ce(this.destroyRef)).subscribe(()=>{this.updateArgumentControlValidators(o),o.get("attributeScope").updateValueAndValidity({emitEvent:!1}),o.get("defaultValue").updateValueAndValidity({emitEvent:!1})}),o}updateArgumentControlValidators(e){let i=e.get("type").value;i===Nt.ATTRIBUTE?e.get("attributeScope").enable({emitEvent:!1}):e.get("attributeScope").disable({emitEvent:!1}),i&&i!==Nt.CONSTANT?e.get("defaultValue").enable({emitEvent:!1}):e.get("defaultValue").disable({emitEvent:!1})}updateArgumentNames(){this.argumentsFormArray.controls.forEach((e,i)=>{e.get("name").setValue(jn[i])})}updateModel(){let e=this.argumentsFormArray.value;!e.length||!this.argumentsFormGroup.valid?this.propagateChange(null):this.propagateChange(e)}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-arguments-map-config"]],inputs:{disabled:"disabled",function:"function"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:ue(()=>t),multi:!0}]),M],decls:10,vars:10,consts:[[1,"flex","flex-col"],[2,"max-height","500px","overflow","auto"],["cdkDropList","","cdkDropListOrientation","vertical",1,"tb-drop-list","arguments-list",3,"cdkDropListDropped","formGroup","cdkDropListDisabled"],["formArrayName","arguments","cdkDrag","","class","tb-argument tb-draggable","style","height: 100%",3,"cdkDragDisabled",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-button","","mat-raised-button","","color","primary","type","button","matTooltipPosition","above",3,"click","disabled"],["formArrayName","arguments","cdkDrag","",1,"tb-argument","tb-draggable",2,"height","100%",3,"cdkDragDisabled"],[1,"flex","flex-1","flex-row","items-center","justify-start"],["mat-icon-button","","color","primary","cdkDragHandle","","class","tb-drag-handle handle","style","min-width: 40px; margin: 0","matTooltipPosition","above",3,"matTooltip",4,"ngIf"],[1,"flex","flex-1","flex-row","items-center","justify-start","gap-4"],["style","padding: 0 10px; min-width: 20px;",4,"ngIf"],[1,"flex","flex-1","flex-col"],[1,"mat-block"],["translate",""],["required","",3,"formControl"],["style","border-bottom: 1px solid #eee;",3,"value",4,"ngFor","ngForOf"],["translate","",4,"ngIf"],[1,"flex","flex-1","flex-row","xs:flex-col","gt-xs:gap-4"],["floatLabel","always","class","mat-block gt-xs:max-w-50% gt-xs:flex-full",4,"ngIf"],["floatLabel","always","class","mat-block flex-1",4,"ngIf"],["class","mat-block",4,"ngIf"],["mat-icon-button","","color","primary","style","min-width: 40px;","matTooltipPosition","above",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","primary","cdkDragHandle","","matTooltipPosition","above",1,"tb-drag-handle","handle",2,"min-width","40px","margin","0",3,"matTooltip"],[2,"padding","0 10px","min-width","20px"],[2,"border-bottom","1px solid #eee",3,"value"],[2,"display","block","overflow","hidden","text-overflow","ellipsis","white-space","nowrap"],["floatLabel","always",1,"mat-block","gt-xs:max-w-50%","gt-xs:flex-full"],["matInput","","required","",3,"formControl"],["aria-hidden","false","aria-label","help-icon","matSuffix","","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],["floatLabel","always",1,"mat-block","flex-1"],["matInput","","required","","step","1","min","0","type","number",3,"formControl"],["matInput","","step","1","type","number",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-icon-button","","color","primary","matTooltipPosition","above",2,"min-width","40px",3,"click","matTooltip"],["translate","",1,"tb-prompt","flex","items-center","justify-center"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"mat-list",2),$("cdkDropListDropped",function(H){return o.onDrop(H)}),g(3,ts,21,14,"mat-list-item",3),n()(),g(4,is,3,0,"div",4),a(5,"button",5),$("click",function(){return o.addArgument()}),a(6,"mat-icon"),l(7,"add"),n(),l(8),m(9,"translate"),n()()),i&2&&(r(),He("readonly",o.disabled),r(),p("formGroup",o.argumentsFormGroup)("cdkDropListDisabled",o.disabled),r(),p("ngForOf",o.argumentsFormArray.controls),r(),p("ngIf",!o.argumentsFormArray.length),r(),p("disabled",o.argumentsFormArray.length>=o.maxArgs),r(3),c(" ",s(9,8,"action.add")," "))},dependencies:[z,k,we,_e,X,R,q,B,Q,oe,ee,ii,W,Z,Bo,Oo,Qo,zo,Ho,O,fe,S,x,A,ve,ti,_,an,D,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-list-item.tb-argument[_ngcontent-%COMP%]{border:solid rgba(0,0,0,.25) 1px;border-radius:4px;padding:10px 0;margin-bottom:16px}[_nghost-%COMP%]   .arguments-list[_ngcontent-%COMP%]{padding:0}']})}}return t})();b();var rs=["operationInput"];function os(t,d){if(t&1){let e=pe();a(0,"button",9),$("click",function(){ie(e);let o=v();return ne(o.clear())}),a(1,"mat-icon",10),l(2,"close"),n()()}}function as(t,d){if(t&1&&(a(0,"mat-option",11),f(1,"span",12),m(2,"highlight"),a(3,"small",13),l(4),n()()),t&2){let e=d.$implicit,i=v();p("value",e.value),r(),p("innerHTML",ae(2,3,e.value+" | "+e.name,i.searchText),Pe),r(3),c(" ",e.description," ")}}function ls(t,d){t&1&&(a(0,"mat-option",11)(1,"span",3),l(2,"rule-node-config.no-option-found"),n()()),t&2&&p("value",null)}var Qi=(()=>{class t{get required(){return this.requiredValue}set required(e){this.requiredValue=yt(e)}constructor(e,i){this.translate=e,this.fb=i,this.searchText="",this.dirty=!1,this.mathOperation=[...wi.values()],this.propagateChange=null}ngOnInit(){this.mathFunctionForm=this.fb.group({operation:[""]}),this.filteredOptions=this.mathFunctionForm.get("operation").valueChanges.pipe(mo(e=>{let i;typeof e=="string"&&K[e]?i=K[e]:i=null,this.updateView(i)}),Wi(e=>(this.searchText=e||"",e?this._filter(e):this.mathOperation.slice())))}_filter(e){let i=e.toLowerCase();return this.mathOperation.filter(o=>o.name.toLowerCase().includes(i)||o.value.toLowerCase().includes(i))}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}setDisabledState(e){this.disabled=e,this.disabled?this.mathFunctionForm.disable({emitEvent:!1}):this.mathFunctionForm.enable({emitEvent:!1})}mathFunctionDisplayFn(e){if(e){let i=wi.get(e);return i.value+" | "+i.name}return""}writeValue(e){this.modelValue=e,this.mathFunctionForm.get("operation").setValue(e,{emitEvent:!1}),this.dirty=!0}updateView(e){this.modelValue!==e&&(this.modelValue=e,this.propagateChange(this.modelValue))}onFocus(){this.dirty&&(this.mathFunctionForm.get("operation").updateValueAndValidity({onlySelf:!0}),this.dirty=!1)}clear(){this.mathFunctionForm.get("operation").patchValue(""),setTimeout(()=>{this.operationInput.nativeElement.blur(),this.operationInput.nativeElement.focus()},0)}static{this.\u0275fac=function(i){return new(i||t)(y(le),y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-math-function-autocomplete"]],viewQuery:function(i,o){if(i&1&&De(rs,7),i&2){let C;Ve(C=qe())&&(o.operationInput=C.first)}},inputs:{required:"required",disabled:"disabled"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0}])],decls:12,vars:11,consts:[["operationInput",""],["auto","matAutocomplete"],[1,"mat-block",3,"formGroup"],["translate",""],["type","text","matInput","","formControlName","operation",3,"focusin","required","matAutocomplete"],["type","button","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[1,"tb-autocomplete",3,"displayWith"],[3,"value",4,"ngFor","ngForOf"],[3,"value",4,"ngIf"],["type","button","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"material-icons"],[3,"value"],[3,"innerHTML"],[2,"display","block","overflow","hidden","text-overflow","ellipsis","white-space","nowrap"]],template:function(i,o){if(i&1){let C=pe();a(0,"mat-form-field",2)(1,"mat-label",3),l(2,"rule-node-config.functions-field-input"),n(),a(3,"input",4,0),$("focusin",function(){return ie(C),ne(o.onFocus())}),n(),g(5,os,3,0,"button",5),a(6,"mat-autocomplete",6,1),g(8,as,5,6,"mat-option",7),m(9,"async"),g(10,ls,3,1,"mat-option",8),m(11,"async"),n()()}if(i&2){let C,H=Xe(7);p("formGroup",o.mathFunctionForm),r(3),p("required",o.required)("matAutocomplete",H),r(2),p("ngIf",o.mathFunctionForm.get("operation").value),r(),p("displayWith",o.mathFunctionDisplayFn),r(2),p("ngForOf",s(9,7,o.filteredOptions)),r(2),p("ngIf",!((C=s(11,9,o.filteredOptions))!=null&&C.length))}},dependencies:[z,k,_e,X,R,q,B,oe,W,pn,mn,O,S,x,A,_,E,D,Wt,fn],encapsulation:2})}}return t})();b();function ms(t,d){if(t&1&&(a(0,"mat-option",8),l(1),n()),t&2){let e=d.$implicit;p("value",e),r(),c(" ",e.name," ")}}function ss(t,d){if(t&1&&(a(0,"button",9),m(1,"translate"),a(2,"mat-icon",10),l(3,"content_copy "),n()()),t&2){let e=v();h("matTooltip",s(1,2,"rule-node-config.copy-message-type")),p("cbContent",e.messageTypeFormGroup.get("messageType").value)}}function ds(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.message-type-value-required")," "))}function us(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.message-type-value-max-length")," "))}var Ut=class t{set required(d){this.requiredValue!==d&&(this.requiredValue=d,this.updateValidators())}get required(){return this.requiredValue}constructor(d){this.fb=d,this.subscriptSizing="fixed",this.messageTypes=[{name:"Post attributes",value:"POST_ATTRIBUTES_REQUEST"},{name:"Post telemetry",value:"POST_TELEMETRY_REQUEST"},{name:"Custom",value:""}],this.propagateChange=()=>{},this.messageTypeFormGroup=this.fb.group({messageTypeAlias:[null,[u.required]],messageType:[{value:null,disabled:!0},[u.maxLength(255)]]}),this.messageTypeFormGroup.get("messageTypeAlias").valueChanges.pipe(ce()).subscribe(e=>this.updateMessageTypeValue(e)),this.messageTypeFormGroup.valueChanges.pipe(ce()).subscribe(()=>this.updateView())}registerOnTouched(d){}registerOnChange(d){this.propagateChange=d}writeValue(d){this.modelValue=d;let e=this.messageTypes.find(i=>i.value===d);e||(e=this.messageTypes.find(i=>i.value==="")),this.messageTypeFormGroup.get("messageTypeAlias").patchValue(e,{emitEvent:!1}),this.messageTypeFormGroup.get("messageType").patchValue(d,{emitEvent:!1})}validate(){return this.messageTypeFormGroup.valid?null:{messageTypeInvalid:!0}}setDisabledState(d){this.disabled=d,d?this.messageTypeFormGroup.disable({emitEvent:!1}):(this.messageTypeFormGroup.enable({emitEvent:!1}),this.messageTypeFormGroup.get("messageTypeAlias").value?.name!=="Custom"&&this.messageTypeFormGroup.get("messageType").disable({emitEvent:!1}))}updateView(){let d=this.messageTypeFormGroup.getRawValue().messageType;this.modelValue!==d&&(this.modelValue=d,this.propagateChange(this.modelValue))}updateValidators(){this.messageTypeFormGroup.get("messageType").setValidators(this.required?[u.required,u.maxLength(255)]:[u.maxLength(255)]),this.messageTypeFormGroup.get("messageType").updateValueAndValidity({emitEvent:!1})}updateMessageTypeValue(d){d?.name!=="Custom"?this.messageTypeFormGroup.get("messageType").disable({emitEvent:!1}):this.messageTypeFormGroup.get("messageType").enable({emitEvent:!1}),this.messageTypeFormGroup.get("messageType").patchValue(d.value??null)}static{this.\u0275fac=function(e){return new(e||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-output-message-type-autocomplete"]],inputs:{subscriptSizing:"subscriptSizing",disabled:"disabled",required:"required"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:ue(()=>t),multi:!0}])],decls:15,vars:14,consts:[[1,"tb-form-row","no-border","no-padding","tb-standard-fields","column-xs",3,"formGroup"],["hideRequiredMarker","",1,"flex",3,"subscriptSizing"],["formControlName","messageTypeAlias"],[3,"value",4,"ngFor","ngForOf"],[1,"flex",3,"subscriptSizing","hideRequiredMarker"],["matInput","","type","text","formControlName","messageType"],["type","button","matSuffix","","mat-icon-button","","aria-label","Copy","ngxClipboard","",3,"cbContent","matTooltip",4,"ngIf"],[4,"ngIf"],[3,"value"],["type","button","matSuffix","","mat-icon-button","","aria-label","Copy","ngxClipboard","",3,"cbContent","matTooltip"],["aria-hidden","false","aria-label","help-icon"]],template:function(e,i){e&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label"),l(3),m(4,"translate"),n(),a(5,"mat-select",2),g(6,ms,2,2,"mat-option",3),n()(),a(7,"mat-form-field",4)(8,"mat-label"),l(9),m(10,"translate"),n(),f(11,"input",5),g(12,ss,4,4,"button",6)(13,ds,3,3,"mat-error",7)(14,us,3,3,"mat-error",7),n()()),e&2&&(p("formGroup",i.messageTypeFormGroup),r(),h("subscriptSizing",i.subscriptSizing),r(2),V(s(4,10,"rule-node-config.output-message-type")),r(3),p("ngForOf",i.messageTypes),r(),h("subscriptSizing",i.subscriptSizing),p("hideRequiredMarker",i.messageTypeFormGroup.get("messageType").disabled),r(2),V(s(10,12,"rule-node-config.message-type-value")),r(3),p("ngIf",i.messageTypeFormGroup.get("messageType").value),r(),p("ngIf",i.messageTypeFormGroup.get("messageType").hasError("required")),r(),p("ngIf",i.messageTypeFormGroup.get("messageType").hasError("maxlength")))},dependencies:[z,k,_e,X,R,q,B,Q,oe,ee,W,Z,qt,O,S,x,_,E,I],encapsulation:2})}};Ke([at(),je("design:type",Boolean)],Ut.prototype,"disabled",void 0);Ke([at(),je("design:type",Object),je("design:paramtypes",[Object])],Ut.prototype,"required",null);b();var fs=(t,d)=>({keyText:t,valText:d});function gs(t,d){if(t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2){let e=v(2);r(),c(" ",s(2,1,e.keyRequiredText)," ")}}function Cs(t,d){if(t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2){let e=v(2);r(),c(" ",s(2,1,e.valRequiredText)," ")}}function ys(t,d){if(t&1){let e=pe();a(0,"div",10)(1,"mat-form-field",11),f(2,"input",12),m(3,"translate"),g(4,gs,3,3,"mat-error",13),n(),a(5,"mat-form-field",11),f(6,"input",12),m(7,"translate"),g(8,Cs,3,3,"mat-error",13),n(),a(9,"button",14),m(10,"translate"),m(11,"async"),$("click",function(){let o=ie(e).index,C=v();return ne(C.removeKeyVal(o))}),a(12,"mat-icon"),l(13,"close"),n()()()}if(t&2){let e=d.$implicit,i=v();r(2),h("placeholder",s(3,10,i.keyText)),p("formControl",e.get("key")),r(2),p("ngIf",e.get("key").hasError("required")),r(2),h("placeholder",s(7,12,i.valText)),p("formControl",e.get("value")),r(2),p("ngIf",e.get("value").hasError("required")),r(),He("!hidden",i.disabled),h("matTooltip",s(10,14,"rule-node-config.key-val.remove-entry")),p("disabled",s(11,16,i.isLoading$))}}function vs(t,d){if(t&1&&(f(0,"div",15),m(1,"translate"),m(2,"safe")),t&2){let e=v();p("innerHTML",ae(2,3,s(1,1,e.hintText),"html"),Pe)}}var Ft=(()=>{class t extends tt{get required(){return this.requiredValue}set required(e){this.requiredValue=yt(e)}constructor(e,i,o,C){super(),this.translate=e,this.injector=i,this.fb=o,this.destroyRef=C,this.propagateChange=null}ngOnInit(){this.ngControl=this.injector.get(bi),this.ngControl!=null&&(this.ngControl.valueAccessor=this),this.kvListFormGroup=this.fb.group({keyVals:this.fb.array([])}),this.kvListFormGroup.valueChanges.pipe(ce(this.destroyRef)).subscribe(()=>{this.updateModel()})}keyValsFormArray(){return this.kvListFormGroup.get("keyVals")}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}setDisabledState(e){this.disabled=e,this.disabled?this.kvListFormGroup.disable({emitEvent:!1}):this.kvListFormGroup.enable({emitEvent:!1})}writeValue(e){let i=[];if(e)for(let o of Object.keys(e))Object.prototype.hasOwnProperty.call(e,o)&&i.push(this.fb.group({key:[o,[u.required]],value:[e[o],[u.required]]}));this.kvListFormGroup.setControl("keyVals",this.fb.array(i),{emitEvent:!1})}removeKeyVal(e){this.kvListFormGroup.get("keyVals").removeAt(e)}addKeyVal(){this.kvListFormGroup.get("keyVals").push(this.fb.group({key:["",[u.required]],value:["",[u.required]]}))}validate(){let e=this.kvListFormGroup.get("keyVals").value;if(!e.length&&this.required)return{kvMapRequired:!0};if(!this.kvListFormGroup.valid)return{kvFieldsRequired:!0};if(this.uniqueKeyValuePairValidator){for(let i of e)if(i.key===i.value)return{uniqueKeyValuePair:!0}}return null}updateModel(){let e=this.kvListFormGroup.get("keyVals").value;if(this.required&&!e.length||!this.kvListFormGroup.valid)this.propagateChange(null);else{let i={};e.forEach(o=>{i[o.key]=o.value}),this.propagateChange(i)}}static{this.\u0275fac=function(i){return new(i||t)(y(le),y(yi),y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-kv-map-config-old"]],inputs:{disabled:"disabled",uniqueKeyValuePairValidator:"uniqueKeyValuePairValidator",requiredText:"requiredText",keyText:"keyText",keyRequiredText:"keyRequiredText",valText:"valText",valRequiredText:"valRequiredText",hintText:"hintText",required:"required"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:ue(()=>t),multi:!0}]),M],decls:21,vars:26,consts:[[1,"tb-kv-map-config","flex","flex-col",3,"formGroup"],[1,"header","flex","flex-1","flex-row","gap-2"],[1,"cell","tb-required","flex-1"],["innerHTML",co`&nbsp`,2,"width","52px"],[1,"body"],["class","row flex flex-row items-center justify-start gap-2","formArrayName","keyVals",4,"ngFor","ngForOf"],["class","tb-hint",3,"innerHTML",4,"ngIf"],[3,"error"],[2,"margin-top","16px"],["mat-button","","mat-raised-button","","color","primary","type","button","matTooltipPosition","above",3,"click","disabled","matTooltip"],["formArrayName","keyVals",1,"row","flex","flex-row","items-center","justify-start","gap-2"],[1,"cell","mat-block","flex-1"],["matInput","","required","",3,"formControl","placeholder"],[4,"ngIf"],["mat-icon-button","","color","primary","type","button","matTooltipPosition","above",3,"click","disabled","matTooltip"],[1,"tb-hint",3,"innerHTML"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"span",2),l(3),m(4,"translate"),n(),a(5,"span",2),l(6),m(7,"translate"),n(),f(8,"span",3),n(),a(9,"div",4),g(10,ys,14,18,"div",5)(11,vs,3,6,"div",6),n(),f(12,"tb-error",7),a(13,"div",8)(14,"button",9),m(15,"translate"),m(16,"async"),$("click",function(){return o.addKeyVal()}),a(17,"mat-icon"),l(18,"add"),n(),l(19),m(20,"translate"),n()()()),i&2&&(p("formGroup",o.kvListFormGroup),r(3),V(s(4,13,o.keyText)),r(3),V(s(7,15,o.valText)),r(2),He("!hidden",o.disabled),r(2),p("ngForOf",o.keyValsFormArray().controls),r(),p("ngIf",o.hintText),r(),p("error",o.ngControl.hasError("kvMapRequired")||o.ngControl.hasError("uniqueKeyValuePair")?o.ngControl.hasError("kvMapRequired")?o.translate.instant(o.requiredText):o.translate.instant("rule-node-config.key-val.unique-key-value-pair-error",Yt(23,fs,o.translate.instant(o.keyText),o.translate.instant(o.valText))):""),r(2),He("!hidden",o.disabled),h("matTooltip",s(15,17,"rule-node-config.key-val.add-entry")),p("disabled",s(16,19,o.isLoading$)),r(5),c(" ",s(20,21,"action.add")," "))},dependencies:[z,k,Go,we,_e,X,R,q,Q,Z,O,S,x,A,ti,_,an,Wt,pt,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .tb-kv-map-config[_ngcontent-%COMP%]{margin-bottom:16px}[_nghost-%COMP%]   .tb-kv-map-config[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px;padding-bottom:5px}[_nghost-%COMP%]   .tb-kv-map-config[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px;color:#757575;font-size:12px;font-weight:700;white-space:nowrap}[_nghost-%COMP%]   .tb-kv-map-config[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .tb-required[_ngcontent-%COMP%]:after{color:#757575;font-size:12px;font-weight:700}[_nghost-%COMP%]   .tb-kv-map-config[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px;padding-bottom:0;max-height:300px;overflow:auto}[_nghost-%COMP%]   .tb-kv-map-config[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   .cell[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}[_nghost-%COMP%]   .tb-kv-map-config[_ngcontent-%COMP%]   tb-error[_ngcontent-%COMP%]{display:block;margin-top:-12px}']})}}return t})();b();function hs(t,d){if(t&1&&(a(0,"mat-chip-option",4),l(1),n()),t&2){let e=d.$implicit,i=v();h("selectable",i.chipControlGroup.get("chipControl").value!==e.value),p("value",e.value),r(),V(e.name)}}var Le=(()=>{class t{constructor(e,i,o){this.fb=e,this.translate=i,this.destroyRef=o,this.translation=bn,this.propagateChange=()=>{},this.selectOptions=[]}ngOnInit(){this.initOptions(),this.chipControlGroup=this.fb.group({chipControl:[null,[]]}),this.chipControlGroup.get("chipControl").valueChanges.pipe(ce(this.destroyRef)).subscribe(e=>{e&&this.propagateChange(e)})}initOptions(){for(let e of this.translation.keys())this.selectOptions.push({value:e,name:this.translate.instant(this.translation.get(e))})}writeValue(e){this.chipControlGroup.get("chipControl").patchValue(e,{emitEvent:!1})}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}setDisabledState(e){e?this.chipControlGroup.disable({emitEvent:!1}):this.chipControlGroup.enable({emitEvent:!1})}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(le),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-msg-metadata-chip"]],inputs:{labelText:"labelText",translation:"translation"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0}])],decls:5,vars:3,consts:[[1,"tb-form-row","space-between",3,"formGroup"],[1,"fixed-title-width"],["formControlName","chipControl"],["color","primary",3,"selectable","value",4,"ngFor","ngForOf"],["color","primary",3,"selectable","value"]],template:function(i,o){i&1&&(a(0,"div",0)(1,"div",1),l(2),n(),a(3,"mat-chip-listbox",2),g(4,hs,2,3,"mat-chip-option",3),n()()),i&2&&(p("formGroup",o.chipControlGroup),r(2),V(o.labelText),r(2),p("ngForOf",o.selectOptions))},dependencies:[z,dn,sn,S,x,_,E],encapsulation:2})}}return t})();b();function bs(t,d){t&1&&(a(0,"div",13),l(1," rule-node-config.map-fields-required "),n())}function Ts(t,d){if(t&1&&(a(0,"div",13),l(1),n()),t&2){let e=v();r(),c(" ",e.requiredText," ")}}function xs(t,d){if(t&1&&(a(0,"mat-option",21),l(1),n()),t&2){let e=d.$implicit;p("value",e.value),r(),c(" ",e.name," ")}}function _s(t,d){if(t&1){let e=pe();a(0,"div",14)(1,"mat-form-field",15)(2,"mat-select",16),g(3,xs,2,2,"mat-option",17),n()(),a(4,"mat-form-field",15),f(5,"input",18),n(),a(6,"div",19)(7,"button",20),m(8,"translate"),m(9,"async"),$("click",function(){let o=ie(e).index,C=v();return ne(C.removeKeyVal(o))}),a(10,"mat-icon"),l(11,"delete"),n()()()()}if(t&2){let e=d.$implicit,i=v();r(2),p("placeholder",i.selectText)("formControl",e.get("key")),r(),p("ngForOf",i.filterSelectOptions(e)),r(2),p("placeholder",i.valText)("formControl",e.get("value")),r(2),He("tb-hidden",i.keyValsFormArray().controls.length===1),h("matTooltip",s(8,9,"rule-node-config.key-val.remove-mapping-entry")),p("disabled",s(9,11,i.isLoading$))}}var At=class t extends tt{constructor(d,e,i,o){super(),this.translate=d,this.injector=e,this.fb=i,this.destroyRef=o,this.propagateChange=null,this.disabled=!1,this.required=!1,this.oneMapRequiredValidator=C=>C.get("keyVals").value.length,this.propagateNestedErrors=C=>{if(this.svListFormGroup&&this.svListFormGroup.get("keyVals")&&this.svListFormGroup.get("keyVals")?.status==="VALID")return null;let H={};if(this.svListFormGroup&&this.svListFormGroup.setErrors(null),C instanceof ln||C instanceof on){if(C.errors)for(let Ce of Object.keys(C.errors))H[Ce]=!0;for(let Ce of Object.keys(C.controls)){let si=this.propagateNestedErrors(C.controls[Ce]);if(si&&Object.keys(si).length)for(let Qa of Object.keys(si))H[Qa]=!0}return H}else if(C.errors)for(let Ce of Object.keys(C.errors))H[Ce]=!0;return en(H,{})?null:H}}ngOnInit(){this.ngControl=this.injector.get(bi),this.ngControl!=null&&(this.ngControl.valueAccessor=this),this.svListFormGroup=this.fb.group({keyVals:this.fb.array([])},{validators:[this.propagateNestedErrors,this.oneMapRequiredValidator]}),this.svListFormGroup.valueChanges.pipe(ce(this.destroyRef)).subscribe(()=>{this.updateModel()})}keyValsFormArray(){return this.svListFormGroup.get("keyVals")}registerOnChange(d){this.propagateChange=d}registerOnTouched(d){}setDisabledState(d){this.disabled=d,this.disabled?this.svListFormGroup.disable({emitEvent:!1}):this.svListFormGroup.enable({emitEvent:!1})}writeValue(d){let e=Object.keys(d).map(i=>({key:i,value:d[i]}));if(this.keyValsFormArray().length===e.length)this.keyValsFormArray().patchValue(e,{emitEvent:!1});else{let i=[];e.forEach(o=>{i.push(this.fb.group({key:[o.key,[u.required]],value:[o.value,[u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)]]}))}),this.svListFormGroup.setControl("keyVals",this.fb.array(i,this.propagateNestedErrors),{emitEvent:!1});for(let o of this.keyValsFormArray().controls)this.keyChangeSubscribe(o)}}filterSelectOptions(d){let e=[];for(let o of this.svListFormGroup.get("keyVals").value){let C=this.selectOptions.find(H=>H.value===o.key);C&&e.push(C)}let i=[];for(let o of this.selectOptions)(!F(e.find(C=>C.value===o.value))||o.value===d?.get("key").value)&&i.push(o);return i}removeKeyVal(d){this.keyValsFormArray().removeAt(d)}addKeyVal(){this.keyValsFormArray().push(this.fb.group({key:["",[u.required]],value:["",[u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)]]})),this.keyChangeSubscribe(this.keyValsFormArray().at(this.keyValsFormArray().length-1))}keyChangeSubscribe(d){d.get("key").valueChanges.pipe(ce(this.destroyRef)).subscribe(e=>{let i=da.get(e);d.get("value").patchValue(this.targetKeyPrefix+i[0].toUpperCase()+i.slice(1))})}validate(){return!this.svListFormGroup.get("keyVals").value.length&&this.required?{svMapRequired:!0}:this.svListFormGroup.valid?null:{svFieldsRequired:!0}}updateModel(){let d=this.svListFormGroup.get("keyVals").value;if(this.required&&!d.length||!this.svListFormGroup.valid)this.propagateChange(null);else{let e={};d.forEach(i=>{e[i.key]=i.value}),this.propagateChange(e)}}static{this.\u0275fac=function(e){return new(e||t)(y(le),y(yi),y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-sv-map-config"]],inputs:{selectOptions:"selectOptions",disabled:"disabled",labelText:"labelText",requiredText:"requiredText",targetKeyPrefix:"targetKeyPrefix",selectText:"selectText",selectRequiredText:"selectRequiredText",valText:"valText",valRequiredText:"valRequiredText",hintText:"hintText",popupHelpLink:"popupHelpLink",required:"required"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:ue(()=>t),multi:!0}]),M],decls:22,vars:15,consts:[[1,"tb-form-panel","stroked",3,"formGroup"],[1,"tb-form-row","no-padding","no-border","space-between"],[1,"tb-form-panel-title"],["class","tb-form-panel-hint tb-error","translate","",4,"ngIf"],[1,"tb-form-panel","no-border","no-padding"],[1,"tb-form-table"],[1,"tb-form-table-header"],[1,"tb-form-table-header-cell","field-space"],[1,"tb-form-table-header-cell","actions-header"],[1,"tb-form-table-body"],["class","tb-form-table-row",4,"ngFor","ngForOf"],["type","button","mat-stroked-button","","color","primary",3,"click","disabled"],[3,"hintText","popupHelpLink"],["translate","",1,"tb-form-panel-hint","tb-error"],[1,"tb-form-table-row"],["appearance","outline","subscriptSizing","dynamic",1,"tb-inline-field","field-space"],["required","",3,"placeholder","formControl"],[3,"value",4,"ngFor","ngForOf"],["matInput","",3,"placeholder","formControl"],[1,"tb-form-table-row-cell-buttons"],["type","button","mat-icon-button","","matTooltipPosition","above",3,"click","disabled","matTooltip"],[3,"value"]],template:function(e,i){e&1&&(a(0,"section",0)(1,"div",1)(2,"div",2),l(3),n(),g(4,bs,2,0,"div",3)(5,Ts,2,1,"div",3),n(),a(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),l(10),n(),a(11,"div",7),l(12),n(),f(13,"div",8),n(),a(14,"div",9),g(15,_s,12,13,"div",10),n()()(),a(16,"div")(17,"button",11),m(18,"async"),$("click",function(){return i.addKeyVal()}),l(19),m(20,"translate"),n()(),f(21,"tb-example-hint",12),n()),e&2&&(p("formGroup",i.svListFormGroup),r(3),V(i.labelText),r(),p("ngIf",i.svListFormGroup.hasError("required")),r(),p("ngIf",i.svListFormGroup.hasError("svMapRequired")),r(5),V(i.selectText),r(2),V(i.valText),r(3),p("ngForOf",i.keyValsFormArray().controls),r(2),p("disabled",s(18,11,i.isLoading$)||i.keyValsFormArray().length>=i.selectOptions.length),r(2),c(" ",s(20,13,"rule-node-config.key-val.add-mapping-entry")," "),r(2),p("hintText",i.hintText)("popupHelpLink",i.popupHelpLink))},dependencies:[z,k,we,_e,X,R,q,ee,W,Z,O,S,x,A,ti,_,D,Te,Wt,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .field-space[_ngcontent-%COMP%]{flex:1 1 50%}[_nghost-%COMP%]   .actions-header[_ngcontent-%COMP%]{width:40px}']})}};Ke([at(),je("design:type",Object)],At.prototype,"disabled",void 0);Ke([at(),je("design:type",Object)],At.prototype,"required",void 0);b();function Ss(t,d){if(t&1&&(a(0,"mat-option",11),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.directionTypeTranslations.get(e))," ")}}var sr=(()=>{class t extends tt{get required(){return this.requiredValue}set required(e){this.requiredValue=yt(e)}constructor(e,i){super(),this.fb=e,this.destroyRef=i,this.directionTypes=Object.keys(mt),this.directionTypeTranslations=oi,this.propagateChange=null}ngOnInit(){this.relationsQueryFormGroup=this.fb.group({fetchLastLevelOnly:[!1,[]],direction:[null,[u.required]],maxLevel:[null,[]],filters:[null]}),this.relationsQueryFormGroup.valueChanges.pipe(ce(this.destroyRef)).subscribe(e=>{this.relationsQueryFormGroup.valid?this.propagateChange(e):this.propagateChange(null)})}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}setDisabledState(e){this.disabled=e,this.disabled?this.relationsQueryFormGroup.disable({emitEvent:!1}):this.relationsQueryFormGroup.enable({emitEvent:!1})}writeValue(e){this.relationsQueryFormGroup.reset(e||{},{emitEvent:!1})}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-relations-query-config-old"]],inputs:{disabled:"disabled",required:"required"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0}]),M],decls:18,vars:8,consts:[[1,"flex","flex-col",3,"formGroup"],["formControlName","fetchLastLevelOnly"],[1,"flex","flex-row","gap-2"],[1,"mat-block",2,"min-width","100px"],["translate",""],["required","","matInput","","formControlName","direction"],[3,"value",4,"ngFor","ngForOf"],["floatLabel","always",1,"mat-block","flex-1"],["matInput","","type","number","min","1","step","1","formControlName","maxLevel",3,"placeholder"],["translate","",1,"mat-caption",2,"color","#6e6e6e"],["formControlName","filters"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-checkbox",1),l(2),m(3,"translate"),n(),a(4,"div",2)(5,"mat-form-field",3)(6,"mat-label",4),l(7,"relation.direction"),n(),a(8,"mat-select",5),g(9,Ss,3,4,"mat-option",6),n()(),a(10,"mat-form-field",7)(11,"mat-label",4),l(12,"rule-node-config.max-relation-level"),n(),f(13,"input",8),m(14,"translate"),n()(),a(15,"div",9),l(16,"relation.relation-filters"),n(),f(17,"tb-relation-filters",10),n()),i&2&&(p("formGroup",o.relationsQueryFormGroup),r(2),c(" ",s(3,4,"alias.last-level-relation")," "),r(7),p("ngForOf",o.directionTypes),r(4),h("placeholder",s(14,6,"rule-node-config.unlimited-level")))},dependencies:[z,Ge,R,q,B,ee,W,O,fe,S,x,A,ve,_,E,D,yn,I],encapsulation:2})}}return t})();b();var Fs=t=>({latestTsKeyName:t}),Is=t=>({inputName:t});function Es(t,d){t&1&&ki(0,9)}function Ms(t,d){t&1&&ki(0,9)}function Ns(t,d){t&1&&ki(0,9)}function As(t,d){t&1&&ki(0,9)}function Ds(t,d){if(t&1&&(a(0,"div",10),m(1,"translate"),a(2,"mat-slide-toggle",11),l(3),m(4,"translate"),n()()),t&2){let e=v();h("tb-hint-tooltip-icon",ae(1,2,"rule-node-config.fetch-latest-telemetry-with-timestamp-tooltip",Fe(7,Fs,e.attributeControlGroup.get("latestTsKeyNames").value[0]))),r(3),c(" ",s(4,5,"rule-node-config.fetch-latest-telemetry-with-timestamp")," ")}}function Vs(t,d){t&1&&(a(0,"mat-icon",12),m(1,"translate"),m(2,"translate"),l(3,"help"),n()),t&2&&h("matTooltip",ae(2,3,"rule-node-config.chip-help",Fe(6,Is,s(1,1,"rule-node-config.field-name"))))}var Ci=(()=>{class t{constructor(e,i,o){this.translate=e,this.fb=i,this.destroyRef=o,this.propagateChange=C=>{},this.separatorKeysCodes=[13,188,186],this.onTouched=()=>{}}ngOnInit(){this.attributeControlGroup=this.fb.group({clientAttributeNames:[[],[]],sharedAttributeNames:[[],[]],serverAttributeNames:[[],[]],latestTsKeyNames:[[],[]],getLatestValueWithTs:[!1,[]]},{validators:this.atLeastOne(u.required,["clientAttributeNames","sharedAttributeNames","serverAttributeNames","latestTsKeyNames"])}),this.attributeControlGroup.valueChanges.pipe(ce(this.destroyRef)).subscribe(e=>{this.propagateChange(this.preparePropagateValue(e))})}preparePropagateValue(e){let i={};for(let o in e)o==="getLatestValueWithTs"?i[o]=e[o]:i[o]=F(e[o])?e[o]:[];return i}validate(){return this.attributeControlGroup.valid?null:{atLeastOneRequired:!0}}atLeastOne(e,i=null){return o=>(i||(i=Object.keys(o.controls)),o?.controls&&i.some(H=>!e(o.controls[H]))?null:{atLeastOne:!0})}writeValue(e){this.attributeControlGroup.setValue(e,{emitEvent:!1})}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){e?this.attributeControlGroup.disable({emitEvent:!1}):this.attributeControlGroup.enable({emitEvent:!1})}static{this.\u0275fac=function(i){return new(i||t)(y(le),y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-select-attributes"]],inputs:{popupHelpLink:"popupHelpLink"},features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0},{provide:ze,useExisting:t,multi:!0}])],decls:21,vars:32,consts:[["helpIcon",""],[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],[3,"hintText","popupHelpLink"],["subscriptSizing","dynamic","editable","","formControlName","clientAttributeNames",1,"mat-block",3,"focusout","placeholder","label"],["matSuffix","",4,"ngTemplateOutlet"],["subscriptSizing","dynamic","editable","","formControlName","sharedAttributeNames",1,"mat-block",3,"focusout","placeholder","label"],["subscriptSizing","dynamic","editable","","formControlName","serverAttributeNames",1,"mat-block",3,"focusout","placeholder","label"],["subscriptSizing","dynamic","editable","","formControlName","latestTsKeyNames",1,"mat-block",3,"focusout","placeholder","label"],["class","tb-form-row no-border no-padding",3,"tb-hint-tooltip-icon",4,"ngIf"],["matSuffix",""],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","getLatestValueWithTs",1,"mat-slide"],["aria-hidden","false","aria-label","help-icon","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"]],template:function(i,o){if(i&1){let C=pe();a(0,"div",1),f(1,"tb-example-hint",2),a(2,"tb-string-items-list",3),m(3,"translate"),m(4,"translate"),$("focusout",function(){return ie(C),ne(o.onTouched())}),g(5,Es,1,0,"ng-container",4),n(),a(6,"tb-string-items-list",5),m(7,"translate"),m(8,"translate"),$("focusout",function(){return ie(C),ne(o.onTouched())}),g(9,Ms,1,0,"ng-container",4),n(),a(10,"tb-string-items-list",6),m(11,"translate"),m(12,"translate"),$("focusout",function(){return ie(C),ne(o.onTouched())}),g(13,Ns,1,0,"ng-container",4),n(),a(14,"tb-string-items-list",7),m(15,"translate"),m(16,"translate"),$("focusout",function(){return ie(C),ne(o.onTouched())}),g(17,As,1,0,"ng-container",4),n(),g(18,Ds,5,9,"div",8),n(),g(19,Vs,4,8,"ng-template",null,0,Rt)}if(i&2){let C,H=Xe(20);p("formGroup",o.attributeControlGroup),r(),p("hintText","rule-node-config.kv-map-pattern-hint")("popupHelpLink",o.popupHelpLink),r(),p("placeholder",s(3,16,"rule-node-config.add-attribute-key"))("label",s(4,18,"rule-node-config.client-attributes")),r(3),p("ngTemplateOutlet",H),r(),p("placeholder",s(7,20,"rule-node-config.add-attribute-key"))("label",s(8,22,"rule-node-config.shared-attributes")),r(3),p("ngTemplateOutlet",H),r(),p("placeholder",s(11,24,"rule-node-config.add-attribute-key"))("label",s(12,26,"rule-node-config.server-attributes")),r(3),p("ngTemplateOutlet",H),r(),p("placeholder",s(15,28,"rule-node-config.add-telemetry-key"))("label",s(16,30,"rule-node-config.latest-telemetry")),r(3),p("ngTemplateOutlet",H),r(),p("ngIf",((C=o.attributeControlGroup.get("latestTsKeyNames").value)==null?null:C.length)>0)}},dependencies:[k,To,It,X,oe,Z,de,S,x,_,E,ge,Te,I],encapsulation:2})}}return t})();b();var Yi=(()=>{class t extends tt{constructor(e,i){super(),this.fb=e,this.destroyRef=i,this.propagateChange=null,this.alarmStatus=So,this.alarmStatusTranslations=Io}ngOnInit(){this.alarmStatusGroup=this.fb.group({alarmStatus:[null,[]]}),this.alarmStatusGroup.get("alarmStatus").valueChanges.pipe(ce(this.destroyRef)).subscribe(e=>{this.propagateChange(e)})}setDisabledState(e){e?this.alarmStatusGroup.disable({emitEvent:!1}):this.alarmStatusGroup.enable({emitEvent:!1})}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){}writeValue(e){this.alarmStatusGroup.get("alarmStatus").patchValue(e,{emitEvent:!1})}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(Oe))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-alarm-status-select"]],features:[xe([{provide:Se,useExisting:ue(()=>t),multi:!0}]),M],decls:16,vars:17,consts:[[1,"flex","flex-col","items-center","justify-center",3,"formGroup"],["multiple","","formControlName","alarmStatus",1,"chip-listbox","flex","flex-col"],[1,"toggle-column"],[1,"option","flex-1",3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-chip-listbox",1)(2,"div",2)(3,"mat-chip-option",3),l(4),m(5,"translate"),n(),a(6,"mat-chip-option",3),l(7),m(8,"translate"),n()(),a(9,"div",2)(10,"mat-chip-option",3),l(11),m(12,"translate"),n(),a(13,"mat-chip-option",3),l(14),m(15,"translate"),n()()()()),i&2&&(p("formGroup",o.alarmStatusGroup),r(3),p("value",o.alarmStatus.ACTIVE_UNACK),r(),c(" ",s(5,9,o.alarmStatusTranslations.get(o.alarmStatus.ACTIVE_UNACK))," "),r(2),p("value",o.alarmStatus.ACTIVE_ACK),r(),c(" ",s(8,11,o.alarmStatusTranslations.get(o.alarmStatus.ACTIVE_ACK))," "),r(3),p("value",o.alarmStatus.CLEARED_UNACK),r(),c(" ",s(12,13,o.alarmStatusTranslations.get(o.alarmStatus.CLEARED_UNACK))," "),r(2),p("value",o.alarmStatus.CLEARED_ACK),r(),c(" ",s(15,15,o.alarmStatusTranslations.get(o.alarmStatus.CLEARED_ACK))," "))},dependencies:[dn,sn,S,x,_,E,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .chip-listbox[_ngcontent-%COMP%]{max-width:460px;width:100%}[_nghost-%COMP%]   .chip-listbox[_ngcontent-%COMP%]   .toggle-column[_ngcontent-%COMP%]{display:flex;flex:1 1 100%;gap:8px}[_nghost-%COMP%]   .chip-listbox[_ngcontent-%COMP%]   .option[_ngcontent-%COMP%]{margin:0}@media screen and (max-width: 959px){[_nghost-%COMP%]   .chip-listbox[_ngcontent-%COMP%]{max-width:360px}[_nghost-%COMP%]   .chip-listbox[_ngcontent-%COMP%]   .toggle-column[_ngcontent-%COMP%]{flex-direction:column}}[_nghost-%COMP%]     .chip-listbox .mdc-evolution-chip-set__chips{gap:8px}[_nghost-%COMP%]     .chip-listbox .option button{flex-basis:100%;justify-content:start}[_nghost-%COMP%]     .chip-listbox .option .mdc-evolution-chip__graphic{flex-grow:0}']})}}return t})();var ft=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=We({type:t})}static{this.\u0275inj=Ye({imports:[ke,Be,Mt]})}}return t})();(function(){Ze(ft,{declarations:[lt,Ki,fi,Hi,gi,zi,Qi,Ut,Ft,Le,At,sr,Ci,Yi,Te,Tt],imports:[ke,Be,Mt],exports:[lt,Ki,fi,Hi,gi,zi,Qi,Ut,Ft,Le,At,sr,Ci,Yi,Te,Tt]})})();b();function ks(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.customer-name-pattern-required")," "))}function Bs(t,d){if(t&1&&(a(0,"mat-form-field",6)(1,"mat-label",7),l(2,"rule-node-config.customer-name-pattern"),n(),f(3,"input",8),g(4,ks,3,3,"mat-error",9),a(5,"mat-hint",7),l(6,"rule-node-config.customer-name-pattern-hint"),n()()),t&2){let e=v();r(4),p("ngIf",e.unassignCustomerConfigForm.get("customerNamePattern").hasError("required")||e.unassignCustomerConfigForm.get("customerNamePattern").hasError("pattern"))}}var dr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.unassignCustomerConfigForm}prepareInputConfig(e){return{customerNamePattern:F(e?.customerNamePattern)?e.customerNamePattern:null,unassignFromCustomer:F(e?.customerNamePattern)}}onConfigurationSet(e){this.unassignCustomerConfigForm=this.fb.group({customerNamePattern:[e.customerNamePattern,[]],unassignFromCustomer:[e.unassignFromCustomer,[]]})}validatorTriggers(){return["unassignFromCustomer"]}updateValidators(e){this.unassignCustomerConfigForm.get("unassignFromCustomer").value?this.unassignCustomerConfigForm.get("customerNamePattern").setValidators([u.required,u.pattern(/.*\S.*/)]):this.unassignCustomerConfigForm.get("customerNamePattern").setValidators([]),this.unassignCustomerConfigForm.get("customerNamePattern").updateValueAndValidity({emitEvent:e})}prepareOutputConfig(e){return{customerNamePattern:e.unassignFromCustomer?e.customerNamePattern.trim():null}}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-un-assign-to-customer-config"]],features:[M],decls:9,vars:10,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"tb-form-panel","no-padding","no-border"],[1,"tb-form-panel","stroked"],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","unassignFromCustomer",1,"mat-slide"],["class","mat-block","subscriptSizing","dynamic",4,"ngIf"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","customerNamePattern"],[4,"ngIf"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),m(4,"translate"),a(5,"mat-slide-toggle",4),l(6),m(7,"translate"),n()(),g(8,Bs,7,1,"mat-form-field",5),n()()()),i&2&&(p("formGroup",o.unassignCustomerConfigForm),r(2),He("no-padding-bottom",o.unassignCustomerConfigForm.get("unassignFromCustomer").value),r(),h("tb-hint-tooltip-icon",s(4,6,"rule-node-config.unassign-from-customer-tooltip")),r(3),c(" ",s(7,8,"rule-node-config.unassign-from-customer")," "),r(2),p("ngIf",o.unassignCustomerConfigForm.get("unassignFromCustomer").value))},dependencies:[k,R,q,B,se,Q,de,O,S,x,A,_,E,D,ge,I],encapsulation:2})}}return t})();b();var ur=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.deviceProfile}onConfigurationSet(e){this.deviceProfile=this.fb.group({persistAlarmRulesState:[e?e.persistAlarmRulesState:!1],fetchAlarmRulesStateOnStart:[e?e.fetchAlarmRulesStateOnStart:!1]})}validatorTriggers(){return["persistAlarmRulesState"]}updateValidators(e){this.deviceProfile.get("persistAlarmRulesState").value?this.deviceProfile.get("fetchAlarmRulesStateOnStart").enable({emitEvent:!1}):(this.deviceProfile.get("fetchAlarmRulesStateOnStart").setValue(!1,{emitEvent:!1}),this.deviceProfile.get("fetchAlarmRulesStateOnStart").disable({emitEvent:!1})),this.deviceProfile.get("fetchAlarmRulesStateOnStart").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-device-profile-config"]],features:[M],decls:13,vars:13,consts:[[1,"tb-form-panel","stroked",3,"formGroup"],["translate","",1,"tb-form-hint","tb-primary-fill"],[1,"tb-form-row","no-border","no-padding","slide-toggle",3,"tb-hint-tooltip-icon"],["formControlName","persistAlarmRulesState",1,"mat-slide"],["formControlName","fetchAlarmRulesStateOnStart",1,"mat-slide"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),l(2,"rule-node-config.device-profile-node-hint"),n(),a(3,"div",2),m(4,"translate"),a(5,"mat-slide-toggle",3),l(6),m(7,"translate"),n()(),a(8,"div",2),m(9,"translate"),a(10,"mat-slide-toggle",4),l(11),m(12,"translate"),n()()()),i&2&&(p("formGroup",o.deviceProfile),r(3),h("tb-hint-tooltip-icon",s(4,5,"rule-node-config.persist-alarm-rules-hint")),r(3),c(" ",s(7,7,"rule-node-config.persist-alarm-rules")," "),r(2),h("tb-hint-tooltip-icon",s(9,9,"rule-node-config.fetch-alarm-rules-hint")),r(3),c(" ",s(12,11,"rule-node-config.fetch-alarm-rules")," "))},dependencies:[de,S,x,_,E,D,ge,I],encapsulation:2})}}return t})();b();var Os=()=>({standalone:!0});function Rs(t,d){if(t&1&&(a(0,"mat-option",10),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.telemetryTypeTranslationsMap.get(e))," ")}}var cr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.attributeScopes=Object.keys(xt),this.telemetryTypeTranslationsMap=Xt}configForm(){return this.pushToEdgeConfigForm}onConfigurationSet(e){this.pushToEdgeConfigForm=this.fb.group({scope:[e?e.scope:null,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-push-to-edge-config"]],features:[M],decls:19,vars:16,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],[1,"tb-form-panel","stroked"],[3,"hintText"],[1,"tb-form-row","no-border","no-padding","tb-standard-fields"],[1,"flex"],["required","","matInput","","formControlName","scope",1,"tb-entity-type-select"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","readonly","","disabled","",3,"ngModel","ngModelOptions"],["type","button","matSuffix","","mat-icon-button","","aria-label","Copy","ngxClipboard","",3,"cbContent","matTooltip"],["aria-hidden","false","aria-label","help-icon"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),f(2,"tb-example-hint",2),a(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),l(6),m(7,"translate"),n(),a(8,"mat-select",5),g(9,Rs,3,4,"mat-option",6),n()(),a(10,"mat-form-field",4)(11,"mat-label"),l(12),m(13,"translate"),n(),f(14,"input",7),a(15,"button",8),m(16,"translate"),a(17,"mat-icon",9),l(18,"content_copy "),n()()()()()()),i&2&&(p("formGroup",o.pushToEdgeConfigForm),r(2),p("hintText","rule-node-config.attributes-scope-hint"),r(4),V(s(7,9,"rule-node-config.attributes-scope")),r(3),p("ngForOf",o.attributeScopes),r(3),V(s(13,11,"rule-node-config.attributes-scope-value")),r(2),p("ngModel",o.pushToEdgeConfigForm.get("scope").value)("ngModelOptions",he(15,Os)),r(),h("matTooltip",s(16,13,"rule-node-config.attributes-scope-value-copy")),p("cbContent",o.pushToEdgeConfigForm.get("scope").value))},dependencies:[z,_e,X,R,q,B,oe,ee,W,Z,qt,O,S,x,A,ei,_,E,Te,I],encapsulation:2})}}return t})();b();var Ls=()=>({standalone:!0});function Ps(t,d){if(t&1&&(a(0,"mat-option",10),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.telemetryTypeTranslationsMap.get(e))," ")}}var fr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.attributeScopes=Object.keys(xt),this.telemetryTypeTranslationsMap=Xt}configForm(){return this.pushToCloudConfigForm}onConfigurationSet(e){this.pushToCloudConfigForm=this.fb.group({scope:[e?e.scope:null,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-push-to-cloud-config"]],features:[M],decls:19,vars:16,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],[1,"tb-form-panel","stroked"],[3,"hintText"],[1,"tb-form-row","no-border","no-padding","tb-standard-fields"],[1,"flex"],["required","","matInput","","formControlName","scope",1,"tb-entity-type-select"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","readonly","","disabled","",3,"ngModel","ngModelOptions"],["type","button","matSuffix","","mat-icon-button","","aria-label","Copy","ngxClipboard","",3,"cbContent","matTooltip"],["aria-hidden","false","aria-label","help-icon"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),f(2,"tb-example-hint",2),a(3,"div",3)(4,"mat-form-field",4)(5,"mat-label"),l(6),m(7,"translate"),n(),a(8,"mat-select",5),g(9,Ps,3,4,"mat-option",6),n()(),a(10,"mat-form-field",4)(11,"mat-label"),l(12),m(13,"translate"),n(),f(14,"input",7),a(15,"button",8),m(16,"translate"),a(17,"mat-icon",9),l(18,"content_copy "),n()()()()()()),i&2&&(p("formGroup",o.pushToCloudConfigForm),r(2),p("hintText","rule-node-config.attributes-scope-hint"),r(4),V(s(7,9,"rule-node-config.attributes-scope")),r(3),p("ngForOf",o.attributeScopes),r(3),V(s(13,11,"rule-node-config.attributes-scope-value")),r(2),p("ngModel",o.pushToCloudConfigForm.get("scope").value)("ngModelOptions",he(15,Ls)),r(),h("matTooltip",s(16,13,"rule-node-config.attributes-scope-value-copy")),p("cbContent",o.pushToCloudConfigForm.get("scope").value))},dependencies:[z,_e,X,R,q,B,oe,ee,W,Z,qt,O,S,x,A,ei,_,E,Te,I],encapsulation:2})}}return t})();b();var ws=["attributeChipList"],Gs=()=>({standalone:!0});function js(t,d){if(t&1&&(a(0,"mat-option",21),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.telemetryTypeTranslationsMap.get(e))," ")}}function Us(t,d){if(t&1){let e=pe();a(0,"mat-chip-row",22),$("removed",function(){let o=ie(e).$implicit,C=v();return ne(C.removeKey(o))}),l(1),a(2,"mat-icon",23),l(3,"close"),n()()}if(t&2){let e=d.$implicit;r(),c(" ",e," ")}}function Ks(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),V(s(2,1,"rule-node-config.attributes-keys-required")))}function Hs(t,d){t&1&&(a(0,"div",18),m(1,"translate"),a(2,"mat-slide-toggle",24),l(3),m(4,"translate"),n()()),t&2&&(h("tb-hint-tooltip-icon",s(1,2,"rule-node-config.notify-device-on-delete-hint")),r(3),c(" ",s(4,4,"rule-node-config.notify-device")," "))}var gr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.attributeScopeMap=xt,this.attributeScopes=Object.keys(xt),this.telemetryTypeTranslationsMap=Xt,this.separatorKeysCodes=[13,188,186]}configForm(){return this.deleteAttributesConfigForm}onConfigurationSet(e){this.deleteAttributesConfigForm=this.fb.group({scope:[e?e.scope:null,[u.required]],keys:[e?e.keys:null,[u.required]],sendAttributesDeletedNotification:[e?e.sendAttributesDeletedNotification:!1,[]],notifyDevice:[e?e.notifyDevice:!1,[]]}),this.deleteAttributesConfigForm.get("scope").valueChanges.pipe(ce(this.destroyRef)).subscribe(i=>{i!==xt.SHARED_SCOPE&&this.deleteAttributesConfigForm.get("notifyDevice").patchValue(!1,{emitEvent:!1})})}removeKey(e){let i=this.deleteAttributesConfigForm.get("keys").value,o=i.indexOf(e);o>=0&&(i.splice(o,1),this.deleteAttributesConfigForm.get("keys").patchValue(i,{emitEvent:!0}))}addKey(e){let i=e.input,o=e.value;if((o||"").trim()){o=o.trim();let C=this.deleteAttributesConfigForm.get("keys").value;(!C||C.indexOf(o)===-1)&&(C||(C=[]),C.push(o),this.deleteAttributesConfigForm.get("keys").patchValue(C,{emitEvent:!0}))}i&&(i.value="")}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-delete-attributes-config"]],viewQuery:function(i,o){if(i&1&&De(ws,5),i&2){let C;Ve(C=qe())&&(o.attributeChipList=C.first)}},features:[M],decls:41,vars:31,consts:[["attributeChipList",""],[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],[1,"tb-form-panel","stroked"],[3,"hintText"],[1,"tb-form-row","no-border","no-padding","tb-standard-fields"],[1,"flex"],["required","","matInput","","formControlName","scope",1,"tb-entity-type-select"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","readonly","","disabled","",3,"ngModel","ngModelOptions"],["type","button","matSuffix","","mat-icon-button","","aria-label","Copy","ngxClipboard","",3,"cbContent","matTooltip"],["aria-hidden","false","aria-label","help-icon"],["subscriptSizing","dynamic",1,"mat-block"],["formControlName","keys"],[3,"removed",4,"ngFor","ngForOf"],["matInput","","type","text",3,"matChipInputTokenEnd","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur"],[4,"ngIf"],["translate",""],[1,"tb-settings"],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","sendAttributesDeletedNotification",1,"mat-slide"],["class","tb-form-row no-border no-padding",3,"tb-hint-tooltip-icon",4,"ngIf"],[3,"value"],[3,"removed"],["matChipRemove",""],["formControlName","notifyDevice",1,"mat-slide"]],template:function(i,o){if(i&1){let C=pe();a(0,"section",1)(1,"div",2),f(2,"tb-example-hint",3),a(3,"div",4)(4,"mat-form-field",5)(5,"mat-label"),l(6),m(7,"translate"),n(),a(8,"mat-select",6),g(9,js,3,4,"mat-option",7),n()(),a(10,"mat-form-field",5)(11,"mat-label"),l(12),m(13,"translate"),n(),f(14,"input",8),a(15,"button",9),m(16,"translate"),a(17,"mat-icon",10),l(18,"content_copy "),n()()()()(),a(19,"mat-form-field",11)(20,"mat-label"),l(21),m(22,"translate"),n(),a(23,"mat-chip-grid",12,0),g(25,Us,4,1,"mat-chip-row",13),a(26,"input",14),$("matChipInputTokenEnd",function(Ce){return ie(C),ne(o.addKey(Ce))}),n()(),g(27,Ks,3,3,"mat-error",15),a(28,"mat-hint",16),l(29,"rule-node-config.general-pattern-hint"),n()(),a(30,"section",2)(31,"mat-expansion-panel",17)(32,"mat-expansion-panel-header")(33,"mat-panel-title",16),l(34,"rule-node-config.advanced-settings"),n()(),a(35,"div",18),m(36,"translate"),a(37,"mat-slide-toggle",19),l(38),m(39,"translate"),n()(),g(40,Hs,5,6,"div",20),n()()()}if(i&2){let C=Xe(24);p("formGroup",o.deleteAttributesConfigForm),r(2),p("hintText","rule-node-config.attributes-scope-hint"),r(4),V(s(7,18,"rule-node-config.attributes-scope")),r(3),p("ngForOf",o.attributeScopes),r(3),V(s(13,20,"rule-node-config.attributes-scope-value")),r(2),p("ngModel",o.deleteAttributesConfigForm.get("scope").value)("ngModelOptions",he(30,Gs)),r(),h("matTooltip",s(16,22,"rule-node-config.attributes-scope-value-copy")),p("cbContent",o.deleteAttributesConfigForm.get("scope").value),r(6),V(s(22,24,"rule-node-config.attributes-keys")),r(4),p("ngForOf",o.deleteAttributesConfigForm.get("keys").value),r(),p("matChipInputFor",C)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes)("matChipInputAddOnBlur",!0),r(),p("ngIf",o.deleteAttributesConfigForm.get("keys").hasError("required")),r(8),h("tb-hint-tooltip-icon",s(36,26,"rule-node-config.send-attributes-deleted-notification-hint")),r(3),c(" ",s(39,28,"rule-node-config.send-attributes-deleted-notification")," "),r(2),p("ngIf",o.deleteAttributesConfigForm.get("scope").value===o.attributeScopeMap.SHARED_SCOPE)}},dependencies:[z,k,_e,X,R,q,B,se,Q,oe,ee,W,Z,de,it,nt,rt,Si,Fi,xi,_i,qt,O,S,x,A,ei,_,E,D,ge,Te,I],encapsulation:2})}}return t})();b();var zs=(t,d)=>[t,d],Qs=()=>({maxWidth:"970px"});function Js(t,d){t&1&&(a(0,"mat-error",8),l(1," rule-node-config.custom-expression-field-input-required "),n())}function $s(t,d){if(t&1&&(a(0,"fieldset",2)(1,"legend",21),l(2),m(3,"translate"),n(),a(4,"mat-form-field",22),f(5,"input",23)(6,"div",24),g(7,Js,2,0,"mat-error",11),a(8,"mat-hint",8),l(9,"rule-node-config.custom-expression-field-input-hint"),n()()()),t&2){let e=v();r(2),c("",s(3,4,"rule-node-config.custom-expression-field-input")," *"),r(4),p("tb-help-popup","math/math-methods_fn")("tb-help-popup-style",he(6,Qs)),r(),p("ngIf",e.mathFunctionConfigForm.get("customFunction").hasError("required"))}}function Ys(t,d){if(t&1&&(a(0,"mat-option",25),l(1),m(2,"translate"),a(3,"small",26),l(4),m(5,"translate"),n()()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,3,i.argumentTypeResultMap.get(e).name)," "),r(3),c(" ",s(5,5,i.argumentTypeResultMap.get(e).description)," ")}}function Ws(t,d){t&1&&(a(0,"mat-error",8),l(1," rule-node-config.type-field-input-required "),n())}function Xs(t,d){if(t&1&&(a(0,"mat-option",29),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,2,i.attributeScopeMap.get(e))," ")}}function Zs(t,d){if(t&1&&(a(0,"mat-form-field",7)(1,"mat-label",8),l(2,"rule-node-config.attribute-scope-field-input"),n(),a(3,"mat-select",27),g(4,Xs,3,4,"mat-option",28),n()()),t&2){let e=v();r(4),p("ngForOf",e.attributeScopeResult)}}function ed(t,d){t&1&&(a(0,"mat-error",8),l(1," rule-node-config.key-field-input-required "),n())}function td(t,d){t&1&&(a(0,"div",30)(1,"mat-checkbox",31),l(2),m(3,"translate"),n(),a(4,"mat-checkbox",32),l(5),m(6,"translate"),n()()),t&2&&(r(2),c(" ",s(3,2,"rule-node-config.add-to-message-field-input")," "),r(3),c(" ",s(6,4,"rule-node-config.add-to-metadata-field-input")," "))}var Cr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.MathFunction=K,this.ArgumentTypeResult=Pt,this.argumentTypeResultMap=Ia,this.attributeScopeMap=Tn,this.argumentsResult=Object.values(Pt),this.attributeScopeResult=Object.values(Un)}configForm(){return this.mathFunctionConfigForm}onConfigurationSet(e){this.mathFunctionConfigForm=this.fb.group({operation:[e?e.operation:null,[u.required]],arguments:[e?e.arguments:null,[u.required]],customFunction:[e?e.customFunction:"",[u.required]],result:this.fb.group({type:[e?e.result.type:null,[u.required]],attributeScope:[e?e.result.attributeScope:null,[u.required]],key:[e?e.result.key:"",[u.required]],resultValuePrecision:[e?e.result.resultValuePrecision:0],addToBody:[e?e.result.addToBody:!1],addToMetadata:[e?e.result.addToMetadata:!1]})})}updateValidators(e){let i=this.mathFunctionConfigForm.get("operation").value,o=this.mathFunctionConfigForm.get("result.type").value;i===K.CUSTOM?(this.mathFunctionConfigForm.get("customFunction").enable({emitEvent:!1}),this.mathFunctionConfigForm.get("customFunction").value===null&&this.mathFunctionConfigForm.get("customFunction").patchValue("(x - 32) / 1.8",{emitEvent:!1})):this.mathFunctionConfigForm.get("customFunction").disable({emitEvent:!1}),o===Pt.ATTRIBUTE?this.mathFunctionConfigForm.get("result.attributeScope").enable({emitEvent:!1}):this.mathFunctionConfigForm.get("result.attributeScope").disable({emitEvent:!1}),this.mathFunctionConfigForm.get("customFunction").updateValueAndValidity({emitEvent:e}),this.mathFunctionConfigForm.get("result.attributeScope").updateValueAndValidity({emitEvent:e})}validatorTriggers(){return["operation","result.type"]}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-math-function-config"]],features:[M],decls:39,vars:23,consts:[[1,"flex","flex-col",3,"formGroup"],["required","","formControlName","operation",1,"flex-full","max-h-30%","xs:max-h-full","md:max-h-full"],[1,"fields-group","flex","flex-col","gap-2"],["translate","",1,"group-title"],["formControlName","arguments",3,"function"],["class","fields-group flex flex-col gap-2",4,"ngIf"],["formGroupName","result"],[1,"mat-block","flex-1"],["translate",""],["formControlName","type","required",""],["style","border-bottom: 1px solid #eee;",3,"value",4,"ngFor","ngForOf"],["translate","",4,"ngIf"],[1,"xs:flex-col","gt-xs:gap-4","flex","flex-1","flex-row"],["class","mat-block flex-1",4,"ngIf"],["floatLabel","always",1,"mat-block","flex-1"],["matInput","","formControlName","key","required",""],["aria-hidden","false","aria-label","help-icon","matSuffix","","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],["floatLabel","always","subscriptSizing","dynamic",1,"mat-block","flex-1"],["formControlName","resultValuePrecision","matInput","","step","1","min","0","type","number"],[3,"innerHTML"],["class","xs:flex-col gt-xs:gap-4 flex flex-1 flex-row items-stretch justify-start","style","padding-top: 16px;",4,"ngIf"],[1,"group-title"],["subscriptSizing","dynamic",1,"mat-block","no-margin-top","flex-1"],["matInput","","formControlName","customFunction","required",""],["matSuffix","","tb-help-popup-placement","left",1,"pr-2",3,"tb-help-popup","tb-help-popup-style"],[2,"border-bottom","1px solid #eee",3,"value"],[2,"display","block","overflow","hidden","text-overflow","ellipsis","white-space","nowrap"],["required","","formControlName","attributeScope"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"xs:flex-col","gt-xs:gap-4","flex","flex-1","flex-row","items-stretch","justify-start",2,"padding-top","16px"],["formControlName","addToBody"],["formControlName","addToMetadata"]],template:function(i,o){if(i&1&&(a(0,"section",0),f(1,"tb-math-function-autocomplete",1),a(2,"fieldset",2)(3,"legend",3),l(4,"rule-node-config.argument-tile"),n(),f(5,"tb-arguments-map-config",4),n(),g(6,$s,10,7,"fieldset",5),a(7,"fieldset",2)(8,"legend",3),l(9,"rule-node-config.result-title"),n(),a(10,"div",6)(11,"mat-form-field",7)(12,"mat-label",8),l(13,"rule-node-config.type-field-input"),n(),a(14,"mat-select",9)(15,"mat-select-trigger"),l(16),m(17,"translate"),n(),g(18,Ys,6,7,"mat-option",10),n(),g(19,Ws,2,0,"mat-error",11),n(),a(20,"div",12),g(21,Zs,5,1,"mat-form-field",13),a(22,"mat-form-field",14)(23,"mat-label",8),l(24,"rule-node-config.key-field-input"),n(),f(25,"input",15),a(26,"mat-icon",16),m(27,"translate"),l(28,"help"),n(),g(29,ed,2,0,"mat-error",11),n()(),a(30,"div",12)(31,"mat-form-field",17)(32,"mat-label",8),l(33,"rule-node-config.number-floating-point-field-input"),n(),f(34,"input",18)(35,"mat-hint",19),m(36,"translate"),m(37,"safe"),n()(),g(38,td,7,6,"div",20),n()()()),i&2){let C;p("formGroup",o.mathFunctionConfigForm),r(5),p("function",o.mathFunctionConfigForm.get("operation").value),r(),p("ngIf",o.mathFunctionConfigForm.get("operation").value===o.MathFunction.CUSTOM),r(10),c(" ",s(17,11,(C=o.argumentTypeResultMap.get(o.mathFunctionConfigForm.get("result.type").value))==null?null:C.name)," "),r(2),p("ngForOf",o.argumentsResult),r(),p("ngIf",o.mathFunctionConfigForm.get("result.type").hasError("required")),r(2),p("ngIf",o.mathFunctionConfigForm.get("result").get("type").value===o.ArgumentTypeResult.ATTRIBUTE),r(5),h("matTooltip",s(27,13,"rule-node-config.math-templatization-tooltip")),r(3),p("ngIf",o.mathFunctionConfigForm.get("result.key").hasError("required")),r(6),p("innerHTML",ae(37,17,s(36,15,"rule-node-config.number-floating-point-field-input-hint"),"html"),Pe),r(3),p("ngIf",Yt(20,zs,o.ArgumentTypeResult.ATTRIBUTE,o.ArgumentTypeResult.TIME_SERIES).includes(o.mathFunctionConfigForm.get("result").get("type").value))}},dependencies:[z,k,ni,Ge,X,R,q,B,se,Q,oe,ee,ii,W,Z,O,fe,S,x,A,ve,_,E,Vt,D,zi,Qi,pt,I],styles:['@charset "UTF-8";[_nghost-%COMP%]     .fields-group{padding:0 16px 8px;margin:10px 0;border:1px groove rgba(0,0,0,.25);border-radius:4px}[_nghost-%COMP%]     .fields-group .mat-mdc-form-field .mat-mdc-form-field-infix{width:100%}[_nghost-%COMP%]     .fields-group legend{color:#000000b3;width:fit-content}[_nghost-%COMP%]     .fields-group legend+*{display:block}[_nghost-%COMP%]     .fields-group legend+*.no-margin-top{margin-top:0}']})}}return t})();b();function id(t,d){if(t&1&&(a(0,"mat-option",4),l(1),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",i.messageTypeNames.get(e)," ")}}var yr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.messageTypeNames=gn,this.eventOptions=[Lt.CONNECT_EVENT,Lt.ACTIVITY_EVENT,Lt.DISCONNECT_EVENT,Lt.INACTIVITY_EVENT]}configForm(){return this.deviceState}prepareInputConfig(e){return{event:F(e?.event)?e.event:Lt.ACTIVITY_EVENT}}onConfigurationSet(e){this.deviceState=this.fb.group({event:[e.event,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-device-state-config"]],features:[M],decls:7,vars:5,consts:[[3,"formGroup"],["subscriptSizing","dynamic",1,"mat-block"],["formControlName","event"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label"),l(3),m(4,"translate"),n(),a(5,"mat-select",2),g(6,id,2,2,"mat-option",3),n()()()),i&2&&(p("formGroup",o.deviceState),r(3),V(s(4,3,"rule-node-config.select-device-connectivity-event")),r(3),p("ngForOf",o.eventOptions))},dependencies:[z,q,B,ee,W,S,x,_,E,I],encapsulation:2})}}return t})();b();var vr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.sendRestApiCallReplyConfigForm}onConfigurationSet(e){this.sendRestApiCallReplyConfigForm=this.fb.group({requestIdMetaDataAttribute:[e?e.requestIdMetaDataAttribute:null,[]],serviceIdMetaDataAttribute:[e?e.serviceIdMetaDataAttribute:null,[]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-action-node-send-rest-api-call-reply-config"]],features:[M],decls:13,vars:2,consts:[[1,"tb-form-panel","stroked","no-padding-bottom",3,"formGroup"],["translate","",1,"tb-form-panel-title"],[3,"hintText"],[1,"tb-form-row","no-border","no-padding","tb-standard-fields","column-xs"],[1,"flex"],["translate",""],["matInput","","formControlName","serviceIdMetaDataAttribute"],["matInput","","formControlName","requestIdMetaDataAttribute"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),l(2,"rule-node-config.reply-routing-configuration"),n(),f(3,"tb-example-hint",2),a(4,"div",3)(5,"mat-form-field",4)(6,"mat-label",5),l(7,"rule-node-config.service-id-metadata-attribute"),n(),f(8,"input",6),n(),a(9,"mat-form-field",4)(10,"mat-label",5),l(11,"rule-node-config.request-id-metadata-attribute"),n(),f(12,"input",7),n()()()),i&2&&(p("formGroup",o.sendRestApiCallReplyConfigForm),r(3),p("hintText","rule-node-config.reply-routing-configuration-hint"))},dependencies:[R,q,B,O,S,x,_,E,D,Te],encapsulation:2})}}return t})();var Fn=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=We({type:t})}static{this.\u0275inj=Ye({imports:[ke,Be,Mt,ft]})}}return t})();(function(){Ze(Fn,{declarations:[gr,zn,Qn,Jn,$n,Yn,Wn,Xn,tr,ir,nr,rr,or,ar,lr,pr,dr,vr,ur,cr,fr,Cr,yr,St,xn],imports:[ke,Be,Mt,ft],exports:[gr,zn,Qn,Jn,$n,Yn,Wn,Xn,tr,ir,nr,rr,or,ar,lr,pr,dr,vr,ur,cr,fr,Cr,yr]})})();b();b();var Ga=t=>({inputName:t}),hr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.checkMessageConfigForm}prepareInputConfig(e){return{messageNames:F(e?.messageNames)?e.messageNames:[],metadataNames:F(e?.metadataNames)?e.metadataNames:[],checkAllKeys:F(e?.checkAllKeys)?e.checkAllKeys:!1}}prepareOutputConfig(e){return{messageNames:F(e?.messageNames)?e.messageNames:[],metadataNames:F(e?.metadataNames)?e.metadataNames:[],checkAllKeys:e.checkAllKeys}}atLeastOne(e,i=null){return o=>(i||(i=Object.keys(o.controls)),o?.controls&&i.some(H=>!e(o.controls[H]))?null:{atLeastOne:!0})}onConfigurationSet(e){this.checkMessageConfigForm=this.fb.group({messageNames:[e.messageNames,[]],metadataNames:[e.metadataNames,[]],checkAllKeys:[e.checkAllKeys,[]]},{validators:this.atLeastOne(u.required,["messageNames","metadataNames"])})}get touchedValidationControl(){return["messageNames","metadataNames"].some(e=>this.checkMessageConfigForm.get(e).touched)}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-filter-node-check-message-config"]],features:[M],decls:25,vars:36,consts:[[1,"tb-form-panel","stroked",3,"formGroup"],[1,"tb-form-row","no-padding","no-border","space-between"],["translate","",1,"tb-form-panel-title","tb-required"],["translate","",1,"tb-form-panel-hint","tb-error",3,"hidden"],["editable","","subscriptSizing","dynamic","formControlName","messageNames",3,"label","placeholder"],["matSuffix","","color","primary","aria-hidden","false","aria-label","help-icon",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],["editable","","subscriptSizing","dynamic","formControlName","metadataNames",3,"label","placeholder"],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","checkAllKeys",1,"mat-slide"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2),l(3,"rule-node-config.fields-to-check"),n(),a(4,"div",3),l(5," rule-node-config.at-least-one-field-required "),n()(),a(6,"tb-string-items-list",4),m(7,"translate"),m(8,"translate"),a(9,"mat-icon",5),m(10,"translate"),m(11,"translate"),l(12,"help"),n()(),a(13,"tb-string-items-list",6),m(14,"translate"),m(15,"translate"),a(16,"mat-icon",5),m(17,"translate"),m(18,"translate"),l(19,"help"),n()(),a(20,"div",7),m(21,"translate"),a(22,"mat-slide-toggle",8),l(23),m(24,"translate"),n()()()),i&2&&(p("formGroup",o.checkMessageConfigForm),r(4),p("hidden",!(o.touchedValidationControl&&o.checkMessageConfigForm.hasError("atLeastOne"))),r(2),p("label",s(7,10,"rule-node-config.data-keys"))("placeholder",s(8,12,"rule-node-config.add-message-field")),r(3),h("matTooltip",ae(11,16,"rule-node-config.chip-help",Fe(32,Ga,s(10,14,"rule-node-config.field-name")))),r(4),p("label",s(14,19,"rule-node-config.metadata-keys"))("placeholder",s(15,21,"rule-node-config.add-metadata-field")),r(3),h("matTooltip",ae(18,25,"rule-node-config.chip-help",Fe(34,Ga,s(17,23,"rule-node-config.field-name")))),r(4),h("tb-hint-tooltip-icon",s(21,28,"rule-node-config.check-all-keys-tooltip")),r(3),c(" ",s(24,30,"rule-node-config.check-all-keys")," "))},dependencies:[It,X,oe,Z,de,S,x,_,E,D,ge,I],encapsulation:2})}}return t})();b();function rd(t,d){if(t&1&&(a(0,"mat-option",10),l(1),m(2,"translate"),a(3,"span",11),l(4,"rule-node-config.relations-query-config-direction-suffix"),n()()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.entitySearchDirectionTranslationsMap.get(e))," ")}}function od(t,d){if(t&1&&f(0,"tb-entity-autocomplete",15),t&2){let e=v(2);p("entityType",e.checkRelationConfigForm.get("entityType").value)}}function ad(t,d){if(t&1&&(a(0,"div",12),f(1,"tb-entity-type-select",13),g(2,od,1,1,"tb-entity-autocomplete",14),n()),t&2){let e=v();r(2),p("ngIf",e.checkRelationConfigForm.get("entityType").value)}}var br=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.entitySearchDirection=Object.values(mt),this.entitySearchDirectionTranslationsMap=oi}configForm(){return this.checkRelationConfigForm}prepareInputConfig(e){return{checkForSingleEntity:F(e?.checkForSingleEntity)?e.checkForSingleEntity:!1,direction:F(e?.direction)?e.direction:null,entityType:F(e?.entityType)?e.entityType:null,entityId:F(e?.entityId)?e.entityId:null,relationType:F(e?.relationType)?e.relationType:null}}onConfigurationSet(e){this.checkRelationConfigForm=this.fb.group({checkForSingleEntity:[e.checkForSingleEntity,[]],direction:[e.direction,[]],entityType:[e.entityType,[u.required]],entityId:[e.entityId,[u.required]],relationType:[e.relationType,[u.required]]})}validatorTriggers(){return["checkForSingleEntity","entityType"]}updateValidators(e,i){i==="entityType"?this.checkRelationConfigForm.get("entityId").reset(null):this.checkRelationConfigForm.get("checkForSingleEntity").value?(this.checkRelationConfigForm.get("entityType").enable({emitEvent:!1}),this.checkRelationConfigForm.get("entityId").enable({emitEvent:!1})):(this.checkRelationConfigForm.get("entityType").disable({emitEvent:!1}),this.checkRelationConfigForm.get("entityId").disable({emitEvent:!1}))}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-filter-node-check-relation-config"]],features:[M],decls:17,vars:12,consts:[[1,"tb-form-panel","stroked","no-padding-bottom",3,"formGroup"],["translate","",1,"tb-form-panel-title"],[1,"flex","flex-col"],["hideRequiredMarker","",1,"mat-block"],["formControlName","direction","required",""],[3,"value",4,"ngFor","ngForOf"],["required","","formControlName","relationType"],[1,"tb-form-row","no-border","no-padding","slide-toggle",3,"tb-hint-tooltip-icon"],["formControlName","checkForSingleEntity",1,"mat-slide"],["class","same-width-component-row",4,"ngIf"],[3,"value"],["translate",""],[1,"same-width-component-row"],["showLabel","","required","","formControlName","entityType",2,"min-width","100px","flex","1"],["class","flex-1","required","","formControlName","entityId",3,"entityType",4,"ngIf"],["required","","formControlName","entityId",1,"flex-1",3,"entityType"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),l(2,"rule-node-config.relation-search-parameters"),n(),a(3,"div",2)(4,"mat-form-field",3)(5,"mat-label"),l(6),m(7,"translate"),n(),a(8,"mat-select",4),g(9,rd,5,4,"mat-option",5),n()(),f(10,"tb-relation-type-autocomplete",6),a(11,"div",7),m(12,"translate"),a(13,"mat-slide-toggle",8),l(14),m(15,"translate"),n()(),g(16,ad,3,1,"div",9),n()()),i&2&&(p("formGroup",o.checkRelationConfigForm),r(6),V(s(7,6,"relation.direction")),r(3),p("ngForOf",o.entitySearchDirection),r(2),h("tb-hint-tooltip-icon",s(12,8,"rule-node-config.check-relation-to-specific-entity-tooltip")),r(3),c(" ",s(15,10,"rule-node-config.check-relation-to-specific-entity")," "),r(2),p("ngIf",o.checkRelationConfigForm.get("checkForSingleEntity").value))},dependencies:[z,k,Cn,ri,ai,q,B,ee,W,de,S,x,A,_,E,D,ge,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .slide-toggle[_ngcontent-%COMP%]{margin-bottom:18px}']})}}return t})();b();var ja=t=>({perimeterKeyName:t});function ld(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.latitude-field-name-required")," "))}function pd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.longitude-field-name-required")," "))}function md(t,d){if(t&1&&(a(0,"mat-option",18),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.perimeterTypeTranslationMap.get(e))," ")}}function sd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.perimeter-key-name-required")," "))}function dd(t,d){if(t&1&&(a(0,"mat-form-field",19)(1,"mat-label"),l(2),m(3,"translate"),n(),f(4,"input",20),g(5,sd,3,3,"mat-error",6),a(6,"mat-hint"),l(7),m(8,"translate"),n()()),t&2){let e=v();r(2),V(s(3,3,"rule-node-config.perimeter-key-name")),r(3),p("ngIf",e.geoFilterConfigForm.get("perimeterKeyName").hasError("required")),r(2),V(s(8,5,"rule-node-config.perimeter-key-name-hint"))}}function ud(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.circle-center-latitude-required")," "))}function cd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.circle-center-longitude-required")," "))}function fd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.range-required")," "))}function gd(t,d){if(t&1&&(a(0,"mat-option",18),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,2,i.rangeUnitTranslationMap.get(e))," ")}}function Cd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.range-units-required")," "))}function yd(t,d){if(t&1&&(a(0,"div",9)(1,"div",3)(2,"mat-form-field",21)(3,"mat-label"),l(4),m(5,"translate"),n(),f(6,"input",22),g(7,ud,3,3,"mat-error",6),n(),a(8,"mat-form-field",21)(9,"mat-label"),l(10),m(11,"translate"),n(),f(12,"input",23),g(13,cd,3,3,"mat-error",6),n()(),a(14,"div",3)(15,"mat-form-field",21)(16,"mat-label"),l(17),m(18,"translate"),n(),f(19,"input",24),g(20,fd,3,3,"mat-error",6),n(),a(21,"mat-form-field",21)(22,"mat-label"),l(23),m(24,"translate"),n(),a(25,"mat-select",25),g(26,gd,3,4,"mat-option",12),n(),g(27,Cd,3,3,"mat-error",6),n()()()),t&2){let e=v();r(4),V(s(5,9,"rule-node-config.circle-center-latitude")),r(3),p("ngIf",e.geoFilterConfigForm.get("centerLatitude").hasError("required")),r(3),V(s(11,11,"rule-node-config.circle-center-longitude")),r(3),p("ngIf",e.geoFilterConfigForm.get("centerLongitude").hasError("required")),r(4),V(s(18,13,"rule-node-config.range")),r(3),p("ngIf",e.geoFilterConfigForm.get("range").hasError("required")),r(3),V(s(24,15,"rule-node-config.range-units")),r(3),p("ngForOf",e.rangeUnits),r(),p("ngIf",e.geoFilterConfigForm.get("rangeUnit").hasError("required"))}}function vd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.polygon-definition-required")," "))}function hd(t,d){if(t&1&&(a(0,"mat-form-field",26)(1,"mat-label"),l(2),m(3,"translate"),n(),f(4,"input",27),a(5,"mat-hint"),l(6),m(7,"translate"),n(),g(8,vd,3,3,"mat-error",6),n()),t&2){let e=v();r(2),V(s(3,3,"rule-node-config.polygon-definition")),r(4),V(s(7,5,"rule-node-config.polygon-definition-hint")),r(2),p("ngIf",e.geoFilterConfigForm.get("polygonsDefinition").hasError("required"))}}var Tr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.perimeterType=_t,this.perimeterTypes=Object.values(_t),this.perimeterTypeTranslationMap=vn,this.rangeUnits=Object.values(kt),this.rangeUnitTranslationMap=hn,this.defaultPaddingEnable=!0}configForm(){return this.geoFilterConfigForm}prepareInputConfig(e){return{latitudeKeyName:F(e?.latitudeKeyName)?e.latitudeKeyName:null,longitudeKeyName:F(e?.longitudeKeyName)?e.longitudeKeyName:null,perimeterType:F(e?.perimeterType)?e.perimeterType:null,fetchPerimeterInfoFromMessageMetadata:F(e?.fetchPerimeterInfoFromMessageMetadata)?e.fetchPerimeterInfoFromMessageMetadata:!1,perimeterKeyName:F(e?.perimeterKeyName)?e.perimeterKeyName:null,centerLatitude:F(e?.centerLatitude)?e.centerLatitude:null,centerLongitude:F(e?.centerLongitude)?e.centerLongitude:null,range:F(e?.range)?e.range:null,rangeUnit:F(e?.rangeUnit)?e.rangeUnit:null,polygonsDefinition:F(e?.polygonsDefinition)?e.polygonsDefinition:null}}onConfigurationSet(e){this.geoFilterConfigForm=this.fb.group({latitudeKeyName:[e.latitudeKeyName,[u.required]],longitudeKeyName:[e.longitudeKeyName,[u.required]],perimeterType:[e.perimeterType,[u.required]],fetchPerimeterInfoFromMessageMetadata:[e.fetchPerimeterInfoFromMessageMetadata,[]],perimeterKeyName:[e.perimeterKeyName,[]],centerLatitude:[e.centerLatitude,[]],centerLongitude:[e.centerLongitude,[]],range:[e.range,[]],rangeUnit:[e.rangeUnit,[]],polygonsDefinition:[e.polygonsDefinition,[]]})}validatorTriggers(){return["fetchPerimeterInfoFromMessageMetadata","perimeterType"]}updateValidators(e){let i=this.geoFilterConfigForm.get("fetchPerimeterInfoFromMessageMetadata").value,o=this.geoFilterConfigForm.get("perimeterType").value;i?this.geoFilterConfigForm.get("perimeterKeyName").setValidators([u.required]):this.geoFilterConfigForm.get("perimeterKeyName").setValidators([]),!i&&o===_t.CIRCLE?(this.geoFilterConfigForm.get("centerLatitude").setValidators([u.required,u.min(-90),u.max(90)]),this.geoFilterConfigForm.get("centerLongitude").setValidators([u.required,u.min(-180),u.max(180)]),this.geoFilterConfigForm.get("range").setValidators([u.required,u.min(0)]),this.geoFilterConfigForm.get("rangeUnit").setValidators([u.required]),this.defaultPaddingEnable=!1):(this.geoFilterConfigForm.get("centerLatitude").setValidators([]),this.geoFilterConfigForm.get("centerLongitude").setValidators([]),this.geoFilterConfigForm.get("range").setValidators([]),this.geoFilterConfigForm.get("rangeUnit").setValidators([]),this.defaultPaddingEnable=!0),!i&&o===_t.POLYGON?this.geoFilterConfigForm.get("polygonsDefinition").setValidators([u.required]):this.geoFilterConfigForm.get("polygonsDefinition").setValidators([]),this.geoFilterConfigForm.get("perimeterKeyName").updateValueAndValidity({emitEvent:e}),this.geoFilterConfigForm.get("centerLatitude").updateValueAndValidity({emitEvent:e}),this.geoFilterConfigForm.get("centerLongitude").updateValueAndValidity({emitEvent:e}),this.geoFilterConfigForm.get("range").updateValueAndValidity({emitEvent:e}),this.geoFilterConfigForm.get("rangeUnit").updateValueAndValidity({emitEvent:e}),this.geoFilterConfigForm.get("polygonsDefinition").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-filter-node-gps-geofencing-config"]],features:[M],decls:39,vars:32,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],[1,"tb-form-panel","stroked"],["translate","",1,"tb-form-panel-title"],[1,"flex","flex-row","gap-4"],[1,"mat-block","max-w-50%","flex-full"],["matInput","","formControlName","latitudeKeyName","required",""],[4,"ngIf"],["matInput","","formControlName","longitudeKeyName","required",""],["translate","",1,"tb-form-hint","tb-primary-fill"],[1,"flex","flex-col"],["hideRequiredMarker","",1,"mat-block","flex-1"],["formControlName","perimeterType"],[3,"value",4,"ngFor","ngForOf"],[1,"tb-form-row","no-border","no-padding","slide-toggle",3,"tb-hint-tooltip-icon"],["formControlName","fetchPerimeterInfoFromMessageMetadata",1,"mat-slide"],["class","mat-block",4,"ngIf"],["class","flex flex-col",4,"ngIf"],["class","mat-block","subscriptSizing","dynamic",4,"ngIf"],[3,"value"],[1,"mat-block"],["matInput","","formControlName","perimeterKeyName","required",""],[1,"flex-1"],["type","number","min","-90","max","90","step","0.1","matInput","","formControlName","centerLatitude","required",""],["type","number","min","-180","max","180","step","0.1","matInput","","formControlName","centerLongitude","required",""],["type","number","min","0","step","0.1","matInput","","formControlName","range","required",""],["formControlName","rangeUnit","required",""],["subscriptSizing","dynamic",1,"mat-block"],["matInput","","formControlName","polygonsDefinition","required",""]],template:function(i,o){i&1&&(a(0,"section",0)(1,"section",1)(2,"div",2),l(3,"rule-node-config.coordinate-field-names"),n(),a(4,"section")(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),l(8),m(9,"translate"),n(),f(10,"input",5),g(11,ld,3,3,"mat-error",6),n(),a(12,"mat-form-field",4)(13,"mat-label"),l(14),m(15,"translate"),n(),f(16,"input",7),g(17,pd,3,3,"mat-error",6),n()(),a(18,"div",8),l(19,"rule-node-config.coordinate-field-hint"),n()()(),a(20,"section",1)(21,"div",2),l(22,"rule-node-config.geofence-configuration"),n(),a(23,"section",9)(24,"mat-form-field",10)(25,"mat-label"),l(26),m(27,"translate"),n(),a(28,"mat-select",11),g(29,md,3,4,"mat-option",12),n()(),a(30,"div",13),m(31,"translate"),m(32,"translate"),a(33,"mat-slide-toggle",14),l(34),m(35,"translate"),n()(),g(36,dd,9,7,"mat-form-field",15)(37,yd,28,17,"div",16)(38,hd,9,7,"mat-form-field",17),n()()()),i&2&&(p("formGroup",o.geoFilterConfigForm),r(8),V(s(9,14,"rule-node-config.latitude-field-name")),r(3),p("ngIf",o.geoFilterConfigForm.get("latitudeKeyName").hasError("required")),r(3),V(s(15,16,"rule-node-config.longitude-field-name")),r(3),p("ngIf",o.geoFilterConfigForm.get("longitudeKeyName").hasError("required")),r(3),He("no-padding-bottom",!o.defaultPaddingEnable),r(6),V(s(27,18,"rule-node-config.perimeter-type")),r(3),p("ngForOf",o.perimeterTypes),r(),h("tb-hint-tooltip-icon",o.geoFilterConfigForm.get("perimeterType").value===o.perimeterType.CIRCLE?ae(31,20,"rule-node-config.fetch-circle-parameter-info-from-metadata-hint",Fe(28,ja,o.geoFilterConfigForm.get("perimeterKeyName").valid?o.geoFilterConfigForm.get("perimeterKeyName").value:"ss_perimeter")):ae(32,23,"rule-node-config.fetch-poligon-parameter-info-from-metadata-hint",Fe(30,ja,o.geoFilterConfigForm.get("perimeterKeyName").valid?o.geoFilterConfigForm.get("perimeterKeyName").value:"ss_perimeter"))),r(4),c(" ",s(35,26,"rule-node-config.fetch-perimeter-info-from-metadata")," "),r(2),p("ngIf",o.geoFilterConfigForm.get("fetchPerimeterInfoFromMessageMetadata").value),r(),p("ngIf",o.geoFilterConfigForm.get("perimeterType").value===o.perimeterType.CIRCLE&&!o.geoFilterConfigForm.get("fetchPerimeterInfoFromMessageMetadata").value),r(),p("ngIf",o.geoFilterConfigForm.get("perimeterType").value===o.perimeterType.POLYGON&&!o.geoFilterConfigForm.get("fetchPerimeterInfoFromMessageMetadata").value))},dependencies:[z,k,R,q,B,se,Q,ee,W,de,O,fe,S,x,A,ve,ot,_,E,D,ge,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .slide-toggle[_ngcontent-%COMP%]{margin-bottom:18px}']})}}return t})();b();var xr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.messageTypeConfigForm}prepareInputConfig(e){return{messageTypes:F(e?.messageTypes)?e.messageTypes:null}}onConfigurationSet(e){this.messageTypeConfigForm=this.fb.group({messageTypes:[e.messageTypes,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-filter-node-message-type-config"]],features:[M],decls:3,vars:4,consts:[[3,"formGroup"],["required","","formControlName","messageTypes",3,"label"]],template:function(i,o){i&1&&(a(0,"section",0),f(1,"tb-message-types-config",1),m(2,"translate"),n()),i&2&&(p("formGroup",o.messageTypeConfigForm),r(),p("label",s(2,2,"rule-node-config.select-message-types")))},dependencies:[S,x,A,_,E,Hi,I],encapsulation:2})}}return t})();b();var bd=t=>({inputName:t}),_r=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.allowedEntityTypes=[Y.DEVICE,Y.ASSET,Y.ENTITY_VIEW,Y.TENANT,Y.CUSTOMER,Y.USER,Y.DASHBOARD,Y.RULE_CHAIN,Y.RULE_NODE,Y.EDGE]}configForm(){return this.originatorTypeConfigForm}prepareInputConfig(e){return{originatorTypes:F(e?.originatorTypes)?e.originatorTypes:null}}onConfigurationSet(e){this.originatorTypeConfigForm=this.fb.group({originatorTypes:[e.originatorTypes,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-filter-node-originator-type-config"]],features:[M],decls:9,vars:20,consts:[[3,"formGroup"],["formControlName","originatorTypes","required","",1,"flex-1",3,"allowedEntityTypes","ignoreAuthorityFilter","emptyInputPlaceholder","filledInputPlaceholder","label"],["matSuffix","","aria-hidden","false","aria-label","help-icon","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"tb-entity-type-list",1),m(2,"translate"),m(3,"translate"),m(4,"translate"),a(5,"mat-icon",2),m(6,"translate"),m(7,"translate"),l(8,"help"),n()()()),i&2&&(p("formGroup",o.originatorTypeConfigForm),r(),p("allowedEntityTypes",o.allowedEntityTypes)("ignoreAuthorityFilter",!0)("emptyInputPlaceholder",s(2,7,"rule-node-config.add-entity-type"))("filledInputPlaceholder",s(3,9,"rule-node-config.add-entity-type"))("label",s(4,11,"rule-node-config.select-entity-types")),r(4),h("matTooltip",ae(7,15,"rule-node-config.chip-help",Fe(18,bd,s(6,13,"rule-node-config.entity-type")))))},dependencies:[jo,X,oe,Z,S,x,A,_,E,I],encapsulation:2})}}return t})();b();var Td=["jsFuncComponent"],xd=["tbelFuncComponent"],Ua=()=>["msg","metadata","msgType"];function _d(t,d){t&1&&f(0,"tb-script-lang",7)}function Sd(t,d){if(t&1){let e=pe();a(0,"tb-js-func",8,0)(2,"button",9),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",10),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(4,Ua)),r(2),h("matTooltip",s(3,2,e.testScriptLabel))}}function Fd(t,d){if(t&1){let e=pe();a(0,"tb-js-func",11,1)(2,"button",9),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",10),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(6,Ua))("disableUndefinedCheck",!0)("scriptLanguage",e.scriptLanguage.TBEL),r(2),h("matTooltip",s(3,4,e.testScriptLabel))}}var Sr=(()=>{class t extends N{constructor(e,i,o,C){super(),this.store=e,this.fb=i,this.nodeScriptTestService=o,this.translate=C,this.tbelEnabled=Ct(this.store).tbelEnabled,this.scriptLanguage=J,this.changeScript=new gt,this.hasScript=!0,this.testScriptLabel="rule-node-config.test-filter-function"}configForm(){return this.scriptConfigForm}onConfigurationSet(e){this.scriptConfigForm=this.fb.group({scriptLang:[e.scriptLang,[u.required]],jsScript:[e.jsScript,[]],tbelScript:[e.tbelScript,[]]})}validatorTriggers(){return["scriptLang"]}updateValidators(e){let i=this.scriptConfigForm.get("scriptLang").value;i===J.TBEL&&!this.tbelEnabled&&(i=J.JS,this.scriptConfigForm.get("scriptLang").patchValue(i,{emitEvent:!1}),setTimeout(()=>{this.scriptConfigForm.updateValueAndValidity({emitEvent:!0})})),this.scriptConfigForm.get("jsScript").setValidators(i===J.JS?[u.required]:[]),this.scriptConfigForm.get("jsScript").updateValueAndValidity({emitEvent:e}),this.scriptConfigForm.get("tbelScript").setValidators(i===J.TBEL?[u.required]:[]),this.scriptConfigForm.get("tbelScript").updateValueAndValidity({emitEvent:e})}prepareInputConfig(e){return e&&(e.scriptLang||(e.scriptLang=J.JS)),{scriptLang:F(e?.scriptLang)?e.scriptLang:J.JS,jsScript:F(e?.jsScript)?e.jsScript:null,tbelScript:F(e?.tbelScript)?e.tbelScript:null}}testScript(e){let i=this.scriptConfigForm.get("scriptLang").value,o=i===J.JS?"jsScript":"tbelScript",C=i===J.JS?"rulenode/filter_node_script_fn":"rulenode/tbel/filter_node_script_fn",H=this.scriptConfigForm.get(o).value;this.nodeScriptTestService.testNodeScript(H,"filter",this.translate.instant("rule-node-config.filter"),"Filter",["msg","metadata","msgType"],this.ruleNodeId,C,i,e).subscribe(Ce=>{Ce&&(this.scriptConfigForm.get(o).setValue(Ce),this.changeScript.emit())})}onValidate(){this.scriptConfigForm.get("scriptLang").value===J.JS&&this.jsFuncComponent.validateOnSubmit()}static{this.\u0275fac=function(i){return new(i||t)(y(vi),y(G),y(ht),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-filter-node-script-config"]],viewQuery:function(i,o){if(i&1&&(De(Td,5),De(xd,5)),i&2){let C;Ve(C=qe())&&(o.jsFuncComponent=C.first),Ve(C=qe())&&(o.tbelFuncComponent=C.first)}},features:[M],decls:7,vars:7,consts:[["jsFuncComponent",""],["tbelFuncComponent",""],[3,"formGroup"],["formControlName","scriptLang",4,"ngIf"],["formControlName","jsScript","functionName","Filter","helpId","rulenode/filter_node_script_fn","noValidate","true",3,"functionArgs",4,"ngIf"],["formControlName","tbelScript","functionName","Filter","helpId","rulenode/tbel/filter_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage",4,"ngIf"],["mat-button","","mat-raised-button","","color","primary",3,"click"],["formControlName","scriptLang"],["formControlName","jsScript","functionName","Filter","helpId","rulenode/filter_node_script_fn","noValidate","true",3,"functionArgs"],["toolbarSuffixButton","","mat-icon-button","","matTooltipPosition","above",1,"tb-mat-32",3,"click","matTooltip"],["color","primary",1,"material-icons"],["formControlName","tbelScript","functionName","Filter","helpId","rulenode/tbel/filter_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage"]],template:function(i,o){i&1&&(a(0,"section",2),g(1,_d,1,0,"tb-script-lang",3)(2,Sd,6,5,"tb-js-func",4)(3,Fd,6,7,"tb-js-func",5),a(4,"button",6),$("click",function(){return o.testScript()}),l(5),m(6,"translate"),n()()),i&2&&(p("formGroup",o.scriptConfigForm),r(),p("ngIf",o.tbelEnabled),r(),p("ngIf",o.scriptConfigForm.get("scriptLang").value===o.scriptLanguage.JS),r(),p("ngIf",o.scriptConfigForm.get("scriptLang").value===o.scriptLanguage.TBEL),r(2),c(" ",s(6,5,o.testScriptLabel)," "))},dependencies:[k,vt,we,_e,X,Z,S,x,_,E,Et,I],encapsulation:2})}}return t})();b();var Id=["jsFuncComponent"],Ed=["tbelFuncComponent"],Ka=()=>["msg","metadata","msgType"];function Md(t,d){t&1&&f(0,"tb-script-lang",7)}function Nd(t,d){if(t&1){let e=pe();a(0,"tb-js-func",8,0)(2,"button",9),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",10),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(4,Ka)),r(2),h("matTooltip",s(3,2,e.testScriptLabel))}}function Ad(t,d){if(t&1){let e=pe();a(0,"tb-js-func",11,1)(2,"button",9),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",10),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(6,Ka))("disableUndefinedCheck",!0)("scriptLanguage",e.scriptLanguage.TBEL),r(2),h("matTooltip",s(3,4,e.testScriptLabel))}}var Fr=(()=>{class t extends N{constructor(e,i,o){super(),this.fb=e,this.nodeScriptTestService=i,this.translate=o,this.tbelEnabled=Ct(this.store).tbelEnabled,this.scriptLanguage=J,this.changeScript=new gt,this.hasScript=!0,this.testScriptLabel="rule-node-config.test-switch-function"}configForm(){return this.switchConfigForm}onConfigurationSet(e){this.switchConfigForm=this.fb.group({scriptLang:[e.scriptLang,[u.required]],jsScript:[e.jsScript,[]],tbelScript:[e.tbelScript,[]]})}validatorTriggers(){return["scriptLang"]}updateValidators(e){let i=this.switchConfigForm.get("scriptLang").value;i===J.TBEL&&!this.tbelEnabled&&(i=J.JS,this.switchConfigForm.get("scriptLang").patchValue(i,{emitEvent:!1}),setTimeout(()=>{this.switchConfigForm.updateValueAndValidity({emitEvent:!0})})),this.switchConfigForm.get("jsScript").setValidators(i===J.JS?[u.required]:[]),this.switchConfigForm.get("jsScript").updateValueAndValidity({emitEvent:e}),this.switchConfigForm.get("tbelScript").setValidators(i===J.TBEL?[u.required]:[]),this.switchConfigForm.get("tbelScript").updateValueAndValidity({emitEvent:e})}prepareInputConfig(e){return e&&(e.scriptLang||(e.scriptLang=J.JS)),{scriptLang:F(e?.scriptLang)?e.scriptLang:J.JS,jsScript:F(e?.jsScript)?e.jsScript:null,tbelScript:F(e?.tbelScript)?e.tbelScript:null}}testScript(e){let i=this.switchConfigForm.get("scriptLang").value,o=i===J.JS?"jsScript":"tbelScript",C=i===J.JS?"rulenode/switch_node_script_fn":"rulenode/tbel/switch_node_script_fn",H=this.switchConfigForm.get(o).value;this.nodeScriptTestService.testNodeScript(H,"switch",this.translate.instant("rule-node-config.switch"),"Switch",["msg","metadata","msgType"],this.ruleNodeId,C,i,e).subscribe(Ce=>{Ce&&(this.switchConfigForm.get(o).setValue(Ce),this.changeScript.emit())})}onValidate(){this.switchConfigForm.get("scriptLang").value===J.JS&&this.jsFuncComponent.validateOnSubmit()}static{this.\u0275fac=function(i){return new(i||t)(y(G),y(ht),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-filter-node-switch-config"]],viewQuery:function(i,o){if(i&1&&(De(Id,5),De(Ed,5)),i&2){let C;Ve(C=qe())&&(o.jsFuncComponent=C.first),Ve(C=qe())&&(o.tbelFuncComponent=C.first)}},features:[M],decls:7,vars:7,consts:[["jsFuncComponent",""],["tbelFuncComponent",""],[3,"formGroup"],["formControlName","scriptLang",4,"ngIf"],["formControlName","jsScript","functionName","Switch","helpId","rulenode/switch_node_script_fn","noValidate","true",3,"functionArgs",4,"ngIf"],["formControlName","tbelScript","functionName","Switch","helpId","rulenode/tbel/switch_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage",4,"ngIf"],["mat-button","","mat-raised-button","","color","primary",3,"click"],["formControlName","scriptLang"],["formControlName","jsScript","functionName","Switch","helpId","rulenode/switch_node_script_fn","noValidate","true",3,"functionArgs"],["toolbarSuffixButton","","mat-icon-button","","matTooltipPosition","above",1,"tb-mat-32",3,"click","matTooltip"],["color","primary",1,"material-icons"],["formControlName","tbelScript","functionName","Switch","helpId","rulenode/tbel/switch_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage"]],template:function(i,o){i&1&&(a(0,"section",2),g(1,Md,1,0,"tb-script-lang",3)(2,Nd,6,5,"tb-js-func",4)(3,Ad,6,7,"tb-js-func",5),a(4,"button",6),$("click",function(){return o.testScript()}),l(5),m(6,"translate"),n()()),i&2&&(p("formGroup",o.switchConfigForm),r(),p("ngIf",o.tbelEnabled),r(),p("ngIf",o.switchConfigForm.get("scriptLang").value===o.scriptLanguage.JS),r(),p("ngIf",o.switchConfigForm.get("scriptLang").value===o.scriptLanguage.TBEL),r(2),c(" ",s(6,5,o.testScriptLabel)," "))},dependencies:[k,vt,we,_e,X,Z,S,x,_,E,Et,I],encapsulation:2})}}return t})();b();var Ir=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.searchText=""}configForm(){return this.alarmStatusConfigForm}prepareInputConfig(e){return{alarmStatusList:F(e?.alarmStatusList)?e.alarmStatusList:null}}onConfigurationSet(e){this.alarmStatusConfigForm=this.fb.group({alarmStatusList:[e.alarmStatusList,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-filter-node-check-alarm-status-config"]],features:[M],decls:7,vars:2,consts:[[1,"tb-form-panel","stroked",3,"formGroup"],[1,"tb-form-row","no-padding","no-border","space-between"],["translate","",1,"tb-form-panel-title","tb-required"],["translate","",1,"tb-form-panel-hint","tb-error",3,"hidden"],["formControlName","alarmStatusList"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2),l(3,"rule-node-config.alarm-status"),n(),a(4,"div",3),l(5," rule-node-config.alarm-required "),n()(),f(6,"tb-alarm-status-select",4),n()),i&2&&(p("formGroup",o.alarmStatusConfigForm),r(4),p("hidden",o.alarmStatusConfigForm.get("alarmStatusList").valid))},dependencies:[S,x,_,E,D,Yi],encapsulation:2})}}return t})();var In=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=We({type:t})}static{this.\u0275inj=Ye({imports:[ke,Be,ft]})}}return t})();(function(){Ze(In,{declarations:[hr,br,Tr,xr,_r,Sr,Fr,Ir],imports:[ke,Be,ft],exports:[hr,br,Tr,xr,_r,Sr,Fr,Ir]})})();b();b();function Dd(t,d){if(t&1&&(a(0,"tb-toggle-option",8),l(1),n()),t&2){let e=d.$implicit;p("value",e.value),r(),c(" ",e.name," ")}}var Er=(()=>{class t extends N{constructor(e,i){super(),this.fb=e,this.translate=i,this.fetchToData=[],this.DataToFetch=Me;for(let o of wt.keys())o!==Me.FIELDS&&this.fetchToData.push({value:o,name:this.translate.instant(wt.get(o))})}configForm(){return this.customerAttributesConfigForm}prepareOutputConfig(e){let i={};for(let o of Object.keys(e.dataMapping))i[o.trim()]=e.dataMapping[o];return e.dataMapping=i,Dt(e)}prepareInputConfig(e){let i;F(e?.telemetry)?i=e.telemetry?Me.LATEST_TELEMETRY:Me.ATTRIBUTES:i=F(e?.dataToFetch)?e.dataToFetch:Me.ATTRIBUTES;let o;return F(e?.attrMapping)?o=e.attrMapping:o=F(e?.dataMapping)?e.dataMapping:null,{dataToFetch:i,dataMapping:o,fetchTo:F(e?.fetchTo)?e.fetchTo:ye.METADATA}}selectTranslation(e,i){return this.customerAttributesConfigForm.get("dataToFetch").value===Me.LATEST_TELEMETRY?e:i}onConfigurationSet(e){this.customerAttributesConfigForm=this.fb.group({dataToFetch:[e.dataToFetch,[]],dataMapping:[e.dataMapping,[u.required]],fetchTo:[e.fetchTo]})}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-customer-attributes-config"]],features:[M],decls:17,vars:26,consts:[[1,"tb-form-panel","stroked",3,"formGroup"],["translate","",1,"tb-form-panel-title"],[1,"flex","flex-1","items-center","justify-center"],[1,"fetch-to-data-toggle"],["formControlName","dataToFetch","appearance","fill",1,"fetch-to-data-toggle"],[3,"value",4,"ngFor","ngForOf"],["required","","formControlName","dataMapping","popupHelpLink","rulenode/customer_attributes_node_fields_templatization",3,"requiredText","labelText","keyText","keyRequiredText","valText","valRequiredText","hintText"],["formControlName","fetchTo",3,"labelText"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),l(2,"rule-node-config.mapping-of-customers"),n(),a(3,"div",2)(4,"div",3)(5,"tb-toggle-select",4),g(6,Dd,2,2,"tb-toggle-option",5),n()()(),f(7,"tb-kv-map-config",6),m(8,"translate"),m(9,"translate"),m(10,"translate"),m(11,"translate"),m(12,"translate"),m(13,"translate"),f(14,"tb-msg-metadata-chip",7),m(15,"translate"),m(16,"translate"),n()),i&2&&(p("formGroup",o.customerAttributesConfigForm),r(6),p("ngForOf",o.fetchToData),r(),p("requiredText",s(8,10,"rule-node-config.attr-mapping-required"))("labelText",s(9,12,o.selectTranslation("rule-node-config.latest-telemetry-mapping","rule-node-config.attributes-mapping")))("keyText",s(10,14,o.selectTranslation("rule-node-config.source-telemetry","rule-node-config.source-attribute")))("keyRequiredText",s(11,16,o.selectTranslation("rule-node-config.source-telemetry-required","rule-node-config.source-attribute-required")))("valText",s(12,18,"rule-node-config.target-key"))("valRequiredText",s(13,20,"rule-node-config.target-key-required"))("hintText","rule-node-config.kv-map-pattern-hint"),r(7),p("labelText",o.customerAttributesConfigForm.get("dataToFetch").value===o.DataToFetch.LATEST_TELEMETRY?s(15,22,"rule-node-config.add-mapped-latest-telemetry-to"):s(16,24,"rule-node-config.add-mapped-attribute-to")))},dependencies:[z,S,x,A,_,E,D,Qe,Je,lt,Le,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .fetch-to-data-toggle[_ngcontent-%COMP%]{max-width:420px;width:100%}']})}}return t})();b();var Vd=t=>({inputName:t}),Mr=(()=>{class t extends N{constructor(e,i){super(),this.translate=e,this.fb=i,this.predefinedValues=[];for(let o of Object.keys(st))this.predefinedValues.push({value:st[o],name:this.translate.instant(ua.get(st[o]))})}ngOnInit(){super.ngOnInit()}configForm(){return this.entityDetailsConfigForm}prepareInputConfig(e){let i;return F(e?.addToMetadata)?e.addToMetadata?i=ye.METADATA:i=ye.DATA:e?.fetchTo?i=e.fetchTo:i=ye.DATA,{detailsList:F(e?.detailsList)?e.detailsList:null,fetchTo:i}}onConfigurationSet(e){this.entityDetailsConfigForm=this.fb.group({detailsList:[e.detailsList,[u.required]],fetchTo:[e.fetchTo,[]]})}static{this.\u0275fac=function(i){return new(i||t)(y(le),y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-entity-details-config"]],features:[M],decls:11,vars:22,consts:[[3,"formGroup"],["required","","formControlName","detailsList",1,"mat-block",3,"predefinedValues","label","placeholder","requiredText"],["matSuffix","","aria-hidden","false","aria-label","help-icon","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],["formControlName","fetchTo",3,"labelText"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"tb-string-items-list",1),m(2,"translate"),m(3,"translate"),m(4,"translate"),a(5,"mat-icon",2),m(6,"translate"),m(7,"translate"),l(8," help "),n()(),f(9,"tb-msg-metadata-chip",3),m(10,"translate"),n()),i&2&&(p("formGroup",o.entityDetailsConfigForm),r(),p("predefinedValues",o.predefinedValues)("label",s(2,7,"rule-node-config.select-details"))("placeholder",s(3,9,"rule-node-config.add-detail"))("requiredText",s(4,11,"rule-node-config.entity-details-list-empty")),r(4),h("matTooltip",ae(7,15,"rule-node-config.chip-help",Fe(20,Vd,s(6,13,"rule-node-config.detail")))),r(4),p("labelText",s(10,18,"rule-node-config.add-selected-details-to")))},dependencies:[It,X,oe,Z,S,x,A,_,E,Le,I],encapsulation:2})}}return t})();b();var Nr=(()=>{class t extends N{constructor(e,i){super(),this.translate=e,this.fb=i}configForm(){return this.deviceAttributesConfigForm}onConfigurationSet(e){this.deviceAttributesConfigForm=this.fb.group({deviceRelationsQuery:[e.deviceRelationsQuery,[u.required]],tellFailureIfAbsent:[e.tellFailureIfAbsent,[]],fetchTo:[e.fetchTo,[]],attributesControl:[e.attributesControl,[]]})}prepareInputConfig(e){return hi(e)&&(e.attributesControl={clientAttributeNames:F(e?.clientAttributeNames)?e.clientAttributeNames:[],latestTsKeyNames:F(e?.latestTsKeyNames)?e.latestTsKeyNames:[],serverAttributeNames:F(e?.serverAttributeNames)?e.serverAttributeNames:[],sharedAttributeNames:F(e?.sharedAttributeNames)?e.sharedAttributeNames:[],getLatestValueWithTs:F(e?.getLatestValueWithTs)?e.getLatestValueWithTs:!1}),{deviceRelationsQuery:F(e?.deviceRelationsQuery)?e.deviceRelationsQuery:null,tellFailureIfAbsent:F(e?.tellFailureIfAbsent)?e.tellFailureIfAbsent:!0,fetchTo:F(e?.fetchTo)?e.fetchTo:ye.METADATA,attributesControl:e?e.attributesControl:null}}prepareOutputConfig(e){for(let i of Object.keys(e.attributesControl))e[i]=e.attributesControl[i];return delete e.attributesControl,e}static{this.\u0275fac=function(i){return new(i||t)(y(le),y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-device-attributes-config"]],features:[M],decls:19,vars:11,consts:[[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],[1,"tb-form-panel","stroked","no-padding-bottom"],["translate","",1,"tb-form-panel-title"],["required","","formControlName","deviceRelationsQuery"],[1,"tb-form-panel","stroked"],[1,"tb-form-row","no-padding","no-border","space-between"],["translate","",1,"tb-form-panel-title","tb-required"],["translate","",1,"tb-form-panel-hint","tb-error",3,"hidden"],["formControlName","attributesControl","popupHelpLink","rulenode/related_device_attributes_node_fields_templatization"],["formControlName","fetchTo",3,"labelText"],[1,"tb-form-row","same-padding",3,"tb-hint-tooltip-icon"],["formControlName","tellFailureIfAbsent",1,"mat-slide","margin"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2),l(3,"rule-node-config.device-relations-query"),n(),f(4,"tb-device-relations-query-config",3),n(),a(5,"div",4)(6,"div",5)(7,"div",6),l(8,"rule-node-config.related-device-attributes"),n(),a(9,"div",7),l(10," rule-node-config.at-least-one-field-required "),n()(),f(11,"tb-select-attributes",8)(12,"tb-msg-metadata-chip",9),m(13,"translate"),n(),a(14,"div",10),m(15,"translate"),a(16,"mat-slide-toggle",11),l(17),m(18,"translate"),n()()()),i&2&&(p("formGroup",o.deviceAttributesConfigForm),r(9),p("hidden",!(o.deviceAttributesConfigForm.get("attributesControl").touched&&o.deviceAttributesConfigForm.get("attributesControl").hasError("atLeastOneRequired"))),r(3),p("labelText",s(13,5,"rule-node-config.add-selected-attributes-to")),r(2),h("tb-hint-tooltip-icon",s(15,7,"rule-node-config.tell-failure-tooltip")),r(3),c(" ",s(18,9,"rule-node-config.tell-failure")," "))},dependencies:[de,S,x,A,_,E,D,ge,Ki,Le,Ci,I],encapsulation:2})}}return t})();b();var Ar=(()=>{class t extends N{constructor(e,i){super(),this.translate=e,this.fb=i}configForm(){return this.originatorAttributesConfigForm}onConfigurationSet(e){this.originatorAttributesConfigForm=this.fb.group({tellFailureIfAbsent:[e.tellFailureIfAbsent,[]],fetchTo:[e.fetchTo,[]],attributesControl:[e.attributesControl,[]]})}prepareInputConfig(e){return hi(e)&&(e.attributesControl={clientAttributeNames:F(e?.clientAttributeNames)?e.clientAttributeNames:[],latestTsKeyNames:F(e?.latestTsKeyNames)?e.latestTsKeyNames:[],serverAttributeNames:F(e?.serverAttributeNames)?e.serverAttributeNames:[],sharedAttributeNames:F(e?.sharedAttributeNames)?e.sharedAttributeNames:[],getLatestValueWithTs:F(e?.getLatestValueWithTs)?e.getLatestValueWithTs:!1}),{fetchTo:F(e?.fetchTo)?e.fetchTo:ye.METADATA,tellFailureIfAbsent:F(e?.tellFailureIfAbsent)?e.tellFailureIfAbsent:!1,attributesControl:F(e?.attributesControl)?e.attributesControl:null}}prepareOutputConfig(e){for(let i of Object.keys(e.attributesControl))e[i]=e.attributesControl[i];return delete e.attributesControl,e}static{this.\u0275fac=function(i){return new(i||t)(y(le),y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-originator-attributes-config"]],features:[M],decls:15,vars:11,consts:[[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],[1,"tb-form-panel","stroked"],[1,"tb-form-row","no-padding","no-border","space-between"],["translate","",1,"tb-form-panel-title","tb-required"],["translate","",1,"tb-form-panel-hint","tb-error",3,"hidden"],["formControlName","attributesControl","popupHelpLink","rulenode/originator_attributes_node_fields_templatization"],["formControlName","fetchTo",3,"labelText"],[1,"tb-form-row","same-padding",3,"tb-hint-tooltip-icon"],["formControlName","tellFailureIfAbsent",1,"mat-slide","margin"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),l(4,"rule-node-config.originator-attributes"),n(),a(5,"div",4),l(6," rule-node-config.at-least-one-field-required "),n()(),f(7,"tb-select-attributes",5)(8,"tb-msg-metadata-chip",6),m(9,"translate"),n(),a(10,"div",7),m(11,"translate"),a(12,"mat-slide-toggle",8),l(13),m(14,"translate"),n()()()),i&2&&(p("formGroup",o.originatorAttributesConfigForm),r(5),p("hidden",!(o.originatorAttributesConfigForm.get("attributesControl").touched&&o.originatorAttributesConfigForm.get("attributesControl").hasError("atLeastOneRequired"))),r(3),p("labelText",s(9,5,"rule-node-config.add-originator-attributes-to")),r(2),h("tb-hint-tooltip-icon",s(11,7,"rule-node-config.tell-failure-tooltip")),r(3),c(" ",s(14,9,"rule-node-config.tell-failure")," "))},dependencies:[de,S,x,_,E,D,ge,Le,Ci,I],encapsulation:2})}}return t})();b();var Dr=(()=>{class t extends N{constructor(e,i){super(),this.fb=e,this.translate=i,this.originatorFields=[];for(let o of Ai)this.originatorFields.push({value:o.value,name:this.translate.instant(o.name)})}configForm(){return this.originatorFieldsConfigForm}prepareOutputConfig(e){return Dt(e)}prepareInputConfig(e){return{dataMapping:F(e?.dataMapping)?e.dataMapping:null,ignoreNullStrings:F(e?.ignoreNullStrings)?e.ignoreNullStrings:null,fetchTo:F(e?.fetchTo)?e.fetchTo:ye.METADATA}}onConfigurationSet(e){this.originatorFieldsConfigForm=this.fb.group({dataMapping:[e.dataMapping,[u.required]],ignoreNullStrings:[e.ignoreNullStrings,[]],fetchTo:[e.fetchTo,[]]})}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-originator-fields-config"]],features:[M],decls:16,vars:32,consts:[[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],["required","","targetKeyPrefix","originator","formControlName","dataMapping","popupHelpLink","rulenode/originator_fields_node_fields_templatization",3,"selectOptions","requiredText","labelText","selectText","selectRequiredText","valText","valRequiredText","hintText"],["formControlName","fetchTo",3,"labelText"],[1,"tb-form-row","same-padding",3,"tb-hint-tooltip-icon"],["formControlName","ignoreNullStrings",1,"mat-slide","margin"]],template:function(i,o){i&1&&(a(0,"section",0),f(1,"tb-sv-map-config",1),m(2,"translate"),m(3,"translate"),m(4,"translate"),m(5,"translate"),m(6,"translate"),m(7,"translate"),m(8,"translate"),f(9,"tb-msg-metadata-chip",2),m(10,"translate"),a(11,"div",3),m(12,"translate"),a(13,"mat-slide-toggle",4),l(14),m(15,"translate"),n()()()),i&2&&(p("formGroup",o.originatorFieldsConfigForm),r(),p("selectOptions",o.originatorFields)("requiredText",s(2,12,"rule-node-config.attr-mapping-required"))("labelText",s(3,14,"rule-node-config.originator-fields-mapping"))("selectText",s(4,16,"rule-node-config.source-field"))("selectRequiredText",s(5,18,"rule-node-config.source-field-required"))("valText",s(6,20,"rule-node-config.target-key"))("valRequiredText",s(7,22,"rule-node-config.target-key-required"))("hintText",s(8,24,"rule-node-config.originator-fields-sv-map-hint")),r(8),p("labelText",s(10,26,"rule-node-config.add-mapped-originator-fields-to")),r(2),h("tb-hint-tooltip-icon",s(12,28,"rule-node-config.skip-empty-fields-tooltip")),r(3),c(" ",s(15,30,"rule-node-config.skip-empty-fields")," "))},dependencies:[de,S,x,A,_,E,ge,Le,At,I],encapsulation:2})}}return t})();b();var qd=()=>({maxWidth:"820px"}),kd=t=>({inputName:t}),Bd=(t,d,e,i)=>({startInterval:t,endInterval:d,startIntervalTimeUnit:e,endIntervalTimeUnit:i});function Od(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.start-interval-value-required")," "))}function Rd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.time-value-range")," "))}function Ld(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.time-value-range")," "))}function Pd(t,d){if(t&1&&(a(0,"mat-option",29),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,2,i.timeUnitsTranslationMap.get(e))," ")}}function wd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.end-interval-value-required")," "))}function Gd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.time-value-range")," "))}function jd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.time-value-range")," "))}function Ud(t,d){if(t&1&&(a(0,"mat-option",29),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,2,i.timeUnitsTranslationMap.get(e))," ")}}function Kd(t,d){if(t&1&&(go(0),l(1),m(2,"translate"),Co()),t&2){let e=v(2);r(),c(" ",ae(2,1,"rule-node-config.fetch-timeseries-from-to",bo(4,Bd,e.getTelemetryFromDatabaseConfigForm.get("interval.startInterval").value,e.getTelemetryFromDatabaseConfigForm.get("interval.endInterval").value,e.getTelemetryFromDatabaseConfigForm.get("interval.startIntervalTimeUnit").value.toLowerCase(),e.getTelemetryFromDatabaseConfigForm.get("interval.endIntervalTimeUnit").value.toLowerCase()))," ")}}function Hd(t,d){t&1&&(l(0),m(1,"translate")),t&2&&c(" ",s(1,1,"rule-node-config.fetch-timeseries-from-to-invalid")," ")}function zd(t,d){if(t&1&&(a(0,"div",17)(1,"div",18)(2,"mat-form-field",19)(3,"mat-label"),l(4),m(5,"translate"),n(),f(6,"input",20),g(7,Od,3,3,"mat-error",16)(8,Rd,3,3,"mat-error",16)(9,Ld,3,3,"mat-error",16),n(),a(10,"mat-form-field",21)(11,"mat-label"),l(12),m(13,"translate"),n(),a(14,"mat-select",22),g(15,Pd,3,4,"mat-option",14),n()()(),a(16,"div",18)(17,"mat-form-field",19)(18,"mat-label"),l(19),m(20,"translate"),n(),f(21,"input",23),g(22,wd,3,3,"mat-error",16)(23,Gd,3,3,"mat-error",16)(24,jd,3,3,"mat-error",16),n(),a(25,"mat-form-field",21)(26,"mat-label"),l(27),m(28,"translate"),n(),a(29,"mat-select",24),g(30,Ud,3,4,"mat-option",14),n()()(),a(31,"div",25)(32,"mat-icon",26),l(33,"error_outline"),n(),a(34,"div",27),g(35,Kd,3,9,"ng-container",28)(36,Hd,2,3,"ng-template",null,1,Rt),n()()()),t&2){let e=Xe(37),i=v();r(4),V(s(5,16,"rule-node-config.interval-start")),r(3),p("ngIf",i.getTelemetryFromDatabaseConfigForm.get("interval.startInterval").hasError("required")),r(),p("ngIf",i.getTelemetryFromDatabaseConfigForm.get("interval.startInterval").hasError("min")),r(),p("ngIf",i.getTelemetryFromDatabaseConfigForm.get("interval.startInterval").hasError("max")),r(3),V(s(13,18,"rule-node-config.time-unit")),r(3),p("ngForOf",i.timeUnits),r(4),V(s(20,20,"rule-node-config.interval-end")),r(3),p("ngIf",i.getTelemetryFromDatabaseConfigForm.get("interval.endInterval").hasError("required")),r(),p("ngIf",i.getTelemetryFromDatabaseConfigForm.get("interval.endInterval").hasError("min")),r(),p("ngIf",i.getTelemetryFromDatabaseConfigForm.get("interval.endInterval").hasError("max")),r(3),V(s(28,22,"rule-node-config.time-unit")),r(3),p("ngForOf",i.timeUnits),r(),He("error",i.getTelemetryFromDatabaseConfigForm.get("interval").invalid),r(4),p("ngIf",i.getTelemetryFromDatabaseConfigForm.get("interval").valid)("ngIfElse",e)}}function Qd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.start-interval-required")," "))}function Jd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.end-interval-required")," "))}function $d(t,d){if(t&1&&(a(0,"div",30)(1,"mat-form-field",31)(2,"mat-label"),l(3),m(4,"translate"),n(),f(5,"input",32),g(6,Qd,3,3,"mat-error",16),n(),a(7,"mat-form-field",31)(8,"mat-label"),l(9),m(10,"translate"),n(),f(11,"input",33),g(12,Jd,3,3,"mat-error",16),n(),f(13,"tb-example-hint",34),n()),t&2){let e=v();r(3),V(s(4,5,"rule-node-config.start-interval")),r(3),p("ngIf",e.getTelemetryFromDatabaseConfigForm.get("startIntervalPattern").hasError("required")||e.getTelemetryFromDatabaseConfigForm.get("startIntervalPattern").hasError("pattern")),r(3),V(s(10,7,"rule-node-config.end-interval")),r(3),p("ngIf",e.getTelemetryFromDatabaseConfigForm.get("endIntervalPattern").hasError("required")||e.getTelemetryFromDatabaseConfigForm.get("endIntervalPattern").hasError("pattern")),r(),p("hintText","rule-node-config.metadata-dynamic-interval-hint")}}function Yd(t,d){if(t&1&&(a(0,"tb-toggle-option",29),l(1),n()),t&2){let e=d.$implicit;p("value",e.value),r(),c(" ",e.name," ")}}function Wd(t,d){if(t&1&&(a(0,"mat-option",29),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,2,i.aggregationTypesTranslations.get(i.aggregationTypes[e]))," ")}}function Xd(t,d){if(t&1&&(a(0,"mat-option",29),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(3);p("value",e),r(),c(" ",s(2,2,i.samplingOrdersTranslate.get(e))," ")}}function Zd(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.limit-required")," "))}function eu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.limit-range")," "))}function tu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.limit-range")," "))}function iu(t,d){if(t&1&&(a(0,"div")(1,"mat-form-field",37)(2,"mat-label"),l(3),m(4,"translate"),n(),a(5,"mat-select",38),g(6,Xd,3,4,"mat-option",14),n()(),a(7,"mat-form-field",39)(8,"mat-label"),l(9),m(10,"translate"),n(),f(11,"input",40),a(12,"mat-hint"),l(13),m(14,"translate"),n(),g(15,Zd,3,3,"mat-error",16)(16,eu,3,3,"mat-error",16)(17,tu,3,3,"mat-error",16),n()()),t&2){let e=v(2);r(3),c(" ",s(4,7,"rule-node-config.order-by-timestamp")," "),r(3),p("ngForOf",e.samplingOrders),r(3),V(s(10,9,"rule-node-config.limit")),r(4),V(s(14,11,"rule-node-config.limit-hint")),r(2),p("ngIf",e.getTelemetryFromDatabaseConfigForm.get("limit").hasError("required")),r(),p("ngIf",e.getTelemetryFromDatabaseConfigForm.get("limit").hasError("min")),r(),p("ngIf",e.getTelemetryFromDatabaseConfigForm.get("limit").hasError("max"))}}function nu(t,d){if(t&1&&(a(0,"div")(1,"mat-form-field",35)(2,"mat-label"),l(3),m(4,"translate"),n(),a(5,"mat-select",36),g(6,Wd,3,4,"mat-option",14),n()(),g(7,iu,18,13,"div",16),n()),t&2){let e=v();r(),p("subscriptSizing",e.defaultPaddingEnable()?"fixed":"dynamic"),r(2),V(s(4,4,"aggregation.function")),r(3),p("ngForOf",e.aggregations),r(),p("ngIf",e.getTelemetryFromDatabaseConfigForm.get("aggregation").value===e.aggregationTypes.NONE)}}var Vr=(()=>{class t extends N{constructor(e,i){super(),this.translate=e,this.fb=i,this.aggregationTypes=Bi,this.aggregations=Object.values(Bi),this.aggregationTypesTranslations=No,this.fetchMode=bt,this.samplingOrders=Object.values(Mi),this.samplingOrdersTranslate=ga,this.timeUnits=Object.values(Re),this.timeUnitsTranslationMap=Di,this.deduplicationStrategiesHintTranslations=ca,this.headerOptions=[],this.timeUnitMap={[Re.MILLISECONDS]:1,[Re.SECONDS]:1e3,[Re.MINUTES]:6e4,[Re.HOURS]:36e5,[Re.DAYS]:864e5},this.intervalValidator=()=>o=>o.get("startInterval").value*this.timeUnitMap[o.get("startIntervalTimeUnit").value]<=o.get("endInterval").value*this.timeUnitMap[o.get("endIntervalTimeUnit").value]?{intervalError:!0}:null;for(let o of Pi.keys())this.headerOptions.push({value:o,name:this.translate.instant(Pi.get(o))})}configForm(){return this.getTelemetryFromDatabaseConfigForm}onConfigurationSet(e){this.getTelemetryFromDatabaseConfigForm=this.fb.group({latestTsKeyNames:[e.latestTsKeyNames,[u.required]],aggregation:[e.aggregation,[u.required]],fetchMode:[e.fetchMode,[u.required]],orderBy:[e.orderBy,[]],limit:[e.limit,[]],useMetadataIntervalPatterns:[e.useMetadataIntervalPatterns,[]],interval:this.fb.group({startInterval:[e.interval.startInterval,[]],startIntervalTimeUnit:[e.interval.startIntervalTimeUnit,[]],endInterval:[e.interval.endInterval,[]],endIntervalTimeUnit:[e.interval.endIntervalTimeUnit,[]]}),startIntervalPattern:[e.startIntervalPattern,[]],endIntervalPattern:[e.endIntervalPattern,[]]})}validatorTriggers(){return["fetchMode","useMetadataIntervalPatterns"]}prepareOutputConfig(e){return e.startInterval=e.interval.startInterval,e.startIntervalTimeUnit=e.interval.startIntervalTimeUnit,e.endInterval=e.interval.endInterval,e.endIntervalTimeUnit=e.interval.endIntervalTimeUnit,delete e.interval,Dt(e)}prepareInputConfig(e){return hi(e)&&(e.interval={startInterval:e.startInterval,startIntervalTimeUnit:e.startIntervalTimeUnit,endInterval:e.endInterval,endIntervalTimeUnit:e.endIntervalTimeUnit}),{latestTsKeyNames:F(e?.latestTsKeyNames)?e.latestTsKeyNames:null,aggregation:F(e?.aggregation)?e.aggregation:Bi.NONE,fetchMode:F(e?.fetchMode)?e.fetchMode:bt.FIRST,orderBy:F(e?.orderBy)?e.orderBy:Mi.ASC,limit:F(e?.limit)?e.limit:1e3,useMetadataIntervalPatterns:F(e?.useMetadataIntervalPatterns)?e.useMetadataIntervalPatterns:!1,interval:{startInterval:F(e?.interval?.startInterval)?e.interval.startInterval:2,startIntervalTimeUnit:F(e?.interval?.startIntervalTimeUnit)?e.interval.startIntervalTimeUnit:Re.MINUTES,endInterval:F(e?.interval?.endInterval)?e.interval.endInterval:1,endIntervalTimeUnit:F(e?.interval?.endIntervalTimeUnit)?e.interval.endIntervalTimeUnit:Re.MINUTES},startIntervalPattern:F(e?.startIntervalPattern)?e.startIntervalPattern:null,endIntervalPattern:F(e?.endIntervalPattern)?e.endIntervalPattern:null}}updateValidators(e){let i=this.getTelemetryFromDatabaseConfigForm.get("fetchMode").value,o=this.getTelemetryFromDatabaseConfigForm.get("useMetadataIntervalPatterns").value;i&&i===bt.ALL?(this.getTelemetryFromDatabaseConfigForm.get("aggregation").setValidators([u.required]),this.getTelemetryFromDatabaseConfigForm.get("orderBy").setValidators([u.required]),this.getTelemetryFromDatabaseConfigForm.get("limit").setValidators([u.required,u.min(2),u.max(1e3)])):(this.getTelemetryFromDatabaseConfigForm.get("aggregation").setValidators([]),this.getTelemetryFromDatabaseConfigForm.get("orderBy").setValidators([]),this.getTelemetryFromDatabaseConfigForm.get("limit").setValidators([])),o?(this.getTelemetryFromDatabaseConfigForm.get("interval.startInterval").setValidators([]),this.getTelemetryFromDatabaseConfigForm.get("interval.startIntervalTimeUnit").setValidators([]),this.getTelemetryFromDatabaseConfigForm.get("interval.endInterval").setValidators([]),this.getTelemetryFromDatabaseConfigForm.get("interval.endIntervalTimeUnit").setValidators([]),this.getTelemetryFromDatabaseConfigForm.get("interval").setValidators([]),this.getTelemetryFromDatabaseConfigForm.get("startIntervalPattern").setValidators([u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)]),this.getTelemetryFromDatabaseConfigForm.get("endIntervalPattern").setValidators([u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)])):(this.getTelemetryFromDatabaseConfigForm.get("interval.startInterval").setValidators([u.required,u.min(1),u.max(2147483647)]),this.getTelemetryFromDatabaseConfigForm.get("interval.startIntervalTimeUnit").setValidators([u.required]),this.getTelemetryFromDatabaseConfigForm.get("interval.endInterval").setValidators([u.required,u.min(1),u.max(2147483647)]),this.getTelemetryFromDatabaseConfigForm.get("interval.endIntervalTimeUnit").setValidators([u.required]),this.getTelemetryFromDatabaseConfigForm.get("interval").setValidators([this.intervalValidator()]),this.getTelemetryFromDatabaseConfigForm.get("startIntervalPattern").setValidators([]),this.getTelemetryFromDatabaseConfigForm.get("endIntervalPattern").setValidators([])),this.getTelemetryFromDatabaseConfigForm.get("aggregation").updateValueAndValidity({emitEvent:e}),this.getTelemetryFromDatabaseConfigForm.get("orderBy").updateValueAndValidity({emitEvent:e}),this.getTelemetryFromDatabaseConfigForm.get("limit").updateValueAndValidity({emitEvent:e}),this.getTelemetryFromDatabaseConfigForm.get("interval.startInterval").updateValueAndValidity({emitEvent:e}),this.getTelemetryFromDatabaseConfigForm.get("interval.startIntervalTimeUnit").updateValueAndValidity({emitEvent:e}),this.getTelemetryFromDatabaseConfigForm.get("interval.endInterval").updateValueAndValidity({emitEvent:e}),this.getTelemetryFromDatabaseConfigForm.get("interval.endIntervalTimeUnit").updateValueAndValidity({emitEvent:e}),this.getTelemetryFromDatabaseConfigForm.get("interval").updateValueAndValidity({emitEvent:e}),this.getTelemetryFromDatabaseConfigForm.get("startIntervalPattern").updateValueAndValidity({emitEvent:e}),this.getTelemetryFromDatabaseConfigForm.get("endIntervalPattern").updateValueAndValidity({emitEvent:e})}defaultPaddingEnable(){return this.getTelemetryFromDatabaseConfigForm.get("fetchMode").value===bt.ALL&&this.getTelemetryFromDatabaseConfigForm.get("aggregation").value===Bi.NONE}static{this.\u0275fac=function(i){return new(i||t)(y(le),y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-get-telemetry-from-database"]],features:[M],decls:34,vars:40,consts:[["intervalPattern",""],["invalidText",""],[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],["editable","","subscriptSizing","dynamic","required","","formControlName","latestTsKeyNames",1,"mat-block",3,"placeholder","requiredText","label","hint"],["matHintEnd","","hintMode","","tb-help-popup-placement","right","trigger-style","letter-spacing:0.25px; font-size:12px",1,"see-example",3,"tb-help-popup","tb-help-popup-style","trigger-text"],["matSuffix","","aria-hidden","false","aria-label","help-icon","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],[1,"tb-form-panel","stroked"],["translate","",1,"tb-form-panel-title"],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","useMetadataIntervalPatterns",1,"mat-slide"],["formGroupName","interval","class","flex flex-col",4,"ngIf","ngIfElse"],[1,"tb-form-panel","no-border","no-padding","item-center"],[1,"fetch-mod-toggle"],["formControlName","fetchMode","appearance","fill"],[3,"value",4,"ngFor","ngForOf"],[1,"tb-form-hint","tb-primary-fill","hint-container"],[4,"ngIf"],["formGroupName","interval",1,"flex","flex-col"],[1,"flex","flex-col","gap-0","gt-sm:flex-row","gt-sm:gap-4"],[1,"mat-block","gt-sm:max-w-50%","gt-sm:flex-full"],["type","number","step","1","min","1","max","2147483647","matInput","","formControlName","startInterval","required",""],["hideRequiredMarker","",1,"mat-block","gt-sm:max-w-50%","gt-sm:flex-full"],["formControlName","startIntervalTimeUnit","required",""],["type","number","step","1","min","1","max","2147483647","matInput","","formControlName","endInterval","required",""],["formControlName","endIntervalTimeUnit","required",""],[1,"description-block","tb-primary-fill"],[1,"description-icon"],[1,"description-text"],[4,"ngIf","ngIfElse"],[3,"value"],[1,"input-block","flex","flex-col"],[1,"mat-block","flex-1"],["matInput","","formControlName","startIntervalPattern","required",""],["matInput","","formControlName","endIntervalPattern","required",""],["popupHelpLink","rulenode/originator_telemetry_node_fields_templatization",3,"hintText"],["hideRequiredMarker","",1,"mat-block",3,"subscriptSizing"],["formControlName","aggregation","required",""],["hideRequiredMarker","",1,"mat-block"],["formControlName","orderBy","required",""],[1,"mat-block"],["type","number","min","2","max","1000","step","1","matInput","","formControlName","limit","required",""]],template:function(i,o){if(i&1&&(a(0,"section",2)(1,"tb-string-items-list",3),m(2,"translate"),m(3,"translate"),m(4,"translate"),m(5,"translate"),f(6,"div",4),m(7,"translate"),a(8,"mat-icon",5),m(9,"translate"),m(10,"translate"),l(11,"help "),n()(),a(12,"div",6)(13,"div",7),l(14,"rule-node-config.fetch-interval"),n(),a(15,"div",8),m(16,"translate"),a(17,"mat-slide-toggle",9),l(18),m(19,"translate"),n()(),g(20,zd,38,24,"div",10)(21,$d,14,9,"ng-template",null,0,Rt),n(),a(23,"div",6)(24,"div",7),l(25,"rule-node-config.fetch-strategy"),n(),a(26,"div",11)(27,"div",12)(28,"tb-toggle-select",13),g(29,Yd,2,2,"tb-toggle-option",14),n()(),a(30,"div",15),l(31),m(32,"translate"),n()(),g(33,nu,8,6,"div",16),n()()),i&2){let C=Xe(22);p("formGroup",o.getTelemetryFromDatabaseConfigForm),r(),p("placeholder",s(2,16,"rule-node-config.add-timeseries-key"))("requiredText",s(3,18,"rule-node-config.timeseries-keys-required"))("label",s(4,20,"rule-node-config.timeseries-keys"))("hint",s(5,22,"rule-node-config.general-pattern-hint")),r(5),h("tb-help-popup","rulenode/originator_telemetry_node_fields_templatization"),h("trigger-text",s(7,24,"rule-node-config.key-val.see-examples")),p("tb-help-popup-style",he(37,qd)),r(2),h("matTooltip",ae(10,28,"rule-node-config.chip-help",Fe(38,kd,s(9,26,"rule-node-config.timeseries-key")))),r(7),h("tb-hint-tooltip-icon",s(16,31,"rule-node-config.use-metadata-dynamic-interval-tooltip")),r(3),c(" ",s(19,33,"rule-node-config.use-metadata-dynamic-interval")," "),r(2),p("ngIf",o.getTelemetryFromDatabaseConfigForm.get("useMetadataIntervalPatterns").value===!1)("ngIfElse",C),r(9),p("ngForOf",o.headerOptions),r(2),c(" ",s(32,35,o.deduplicationStrategiesHintTranslations.get(o.getTelemetryFromDatabaseConfigForm.get("fetchMode").value))," "),r(2),p("ngIf",o.getTelemetryFromDatabaseConfigForm.get("fetchMode").value===o.fetchMode.ALL)}},dependencies:[z,k,ni,It,X,R,q,B,se,Q,oe,ee,W,Z,de,O,fe,S,x,A,ve,ot,_,E,Vt,D,Qe,Je,ge,Te,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .see-example[_ngcontent-%COMP%]{display:inline-block}[_nghost-%COMP%]   .description-block[_ngcontent-%COMP%]{display:flex;align-items:center;border-radius:6px;border:1px solid #EAEAEA}[_nghost-%COMP%]   .description-block[_ngcontent-%COMP%]   .description-icon[_ngcontent-%COMP%]{font-size:24px;height:24px;min-height:24px;width:24px;min-width:24px;line-height:24px;color:#d9d9d9;margin:4px}[_nghost-%COMP%]   .description-block[_ngcontent-%COMP%]   .description-text[_ngcontent-%COMP%]{font-size:12px;line-height:16px;letter-spacing:.25px;margin:6px}[_nghost-%COMP%]   .description-block.error[_ngcontent-%COMP%]{color:var(--mdc-theme-error, #f44336)}[_nghost-%COMP%]   .description-block.error[_ngcontent-%COMP%]   .description-icon[_ngcontent-%COMP%]{color:var(--mdc-theme-error, #f44336)}[_nghost-%COMP%]   .item-center[_ngcontent-%COMP%]{align-items:center}[_nghost-%COMP%]   .item-center[_ngcontent-%COMP%]   .fetch-mod-toggle[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .hint-container[_ngcontent-%COMP%]{width:100%}']})}}return t})();b();function ru(t,d){if(t&1&&(a(0,"tb-toggle-option",9),l(1),n()),t&2){let e=d.$implicit;p("value",e.value),r(),c(" ",e.name," ")}}var qr=(()=>{class t extends N{constructor(e,i){super(),this.fb=e,this.translate=i,this.DataToFetch=Me,this.msgMetadataLabelTranslations=fa,this.originatorFields=[],this.fetchToData=[];for(let o of Object.keys(Ai))this.originatorFields.push({value:Ai[o].value,name:this.translate.instant(Ai[o].name)});for(let o of wt.keys())this.fetchToData.push({value:o,name:this.translate.instant(wt.get(o))})}configForm(){return this.relatedAttributesConfigForm}prepareOutputConfig(e){e.dataToFetch===Me.FIELDS?(e.dataMapping=e.svMap,delete e.svMap):(e.dataMapping=e.kvMap,delete e.kvMap);let i={};if(e&&e.dataMapping)for(let o of Object.keys(e.dataMapping))i[o.trim()]=e.dataMapping[o];return e.dataMapping=i,delete e.svMap,delete e.kvMap,Dt(e)}prepareInputConfig(e){let i={[et.name.value]:`relatedEntity${this.translate.instant(et.name.name)}`},o={serialNumber:"sn"},C;F(e?.telemetry)?C=e.telemetry?Me.LATEST_TELEMETRY:Me.ATTRIBUTES:C=F(e?.dataToFetch)?e.dataToFetch:Me.ATTRIBUTES;let H;return F(e?.attrMapping)?H=e.attrMapping:H=F(e?.dataMapping)?e.dataMapping:null,C===Me.FIELDS?i=H:o=H,{relationsQuery:F(e?.relationsQuery)?e.relationsQuery:null,dataToFetch:C,svMap:i,kvMap:o,fetchTo:F(e?.fetchTo)?e.fetchTo:ye.METADATA}}selectTranslation(e,i){return this.relatedAttributesConfigForm.get("dataToFetch").value===Me.LATEST_TELEMETRY?e:i}onConfigurationSet(e){this.relatedAttributesConfigForm=this.fb.group({relationsQuery:[e.relationsQuery,[u.required]],dataToFetch:[e.dataToFetch,[]],kvMap:[e.kvMap,[u.required]],svMap:[e.svMap,[u.required]],fetchTo:[e.fetchTo,[]]})}validatorTriggers(){return["dataToFetch"]}updateValidators(e){this.relatedAttributesConfigForm.get("dataToFetch").value===Me.FIELDS?(this.relatedAttributesConfigForm.get("svMap").enable({emitEvent:!1}),this.relatedAttributesConfigForm.get("kvMap").disable({emitEvent:!1}),this.relatedAttributesConfigForm.get("svMap").updateValueAndValidity()):(this.relatedAttributesConfigForm.get("svMap").disable({emitEvent:!1}),this.relatedAttributesConfigForm.get("kvMap").enable({emitEvent:!1}),this.relatedAttributesConfigForm.get("kvMap").updateValueAndValidity())}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-related-attributes-config"]],features:[M],decls:24,vars:48,consts:[[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],["required","","formControlName","relationsQuery"],[1,"tb-form-panel","stroked"],["translate","",1,"tb-form-panel-title"],["formControlName","dataToFetch","appearance","fill"],[3,"value",4,"ngFor","ngForOf"],["required","","formControlName","kvMap","popupHelpLink","rulenode/related_entity_data_node_fields_templatization",3,"hidden","requiredText","labelText","keyText","keyRequiredText","valText","valRequiredText","hintText"],["required","","targetKeyPrefix","relatedEntity","formControlName","svMap","popupHelpLink","rulenode/related_entity_data_node_fields_templatization",3,"hidden","labelText","selectOptions","requiredText","selectText","selectRequiredText","valText","valRequiredText","hintText"],["formControlName","fetchTo",3,"labelText"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0),f(1,"tb-relations-query-config",1),a(2,"div",2)(3,"div",3),l(4,"rule-node-config.data-to-fetch"),n(),a(5,"tb-toggle-select",4),g(6,ru,2,2,"tb-toggle-option",5),n(),f(7,"tb-kv-map-config",6),m(8,"translate"),m(9,"translate"),m(10,"translate"),m(11,"translate"),m(12,"translate"),m(13,"translate"),f(14,"tb-sv-map-config",7),m(15,"translate"),m(16,"translate"),m(17,"translate"),m(18,"translate"),m(19,"translate"),m(20,"translate"),m(21,"translate"),f(22,"tb-msg-metadata-chip",8),m(23,"translate"),n()()),i&2&&(p("formGroup",o.relatedAttributesConfigForm),r(6),p("ngForOf",o.fetchToData),r(),p("hidden",o.relatedAttributesConfigForm.get("dataToFetch").value===o.DataToFetch.FIELDS)("requiredText",s(8,20,"rule-node-config.attr-mapping-required"))("labelText",s(9,22,o.selectTranslation("rule-node-config.latest-telemetry-mapping","rule-node-config.attributes-mapping")))("keyText",s(10,24,o.selectTranslation("rule-node-config.source-telemetry","rule-node-config.source-attribute")))("keyRequiredText",s(11,26,o.selectTranslation("rule-node-config.source-telemetry-required","rule-node-config.source-attribute-required")))("valText",s(12,28,"rule-node-config.target-key"))("valRequiredText",s(13,30,"rule-node-config.target-key-required"))("hintText","rule-node-config.kv-map-pattern-hint"),r(7),p("hidden",o.relatedAttributesConfigForm.get("dataToFetch").value!==o.DataToFetch.FIELDS)("labelText",s(15,32,"rule-node-config.fields-mapping"))("selectOptions",o.originatorFields)("requiredText",s(16,34,"rule-node-config.attr-mapping-required"))("selectText",s(17,36,"rule-node-config.source-field"))("selectRequiredText",s(18,38,"rule-node-config.source-field-required"))("valText",s(19,40,"rule-node-config.target-key"))("valRequiredText",s(20,42,"rule-node-config.target-key-required"))("hintText",s(21,44,"rule-node-config.sv-map-hint")),r(8),p("labelText",s(23,46,o.msgMetadataLabelTranslations.get(o.relatedAttributesConfigForm.get("dataToFetch").value))))},dependencies:[z,S,x,A,_,E,D,Qe,Je,lt,fi,Le,At,I],encapsulation:2})}}return t})();b();function ou(t,d){if(t&1&&(a(0,"tb-toggle-option",8),l(1),n()),t&2){let e=d.$implicit;p("value",e.value),r(),c(" ",e.name," ")}}var kr=(()=>{class t extends N{constructor(e,i){super(),this.fb=e,this.translate=i,this.fetchToData=[],this.DataToFetch=Me;for(let o of wt.keys())o!==Me.FIELDS&&this.fetchToData.push({value:o,name:this.translate.instant(wt.get(o))})}configForm(){return this.tenantAttributesConfigForm}prepareInputConfig(e){let i;F(e?.telemetry)?i=e.telemetry?Me.LATEST_TELEMETRY:Me.ATTRIBUTES:i=F(e?.dataToFetch)?e.dataToFetch:Me.ATTRIBUTES;let o;return F(e?.attrMapping)?o=e.attrMapping:o=F(e?.dataMapping)?e.dataMapping:null,{dataToFetch:i,dataMapping:o,fetchTo:F(e?.fetchTo)?e.fetchTo:ye.METADATA}}selectTranslation(e,i){return this.tenantAttributesConfigForm.get("dataToFetch").value===Me.LATEST_TELEMETRY?e:i}onConfigurationSet(e){this.tenantAttributesConfigForm=this.fb.group({dataToFetch:[e.dataToFetch,[]],dataMapping:[e.dataMapping,[u.required]],fetchTo:[e.fetchTo,[]]})}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-tenant-attributes-config"]],features:[M],decls:17,vars:26,consts:[[1,"tb-form-panel","stroked",3,"formGroup"],["translate","",1,"tb-form-panel-title"],[1,"flex","flex-1","items-center","justify-center"],[1,"fetch-to-data-toggle"],["formControlName","dataToFetch","appearance","fill",1,"fetch-to-data-toggle"],[3,"value",4,"ngFor","ngForOf"],["required","","formControlName","dataMapping","popupHelpLink","rulenode/tenant_attributes_node_fields_templatization",3,"requiredText","labelText","keyText","keyRequiredText","valText","valRequiredText","hintText"],["formControlName","fetchTo",3,"labelText"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),l(2,"rule-node-config.mapping-of-tenant"),n(),a(3,"div",2)(4,"div",3)(5,"tb-toggle-select",4),g(6,ou,2,2,"tb-toggle-option",5),n()()(),f(7,"tb-kv-map-config",6),m(8,"translate"),m(9,"translate"),m(10,"translate"),m(11,"translate"),m(12,"translate"),m(13,"translate"),f(14,"tb-msg-metadata-chip",7),m(15,"translate"),m(16,"translate"),n()),i&2&&(p("formGroup",o.tenantAttributesConfigForm),r(6),p("ngForOf",o.fetchToData),r(),p("requiredText",s(8,10,"rule-node-config.attr-mapping-required"))("labelText",s(9,12,o.selectTranslation("rule-node-config.latest-telemetry-mapping","rule-node-config.attributes-mapping")))("keyText",s(10,14,o.selectTranslation("rule-node-config.source-telemetry","rule-node-config.source-attribute")))("keyRequiredText",s(11,16,o.selectTranslation("rule-node-config.source-telemetry-required","rule-node-config.source-attribute-required")))("valText",s(12,18,"rule-node-config.target-key"))("valRequiredText",s(13,20,"rule-node-config.target-key-required"))("hintText","rule-node-config.kv-map-pattern-hint"),r(7),p("labelText",o.tenantAttributesConfigForm.get("dataToFetch").value===o.DataToFetch.LATEST_TELEMETRY?s(15,22,"rule-node-config.add-mapped-latest-telemetry-to"):s(16,24,"rule-node-config.add-mapped-attribute-to")))},dependencies:[z,S,x,A,_,E,D,Qe,Je,lt,Le,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .fetch-to-data-toggle[_ngcontent-%COMP%]{max-width:420px;width:100%}']})}}return t})();b();var Ha=t=>({inputValueKey:t}),au=t=>({periodValueKey:t}),lu=(t,d)=>({outputValueKey:t,periodValueKey:d}),pu=t=>({outputValueKey:t});function mu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.input-value-key-required")," "))}function su(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.output-value-key-required")," "))}function du(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.number-of-digits-after-floating-point-range")," "))}function uu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.number-of-digits-after-floating-point-range")," "))}function cu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.period-value-key-required")," "))}function fu(t,d){if(t&1&&(a(0,"mat-form-field",16)(1,"mat-label"),l(2),m(3,"translate"),n(),f(4,"input",17),g(5,cu,3,3,"mat-error",4),n()),t&2){let e=v();r(2),V(s(3,2,"rule-node-config.period-value-key")),r(3),p("ngIf",e.calculateDeltaConfigForm.get("periodValueKey").hasError("required"))}}var Br=(()=>{class t extends N{constructor(e,i){super(),this.translate=e,this.fb=i,this.separatorKeysCodes=[13,188,186]}configForm(){return this.calculateDeltaConfigForm}onConfigurationSet(e){this.calculateDeltaConfigForm=this.fb.group({inputValueKey:[e.inputValueKey,[u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)]],outputValueKey:[e.outputValueKey,[u.required,u.pattern(/(?:.|\s)*\S(&:.|\s)*/)]],useCache:[e.useCache,[]],addPeriodBetweenMsgs:[e.addPeriodBetweenMsgs,[]],periodValueKey:[e.periodValueKey,[]],round:[e.round,[u.min(0),u.max(15)]],tellFailureIfDeltaIsNegative:[e.tellFailureIfDeltaIsNegative,[]],excludeZeroDeltas:[e.excludeZeroDeltas,[]]})}prepareInputConfig(e){return{inputValueKey:F(e?.inputValueKey)?e.inputValueKey:null,outputValueKey:F(e?.outputValueKey)?e.outputValueKey:null,useCache:F(e?.useCache)?e.useCache:!0,addPeriodBetweenMsgs:F(e?.addPeriodBetweenMsgs)?e.addPeriodBetweenMsgs:!1,periodValueKey:F(e?.periodValueKey)?e.periodValueKey:null,round:F(e?.round)?e.round:null,tellFailureIfDeltaIsNegative:F(e?.tellFailureIfDeltaIsNegative)?e.tellFailureIfDeltaIsNegative:!0,excludeZeroDeltas:F(e?.excludeZeroDeltas)?e.excludeZeroDeltas:!1}}prepareOutputConfig(e){return Dt(e)}updateValidators(e){this.calculateDeltaConfigForm.get("addPeriodBetweenMsgs").value?this.calculateDeltaConfigForm.get("periodValueKey").setValidators([u.required]):this.calculateDeltaConfigForm.get("periodValueKey").setValidators([]),this.calculateDeltaConfigForm.get("periodValueKey").updateValueAndValidity({emitEvent:e})}validatorTriggers(){return["addPeriodBetweenMsgs"]}static{this.\u0275fac=function(i){return new(i||t)(y(le),y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-calculate-delta-config"]],features:[M],decls:50,vars:69,consts:[[3,"formGroup"],[1,"gt-sm:flex","gt-sm:flex-row","gt-sm:gap-5.5"],[1,"mat-block","flex-1"],["matInput","","formControlName","inputValueKey"],[4,"ngIf"],["matInput","","formControlName","outputValueKey"],["type","number","min","0","max","15","step","1","matInput","","formControlName","round"],[1,"tb-form-panel","no-padding","no-border"],[1,"tb-form-row","same-padding",3,"tb-hint-tooltip-icon"],["formControlName","tellFailureIfDeltaIsNegative",1,"mat-slide","margin"],["formControlName","useCache",1,"mat-slide","margin"],[1,"tb-form-panel","stroked"],[1,"tb-form-row","no-border","no-padding",3,"tb-hint-tooltip-icon"],["formControlName","addPeriodBetweenMsgs",1,"mat-slide"],["class","mat-block",4,"ngIf"],["formControlName","excludeZeroDeltas",1,"mat-slide","margin"],[1,"mat-block"],["required","","matInput","","formControlName","periodValueKey"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),l(4),m(5,"translate"),n(),f(6,"input",3),g(7,mu,3,3,"mat-error",4),n(),a(8,"mat-form-field",2)(9,"mat-label"),l(10),m(11,"translate"),n(),f(12,"input",5),g(13,su,3,3,"mat-error",4),n()(),a(14,"mat-form-field",2)(15,"mat-label"),l(16),m(17,"translate"),n(),f(18,"input",6),g(19,du,3,3,"mat-error",4)(20,uu,3,3,"mat-error",4),n(),a(21,"div",7)(22,"div",8),m(23,"translate"),a(24,"mat-slide-toggle",9),l(25),m(26,"translate"),n()(),a(27,"div",8),m(28,"translate"),m(29,"translate"),a(30,"mat-slide-toggle",10),l(31),m(32,"translate"),n()(),a(33,"div",11)(34,"div",12),m(35,"translate"),a(36,"mat-slide-toggle",13),l(37),m(38,"translate"),m(39,"translate"),n()(),g(40,fu,6,4,"mat-form-field",14),n(),a(41,"div",8),m(42,"translate"),m(43,"translate"),m(44,"translate"),m(45,"translate"),m(46,"translate"),a(47,"mat-slide-toggle",15),l(48),m(49,"translate"),n()()()()),i&2&&(p("formGroup",o.calculateDeltaConfigForm),r(4),V(s(5,19,"rule-node-config.input-value-key")),r(3),p("ngIf",o.calculateDeltaConfigForm.get("inputValueKey").hasError("required")||o.calculateDeltaConfigForm.get("inputValueKey").hasError("pattern")),r(3),V(s(11,21,"rule-node-config.output-value-key")),r(3),p("ngIf",o.calculateDeltaConfigForm.get("outputValueKey").hasError("required")||o.calculateDeltaConfigForm.get("outputValueKey").hasError("pattern")),r(3),V(s(17,23,"rule-node-config.number-of-digits-after-floating-point")),r(3),p("ngIf",o.calculateDeltaConfigForm.get("round").hasError("min")),r(),p("ngIf",o.calculateDeltaConfigForm.get("round").hasError("max")),r(2),h("tb-hint-tooltip-icon",s(23,25,"rule-node-config.failure-if-delta-negative-tooltip")),r(3),c(" ",s(26,27,"rule-node-config.failure-if-delta-negative")," "),r(2),h("tb-hint-tooltip-icon",ae(29,31,"rule-node-config.use-caching-tooltip",Fe(58,Ha,o.calculateDeltaConfigForm.get("inputValueKey").valid?o.calculateDeltaConfigForm.get("inputValueKey").value:s(28,29,"rule-node-config.input-value-key")))),r(4),c(" ",s(32,34,"rule-node-config.use-caching")," "),r(2),He("no-padding-bottom",o.calculateDeltaConfigForm.get("addPeriodBetweenMsgs").value),r(),h("tb-hint-tooltip-icon",ae(35,36,"rule-node-config.add-time-difference-between-readings-tooltip",Fe(60,au,o.calculateDeltaConfigForm.get("periodValueKey").valid&&o.calculateDeltaConfigForm.get("addPeriodBetweenMsgs").value?o.calculateDeltaConfigForm.get("periodValueKey").value:"periodInMs"))),r(3),c(" ",ae(39,41,"rule-node-config.add-time-difference-between-readings",Fe(62,Ha,o.calculateDeltaConfigForm.get("inputValueKey").valid?o.calculateDeltaConfigForm.get("inputValueKey").value:s(38,39,"rule-node-config.input-value-key")))," "),r(3),p("ngIf",o.calculateDeltaConfigForm.get("addPeriodBetweenMsgs").value),r(),h("tb-hint-tooltip-icon",o.calculateDeltaConfigForm.get("addPeriodBetweenMsgs").value?ae(44,48,"rule-node-config.exclude-zero-deltas-time-difference-hint",Yt(64,lu,o.calculateDeltaConfigForm.get("outputValueKey").valid?o.calculateDeltaConfigForm.get("outputValueKey").value:s(42,44,"rule-node-config.output-value-key"),o.calculateDeltaConfigForm.get("periodValueKey").valid?o.calculateDeltaConfigForm.get("periodValueKey").value:s(43,46,"rule-node-config.period-value-key"))):ae(46,53,"rule-node-config.exclude-zero-deltas-hint",Fe(67,pu,o.calculateDeltaConfigForm.get("outputValueKey").valid?o.calculateDeltaConfigForm.get("outputValueKey").value:s(45,51,"rule-node-config.output-value-key")))),r(7),c(" ",s(49,56,"rule-node-config.exclude-zero-deltas")," "))},dependencies:[k,R,q,B,Q,de,O,fe,S,x,A,ve,ot,_,E,ge,I],encapsulation:2})}}return t})();b();var Or=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.fetchDeviceCredentialsConfigForm}prepareInputConfig(e){return{fetchTo:F(e?.fetchTo)?e.fetchTo:ye.METADATA}}onConfigurationSet(e){this.fetchDeviceCredentialsConfigForm=this.fb.group({fetchTo:[e.fetchTo,[]]})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-enrichment-node-fetch-device-credentials-config"]],features:[M],decls:3,vars:4,consts:[[3,"formGroup"],["formControlName","fetchTo",3,"labelText"]],template:function(i,o){i&1&&(a(0,"section",0),f(1,"tb-msg-metadata-chip",1),m(2,"translate"),n()),i&2&&(p("formGroup",o.fetchDeviceCredentialsConfigForm),r(),p("labelText",s(2,2,"rule-node-config.fetch-credentials-to")))},dependencies:[S,x,_,E,Le,I],encapsulation:2})}}return t})();var En=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=We({type:t})}static{this.\u0275inj=Ye({imports:[ke,Be,ft]})}}return t})();(function(){Ze(En,{declarations:[Er,Mr,Nr,Ar,Dr,Vr,qr,kr,Br,Or],imports:[ke,Be,ft],exports:[Er,Mr,Nr,Ar,Dr,Vr,qr,kr,Br,Or]})})();b();b();function gu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.topic-arn-pattern-required")," "))}function Cu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.aws-access-key-id-required")," "))}function yu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.aws-secret-access-key-required")," "))}function vu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.aws-region-required")," "))}var Rr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.snsConfigForm}onConfigurationSet(e){this.snsConfigForm=this.fb.group({topicArnPattern:[e?e.topicArnPattern:null,[u.required]],accessKeyId:[e?e.accessKeyId:null,[u.required]],secretAccessKey:[e?e.secretAccessKey:null,[u.required]],region:[e?e.region:null,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-sns-config"]],features:[M],decls:23,vars:5,consts:[[1,"flex","flex-col",3,"formGroup"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","topicArnPattern"],[4,"ngIf"],[1,"mat-block"],["required","","matInput","","formControlName","accessKeyId"],["required","","matInput","","formControlName","secretAccessKey"],["required","","matInput","","formControlName","region"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.topic-arn-pattern"),n(),f(4,"input",3),g(5,gu,3,3,"mat-error",4),a(6,"mat-hint",2),l(7,"rule-node-config.general-pattern-hint"),n()(),a(8,"mat-form-field",5)(9,"mat-label",2),l(10,"rule-node-config.aws-access-key-id"),n(),f(11,"input",6),g(12,Cu,3,3,"mat-error",4),n(),a(13,"mat-form-field",5)(14,"mat-label",2),l(15,"rule-node-config.aws-secret-access-key"),n(),f(16,"input",7),g(17,yu,3,3,"mat-error",4),n(),a(18,"mat-form-field",5)(19,"mat-label",2),l(20,"rule-node-config.aws-region"),n(),f(21,"input",8),g(22,vu,3,3,"mat-error",4),n()()),i&2&&(p("formGroup",o.snsConfigForm),r(5),p("ngIf",o.snsConfigForm.get("topicArnPattern").hasError("required")),r(7),p("ngIf",o.snsConfigForm.get("accessKeyId").hasError("required")),r(5),p("ngIf",o.snsConfigForm.get("secretAccessKey").hasError("required")),r(5),p("ngIf",o.snsConfigForm.get("region").hasError("required")))},dependencies:[k,R,q,B,se,Q,O,S,x,A,_,E,D,I],encapsulation:2})}}return t})();b();function hu(t,d){if(t&1&&(a(0,"mat-option",15),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.sqsQueueTypeTranslationsMap.get(e))," ")}}function bu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.queue-url-pattern-required")," "))}function Tu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-delay-seconds-message")," "))}function xu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-delay-seconds-message")," "))}function _u(t,d){if(t&1&&(a(0,"mat-form-field",1)(1,"mat-label",2),l(2,"rule-node-config.delay-seconds"),n(),f(3,"input",16),g(4,Tu,3,3,"mat-error",7)(5,xu,3,3,"mat-error",7),n()),t&2){let e=v();r(4),p("ngIf",e.sqsConfigForm.get("delaySeconds").hasError("min")),r(),p("ngIf",e.sqsConfigForm.get("delaySeconds").hasError("max"))}}function Su(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.aws-access-key-id-required")," "))}function Fu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.aws-secret-access-key-required")," "))}function Iu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.aws-region-required")," "))}var Lr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.sqsQueueType=Ni,this.sqsQueueTypes=Object.keys(Ni),this.sqsQueueTypeTranslationsMap=Ca}configForm(){return this.sqsConfigForm}onConfigurationSet(e){this.sqsConfigForm=this.fb.group({queueType:[e?e.queueType:null,[u.required]],queueUrlPattern:[e?e.queueUrlPattern:null,[u.required]],delaySeconds:[e?e.delaySeconds:null,[u.min(0),u.max(900)]],messageAttributes:[e?e.messageAttributes:null,[]],accessKeyId:[e?e.accessKeyId:null,[u.required]],secretAccessKey:[e?e.secretAccessKey:null,[u.required]],region:[e?e.region:null,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-sqs-config"]],features:[M],decls:35,vars:13,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"mat-block"],["translate",""],["formControlName","queueType","required",""],[3,"value",4,"ngFor","ngForOf"],["subscriptSizing","dynamic",1,"mat-block"],["required","","matInput","","formControlName","queueUrlPattern"],[4,"ngIf"],["class","mat-block",4,"ngIf"],["translate","",1,"tb-title"],[1,"tb-hint",3,"innerHTML"],["required","false","formControlName","messageAttributes","keyText","rule-node-config.name","keyRequiredText","rule-node-config.name-required","valText","rule-node-config.value","valRequiredText","rule-node-config.value-required"],["required","","matInput","","formControlName","accessKeyId"],["required","","matInput","","formControlName","secretAccessKey"],["required","","matInput","","formControlName","region"],[3,"value"],["required","","type","number","min","0","max","900","step","1","matInput","","formControlName","delaySeconds"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.queue-type"),n(),a(4,"mat-select",3),g(5,hu,3,4,"mat-option",4),n()(),a(6,"mat-form-field",5)(7,"mat-label",2),l(8,"rule-node-config.queue-url-pattern"),n(),f(9,"input",6),g(10,bu,3,3,"mat-error",7),a(11,"mat-hint",2),l(12,"rule-node-config.general-pattern-hint"),n()(),g(13,_u,6,2,"mat-form-field",8),a(14,"label",9),l(15,"rule-node-config.message-attributes"),n(),f(16,"div",10),m(17,"translate"),m(18,"safe"),f(19,"tb-kv-map-config-old",11),a(20,"mat-form-field",1)(21,"mat-label",2),l(22,"rule-node-config.aws-access-key-id"),n(),f(23,"input",12),g(24,Su,3,3,"mat-error",7),n(),a(25,"mat-form-field",1)(26,"mat-label",2),l(27,"rule-node-config.aws-secret-access-key"),n(),f(28,"input",13),g(29,Fu,3,3,"mat-error",7),n(),a(30,"mat-form-field",1)(31,"mat-label",2),l(32,"rule-node-config.aws-region"),n(),f(33,"input",14),g(34,Iu,3,3,"mat-error",7),n()()),i&2&&(p("formGroup",o.sqsConfigForm),r(5),p("ngForOf",o.sqsQueueTypes),r(5),p("ngIf",o.sqsConfigForm.get("queueUrlPattern").hasError("required")),r(3),p("ngIf",o.sqsConfigForm.get("queueType").value===o.sqsQueueType.STANDARD),r(3),p("innerHTML",ae(18,10,s(17,8,"rule-node-config.message-attributes-hint"),"html"),Pe),r(8),p("ngIf",o.sqsConfigForm.get("accessKeyId").hasError("required")),r(5),p("ngIf",o.sqsConfigForm.get("secretAccessKey").hasError("required")),r(5),p("ngIf",o.sqsConfigForm.get("region").hasError("required")))},dependencies:[z,k,R,q,B,se,Q,ee,W,O,fe,S,x,A,ve,ot,_,E,D,Ft,pt,I],encapsulation:2})}}return t})();b();function Eu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.gcp-project-id-required")," "))}function Mu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.pubsub-topic-name-required")," "))}var Pr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.pubSubConfigForm}onConfigurationSet(e){this.pubSubConfigForm=this.fb.group({projectId:[e?e.projectId:null,[u.required]],topicName:[e?e.topicName:null,[u.required]],serviceAccountKey:[e?e.serviceAccountKey:null,[u.required]],serviceAccountKeyFileName:[e?e.serviceAccountKeyFileName:null,[u.required]],messageAttributes:[e?e.messageAttributes:null,[]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-pub-sub-config"]],features:[M],decls:20,vars:16,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"mat-block"],["translate",""],["required","","matInput","","formControlName","projectId"],[4,"ngIf"],["required","","matInput","","formControlName","topicName"],["formControlName","serviceAccountKey","required","","requiredAsError","","noFileText","rule-node-config.no-file",2,"padding-bottom","24px",3,"fileNameChanged","existingFileName","label","dropLabel"],["translate","",1,"tb-title"],[1,"tb-hint",3,"innerHTML"],["required","false","formControlName","messageAttributes","keyText","rule-node-config.name","keyRequiredText","rule-node-config.name-required","valText","rule-node-config.value","valRequiredText","rule-node-config.value-required"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.gcp-project-id"),n(),f(4,"input",3),g(5,Eu,3,3,"mat-error",4),n(),a(6,"mat-form-field",1)(7,"mat-label",2),l(8,"rule-node-config.pubsub-topic-name"),n(),f(9,"input",5),g(10,Mu,3,3,"mat-error",4),n(),a(11,"tb-file-input",6),m(12,"translate"),m(13,"translate"),$("fileNameChanged",function(H){return o.pubSubConfigForm.get("serviceAccountKeyFileName").setValue(H)}),n(),a(14,"label",7),l(15,"rule-node-config.message-attributes"),n(),f(16,"div",8),m(17,"translate"),m(18,"safe"),f(19,"tb-kv-map-config-old",9),n()),i&2&&(p("formGroup",o.pubSubConfigForm),r(5),p("ngIf",o.pubSubConfigForm.get("projectId").hasError("required")),r(5),p("ngIf",o.pubSubConfigForm.get("topicName").hasError("required")),r(),h("label",s(12,7,"rule-node-config.gcp-service-account-key")),h("dropLabel",s(13,9,"rule-node-config.drop-file")),p("existingFileName",o.pubSubConfigForm.get("serviceAccountKeyFileName").value),r(5),p("innerHTML",ae(18,13,s(17,11,"rule-node-config.message-attributes-hint"),"html"),Pe))},dependencies:[k,R,q,B,Q,O,S,x,A,_,E,Ii,D,Ft,pt,I],encapsulation:2})}}return t})();b();function Nu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.topic-pattern-required")," "))}function Au(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.bootstrap-servers-required")," "))}function Du(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-retries-message")," "))}function Vu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-batch-size-bytes-message")," "))}function qu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-linger-ms-message")," "))}function ku(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-buffer-memory-bytes-message")," "))}function Bu(t,d){if(t&1&&(a(0,"mat-option",19),l(1),n()),t&2){let e=d.$implicit;p("value",e),r(),c(" ",e," ")}}function Ou(t,d){if(t&1&&(a(0,"mat-option",19),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v(2);p("value",e),r(),c(" ",s(2,2,i.ToByteStandartCharsetTypeTranslationMap.get(e))," ")}}function Ru(t,d){if(t&1&&(a(0,"mat-form-field",20)(1,"mat-label",2),l(2,"rule-node-config.charset-encoding"),n(),a(3,"mat-select",21),g(4,Ou,3,4,"mat-option",14),n()()),t&2){let e=v();r(4),p("ngForOf",e.ToByteStandartCharsetTypesValues)}}var wr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.ackValues=["all","-1","0","1"],this.ToByteStandartCharsetTypesValues=Ta,this.ToByteStandartCharsetTypeTranslationMap=xa}configForm(){return this.kafkaConfigForm}onConfigurationSet(e){this.kafkaConfigForm=this.fb.group({topicPattern:[e?e.topicPattern:null,[u.required]],keyPattern:[e?e.keyPattern:null],bootstrapServers:[e?e.bootstrapServers:null,[u.required]],retries:[e?e.retries:null,[u.min(0)]],batchSize:[e?e.batchSize:null,[u.min(0)]],linger:[e?e.linger:null,[u.min(0)]],bufferMemory:[e?e.bufferMemory:null,[u.min(0)]],acks:[e?e.acks:null,[u.required]],otherProperties:[e?e.otherProperties:null,[]],addMetadataKeyValuesAsKafkaHeaders:[e?e.addMetadataKeyValuesAsKafkaHeaders:!1,[]],kafkaHeadersCharset:[e?e.kafkaHeadersCharset:null,[]]})}validatorTriggers(){return["addMetadataKeyValuesAsKafkaHeaders"]}updateValidators(e){this.kafkaConfigForm.get("addMetadataKeyValuesAsKafkaHeaders").value?this.kafkaConfigForm.get("kafkaHeadersCharset").setValidators([u.required]):this.kafkaConfigForm.get("kafkaHeadersCharset").setValidators([]),this.kafkaConfigForm.get("kafkaHeadersCharset").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-kafka-config"]],features:[M],decls:55,vars:12,consts:[[1,"flex","flex-col",3,"formGroup"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","topicPattern"],[4,"ngIf"],["matInput","","formControlName","keyPattern"],["translate","",1,"tb-hint"],[1,"mat-block"],["required","","matInput","","formControlName","bootstrapServers"],["type","number","step","1","min","0","matInput","","formControlName","retries"],["type","number","step","1","min","0","matInput","","formControlName","batchSize"],["type","number","step","1","min","0","matInput","","formControlName","linger"],["type","number","step","1","min","0","matInput","","formControlName","bufferMemory"],["formControlName","acks","required",""],[3,"value",4,"ngFor","ngForOf"],["translate","",1,"tb-title"],["required","false","formControlName","otherProperties","keyText","rule-node-config.key","keyRequiredText","rule-node-config.key-required","valText","rule-node-config.value","valRequiredText","rule-node-config.value-required"],["formControlName","addMetadataKeyValuesAsKafkaHeaders",1,"flex-1"],["class","mat-block flex-1",4,"ngIf"],[3,"value"],[1,"mat-block","flex-1"],["formControlName","kafkaHeadersCharset","required",""]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.topic-pattern"),n(),f(4,"input",3),g(5,Nu,3,3,"mat-error",4),a(6,"mat-hint",2),l(7,"rule-node-config.general-pattern-hint"),n()(),a(8,"mat-form-field",1)(9,"mat-label",2),l(10,"rule-node-config.key-pattern"),n(),f(11,"input",5),a(12,"mat-hint",2),l(13,"rule-node-config.general-pattern-hint"),n()(),a(14,"div",6),l(15,"rule-node-config.key-pattern-hint"),n(),a(16,"mat-form-field",7)(17,"mat-label",2),l(18,"rule-node-config.bootstrap-servers"),n(),f(19,"input",8),g(20,Au,3,3,"mat-error",4),n(),a(21,"mat-form-field",7)(22,"mat-label",2),l(23,"rule-node-config.retries"),n(),f(24,"input",9),g(25,Du,3,3,"mat-error",4),n(),a(26,"mat-form-field",7)(27,"mat-label",2),l(28,"rule-node-config.batch-size-bytes"),n(),f(29,"input",10),g(30,Vu,3,3,"mat-error",4),n(),a(31,"mat-form-field",7)(32,"mat-label",2),l(33,"rule-node-config.linger-ms"),n(),f(34,"input",11),g(35,qu,3,3,"mat-error",4),n(),a(36,"mat-form-field",7)(37,"mat-label",2),l(38,"rule-node-config.buffer-memory-bytes"),n(),f(39,"input",12),g(40,ku,3,3,"mat-error",4),n(),a(41,"mat-form-field",7)(42,"mat-label",2),l(43,"rule-node-config.acks"),n(),a(44,"mat-select",13),g(45,Bu,2,2,"mat-option",14),n()(),a(46,"label",15),l(47,"rule-node-config.other-properties"),n(),f(48,"tb-kv-map-config-old",16),a(49,"mat-checkbox",17),l(50),m(51,"translate"),n(),a(52,"div",6),l(53,"rule-node-config.add-metadata-key-values-as-kafka-headers-hint"),n(),g(54,Ru,5,1,"mat-form-field",18),n()),i&2&&(p("formGroup",o.kafkaConfigForm),r(5),p("ngIf",o.kafkaConfigForm.get("topicPattern").hasError("required")),r(15),p("ngIf",o.kafkaConfigForm.get("bootstrapServers").hasError("required")),r(5),p("ngIf",o.kafkaConfigForm.get("retries").hasError("min")),r(5),p("ngIf",o.kafkaConfigForm.get("batchSize").hasError("min")),r(5),p("ngIf",o.kafkaConfigForm.get("linger").hasError("min")),r(5),p("ngIf",o.kafkaConfigForm.get("bufferMemory").hasError("min")),r(5),p("ngForOf",o.ackValues),r(5),c(" ",s(51,10,"rule-node-config.add-metadata-key-values-as-kafka-headers")," "),r(4),p("ngIf",o.kafkaConfigForm.get("addMetadataKeyValuesAsKafkaHeaders").value))},dependencies:[z,k,Ge,R,q,B,se,Q,ee,W,O,fe,S,x,A,ve,_,E,D,Ft,I],encapsulation:2})}}return t})();b();function Lu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.topic-pattern-required")," "))}function Pu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.host-required")," "))}function wu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.port-required")," "))}function Gu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.port-range")," "))}function ju(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.port-range")," "))}function Uu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.connect-timeout-required")," "))}function Ku(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.connect-timeout-range")," "))}function Hu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.connect-timeout-range")," "))}var Gr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.mqttConfigForm}onConfigurationSet(e){this.mqttConfigForm=this.fb.group({topicPattern:[e?e.topicPattern:null,[u.required]],host:[e?e.host:null,[u.required]],port:[e?e.port:null,[u.required,u.min(1),u.max(65535)]],connectTimeoutSec:[e?e.connectTimeoutSec:null,[u.required,u.min(1),u.max(200)]],clientId:[e?e.clientId:null,[]],appendClientIdSuffix:[{value:e?e.appendClientIdSuffix:!1,disabled:!(e&&qn(e.clientId))},[]],parseToPlainText:[e?e.parseToPlainText:!1,[]],cleanSession:[e?e.cleanSession:!1,[]],retainedMessage:[e?e.retainedMessage:!1,[]],ssl:[e?e.ssl:!1,[]],credentials:[e?e.credentials:null,[]]})}updateValidators(e){qn(this.mqttConfigForm.get("clientId").value)?this.mqttConfigForm.get("appendClientIdSuffix").enable({emitEvent:!1}):this.mqttConfigForm.get("appendClientIdSuffix").disable({emitEvent:!1}),this.mqttConfigForm.get("appendClientIdSuffix").updateValueAndValidity({emitEvent:e})}validatorTriggers(){return["clientId"]}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-mqtt-config"]],features:[M],decls:57,vars:34,consts:[[1,"flex","flex-col",3,"formGroup"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","topicPattern"],[4,"ngIf"],[1,"flex","flex-1","flex-col","gt-sm:flex-row","gt-sm:gap-2"],[1,"mat-block","gt-sm:max-w-60%","gt-sm:flex-full"],["required","","matInput","","formControlName","host"],[1,"mat-block","gt-sm:max-w-40%","gt-sm:flex-full"],["required","","type","number","step","1","min","1","max","65535","matInput","","formControlName","port"],["required","","type","number","step","1","min","1","max","200","matInput","","formControlName","connectTimeoutSec"],["matInput","","formControlName","clientId"],["formControlName","appendClientIdSuffix"],[1,"tb-hint"],["formControlName","parseToPlainText"],["formControlName","cleanSession"],["formControlName","retainedMessage"],["formControlName","ssl"],["formControlName","credentials",3,"passwordFieldRequired"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.topic-pattern"),n(),f(4,"input",3),g(5,Lu,3,3,"mat-error",4),a(6,"mat-hint",2),l(7,"rule-node-config.general-pattern-hint"),n()(),a(8,"div",5)(9,"mat-form-field",6)(10,"mat-label",2),l(11,"rule-node-config.host"),n(),f(12,"input",7),g(13,Pu,3,3,"mat-error",4),n(),a(14,"mat-form-field",8)(15,"mat-label",2),l(16,"rule-node-config.port"),n(),f(17,"input",9),g(18,wu,3,3,"mat-error",4)(19,Gu,3,3,"mat-error",4)(20,ju,3,3,"mat-error",4),n(),a(21,"mat-form-field",8)(22,"mat-label",2),l(23,"rule-node-config.connect-timeout"),n(),f(24,"input",10),g(25,Uu,3,3,"mat-error",4)(26,Ku,3,3,"mat-error",4)(27,Hu,3,3,"mat-error",4),n()(),a(28,"mat-form-field",1)(29,"mat-label",2),l(30,"rule-node-config.client-id"),n(),f(31,"input",11),a(32,"mat-hint"),l(33),m(34,"translate"),n()(),a(35,"mat-checkbox",12),l(36),m(37,"translate"),n(),a(38,"div",13),l(39),m(40,"translate"),n(),a(41,"mat-checkbox",14),l(42),m(43,"translate"),n(),a(44,"div",13),l(45),m(46,"translate"),n(),a(47,"mat-checkbox",15),l(48),m(49,"translate"),n(),a(50,"mat-checkbox",16),l(51),m(52,"translate"),n(),a(53,"mat-checkbox",17),l(54),m(55,"translate"),n(),f(56,"tb-credentials-config",18),n()),i&2&&(p("formGroup",o.mqttConfigForm),r(5),p("ngIf",o.mqttConfigForm.get("topicPattern").hasError("required")),r(8),p("ngIf",o.mqttConfigForm.get("host").hasError("required")),r(5),p("ngIf",o.mqttConfigForm.get("port").hasError("required")),r(),p("ngIf",o.mqttConfigForm.get("port").hasError("min")),r(),p("ngIf",o.mqttConfigForm.get("port").hasError("max")),r(5),p("ngIf",o.mqttConfigForm.get("connectTimeoutSec").hasError("required")),r(),p("ngIf",o.mqttConfigForm.get("connectTimeoutSec").hasError("min")),r(),p("ngIf",o.mqttConfigForm.get("connectTimeoutSec").hasError("max")),r(6),V(s(34,18,"rule-node-config.client-id-hint")),r(3),c(" ",s(37,20,"rule-node-config.append-client-id-suffix")," "),r(3),V(s(40,22,"rule-node-config.client-id-suffix-hint")),r(3),c(" ",s(43,24,"rule-node-config.parse-to-plain-text")," "),r(3),V(s(46,26,"rule-node-config.parse-to-plain-text-hint")),r(3),c(" ",s(49,28,"rule-node-config.clean-session")," "),r(3),c(" ",s(52,30,"rule-node-config.retained-message")," "),r(3),c(" ",s(55,32,"rule-node-config.enable-ssl")," "),r(2),p("passwordFieldRequired",!1))},dependencies:[k,Ge,R,q,B,se,Q,O,fe,S,x,A,ve,ot,_,E,D,gi,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .tb-mqtt-credentials-panel-group[_ngcontent-%COMP%]{margin:0 6px}']})}}return t})();b();var jr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.notificationType=Yo,this.entityType=Y}configForm(){return this.notificationConfigForm}onConfigurationSet(e){this.notificationConfigForm=this.fb.group({templateId:[e?e.templateId:null,[u.required]],targets:[e?e.targets:[],[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-notification-config"]],features:[M],decls:6,vars:13,consts:[[1,"flex","flex-col",3,"formGroup"],["required","","allowCreate","","formControlName","templateId",3,"notificationTypes"],["required","","formControlName","targets",3,"labelText","placeholderText","requiredText","entityType","subType"]],template:function(i,o){i&1&&(a(0,"section",0),f(1,"tb-template-autocomplete",1)(2,"tb-entity-list",2),m(3,"translate"),m(4,"translate"),m(5,"translate"),n()),i&2&&(p("formGroup",o.notificationConfigForm),r(),p("notificationTypes",o.notificationType.RULE_NODE),r(),h("labelText",s(3,7,"notification.recipients")),h("placeholderText",s(4,9,"notification.recipient")),h("requiredText",s(5,11,"notification.recipients-required")),h("entityType",o.entityType.NOTIFICATION_TARGET),h("subType",o.notificationType.RULE_NODE))},dependencies:[Po,S,x,A,_,E,Wo,I],encapsulation:2})}}return t})();b();function zu(t,d){if(t&1&&(a(0,"mat-option",22),l(1),n()),t&2){let e=d.$implicit;p("value",e),r(),c(" ",e," ")}}function Qu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.host-required")," "))}function Ju(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.port-required")," "))}function $u(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.port-range")," "))}function Yu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.port-range")," "))}function Wu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-connection-timeout-ms-message")," "))}function Xu(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-handshake-timeout-ms-message")," "))}var Ur=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.messageProperties=[null,"BASIC","TEXT_PLAIN","MINIMAL_BASIC","MINIMAL_PERSISTENT_BASIC","PERSISTENT_BASIC","PERSISTENT_TEXT_PLAIN"]}configForm(){return this.rabbitMqConfigForm}onConfigurationSet(e){this.rabbitMqConfigForm=this.fb.group({exchangeNamePattern:[e?e.exchangeNamePattern:null,[]],routingKeyPattern:[e?e.routingKeyPattern:null,[]],messageProperties:[e?e.messageProperties:null,[]],host:[e?e.host:null,[u.required]],port:[e?e.port:null,[u.required,u.min(1),u.max(65535)]],virtualHost:[e?e.virtualHost:null,[]],username:[e?e.username:null,[]],password:[e?e.password:null,[]],automaticRecoveryEnabled:[e?e.automaticRecoveryEnabled:!1,[]],connectionTimeout:[e?e.connectionTimeout:null,[u.min(0)]],handshakeTimeout:[e?e.handshakeTimeout:null,[u.min(0)]],clientProperties:[e?e.clientProperties:null,[]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-rabbit-mq-config"]],features:[M],decls:56,vars:11,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"mat-block"],["translate",""],["matInput","","formControlName","exchangeNamePattern"],["matInput","","formControlName","routingKeyPattern"],["formControlName","messageProperties"],[3,"value",4,"ngFor","ngForOf"],[1,"gt-sm:flex","gt-sm:flex-row","gt-sm:gap-2"],[1,"mat-block","gt-sm:max-w-60%","gt-sm:flex-full"],["required","","matInput","","formControlName","host"],[4,"ngIf"],[1,"mat-block","gt-sm:max-w-40%","gt-sm:flex-full"],["required","","type","number","step","1","min","1","max","65535","matInput","","formControlName","port"],["matInput","","formControlName","virtualHost"],["matInput","","formControlName","username"],["type","password","matInput","","formControlName","password"],["matSuffix",""],["formControlName","automaticRecoveryEnabled"],["type","number","step","1","min","0","matInput","","formControlName","connectionTimeout"],["type","number","step","1","min","0","matInput","","formControlName","handshakeTimeout"],["translate","",1,"tb-title"],["required","false","formControlName","clientProperties","keyText","rule-node-config.key","keyRequiredText","rule-node-config.key-required","valText","rule-node-config.value","valRequiredText","rule-node-config.value-required"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.exchange-name-pattern"),n(),f(4,"input",3),n(),a(5,"mat-form-field",1)(6,"mat-label",2),l(7,"rule-node-config.routing-key-pattern"),n(),f(8,"input",4),n(),a(9,"mat-form-field",1)(10,"mat-label",2),l(11,"rule-node-config.message-properties"),n(),a(12,"mat-select",5),g(13,zu,2,2,"mat-option",6),n()(),a(14,"div",7)(15,"mat-form-field",8)(16,"mat-label",2),l(17,"rule-node-config.host"),n(),f(18,"input",9),g(19,Qu,3,3,"mat-error",10),n(),a(20,"mat-form-field",11)(21,"mat-label",2),l(22,"rule-node-config.port"),n(),f(23,"input",12),g(24,Ju,3,3,"mat-error",10)(25,$u,3,3,"mat-error",10)(26,Yu,3,3,"mat-error",10),n()(),a(27,"mat-form-field",1)(28,"mat-label",2),l(29,"rule-node-config.virtual-host"),n(),f(30,"input",13),n(),a(31,"mat-form-field",1)(32,"mat-label",2),l(33,"rule-node-config.username"),n(),f(34,"input",14),n(),a(35,"mat-form-field",1)(36,"mat-label",2),l(37,"rule-node-config.password"),n(),f(38,"input",15)(39,"tb-toggle-password",16),n(),a(40,"mat-checkbox",17),l(41),m(42,"translate"),n(),a(43,"mat-form-field",1)(44,"mat-label",2),l(45,"rule-node-config.connection-timeout-ms"),n(),f(46,"input",18),g(47,Wu,3,3,"mat-error",10),n(),a(48,"mat-form-field",1)(49,"mat-label",2),l(50,"rule-node-config.handshake-timeout-ms"),n(),f(51,"input",19),g(52,Xu,3,3,"mat-error",10),n(),a(53,"label",20),l(54,"rule-node-config.client-properties"),n(),f(55,"tb-kv-map-config-old",21),n()),i&2&&(p("formGroup",o.rabbitMqConfigForm),r(13),p("ngForOf",o.messageProperties),r(6),p("ngIf",o.rabbitMqConfigForm.get("host").hasError("required")),r(5),p("ngIf",o.rabbitMqConfigForm.get("port").hasError("required")),r(),p("ngIf",o.rabbitMqConfigForm.get("port").hasError("min")),r(),p("ngIf",o.rabbitMqConfigForm.get("port").hasError("max")),r(15),c(" ",s(42,9,"rule-node-config.automatic-recovery")," "),r(6),p("ngIf",o.rabbitMqConfigForm.get("connectionTimeout").hasError("min")),r(5),p("ngIf",o.rabbitMqConfigForm.get("handshakeTimeout").hasError("min")))},dependencies:[z,k,Ge,R,q,B,Q,oe,ee,W,O,fe,S,x,A,ve,ot,_,E,D,li,Ft,I],encapsulation:2})}}return t})();b();var Zu=t=>({max:t});function ec(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.endpoint-url-pattern-required")," "))}function tc(t,d){if(t&1&&(a(0,"mat-option",20),l(1),n()),t&2){let e=d.$implicit;p("value",e),r(),c(" ",e," ")}}function ic(t,d){t&1&&(a(0,"mat-checkbox",21),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.use-simple-client-http-factory")," "))}function nc(t,d){if(t&1&&(a(0,"mat-option",20),l(1),n()),t&2){let e=d.$implicit;p("value",e),r(),c(" ",e," ")}}function rc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.proxy-host-required")," "))}function oc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.proxy-port-required")," "))}function ac(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.proxy-port-range")," "))}function lc(t,d){if(t&1&&(a(0,"div")(1,"div",23)(2,"mat-form-field",24)(3,"mat-label",2),l(4,"rule-node-config.proxy-scheme"),n(),a(5,"mat-select",25),g(6,nc,2,2,"mat-option",7),n()(),a(7,"mat-form-field",26)(8,"mat-label",2),l(9,"rule-node-config.proxy-host"),n(),f(10,"input",27),g(11,rc,3,3,"mat-error",4),n(),a(12,"mat-form-field",28)(13,"mat-label",2),l(14,"rule-node-config.proxy-port"),n(),f(15,"input",29),g(16,oc,3,3,"mat-error",4)(17,ac,3,3,"mat-error",4),n()(),a(18,"mat-form-field",5)(19,"mat-label",2),l(20,"rule-node-config.proxy-user"),n(),f(21,"input",30),n(),a(22,"mat-form-field",5)(23,"mat-label",2),l(24,"rule-node-config.proxy-password"),n(),f(25,"input",31),n()()),t&2){let e=v(2);r(6),p("ngForOf",e.proxySchemes),r(5),p("ngIf",e.restApiCallConfigForm.get("proxyHost").hasError("required")),r(5),p("ngIf",e.restApiCallConfigForm.get("proxyPort").hasError("required")),r(),p("ngIf",e.restApiCallConfigForm.get("proxyPort").hasError("min")||e.restApiCallConfigForm.get("proxyPort").hasError("max"))}}function pc(t,d){if(t&1&&(a(0,"div")(1,"mat-checkbox",22),l(2),m(3,"translate"),n(),g(4,lc,26,4,"div",4),n()),t&2){let e=v();r(2),c(" ",s(3,2,"rule-node-config.use-system-proxy-properties")," "),r(2),p("ngIf",!e.restApiCallConfigForm.get("useSystemProxyProperties").value)}}function mc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.int-range")," "))}function sc(t,d){if(t&1&&(a(0,"mat-form-field",1)(1,"mat-label",2),l(2,"rule-node-config.read-timeout"),n(),f(3,"input",32),a(4,"mat-hint",2),l(5,"rule-node-config.read-timeout-hint"),n(),g(6,mc,3,3,"mat-error",4),n()),t&2){let e=v();r(3),p("max",e.IntLimit),r(3),p("ngIf",e.restApiCallConfigForm.get("readTimeoutMs").hasError("max"))}}function dc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.int-range")," "))}function uc(t,d){if(t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2){let e=v();r(),c(" ",ae(2,1,"rule-node-config.memory-buffer-size-range",Fe(4,Zu,e.MemoryBufferSizeInKbLimit))," ")}}var Kr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.proxySchemes=["http","https"],this.httpRequestTypes=Object.keys(Gn),this.MemoryBufferSizeInKbLimit=25e3,this.IntLimit=Gi}configForm(){return this.restApiCallConfigForm}onConfigurationSet(e){this.restApiCallConfigForm=this.fb.group({restEndpointUrlPattern:[e?e.restEndpointUrlPattern:null,[u.required]],requestMethod:[e?e.requestMethod:null,[u.required]],useSimpleClientHttpFactory:[e?e.useSimpleClientHttpFactory:!1,[]],parseToPlainText:[e?e.parseToPlainText:!1,[]],ignoreRequestBody:[e?e.ignoreRequestBody:!1,[]],enableProxy:[e?e.enableProxy:!1,[]],useSystemProxyProperties:[e?e.enableProxy:!1,[]],proxyScheme:[e?e.proxyHost:null,[]],proxyHost:[e?e.proxyHost:null,[]],proxyPort:[e?e.proxyPort:null,[]],proxyUser:[e?e.proxyUser:null,[]],proxyPassword:[e?e.proxyPassword:null,[]],readTimeoutMs:[e?e.readTimeoutMs:null,[u.min(0),u.max(Gi)]],maxParallelRequestsCount:[e?e.maxParallelRequestsCount:null,[u.min(0),u.max(Gi)]],headers:[e?e.headers:null,[]],credentials:[e?e.credentials:null,[]],maxInMemoryBufferSizeInKb:[e?e.maxInMemoryBufferSizeInKb:null,[u.min(1),u.max(this.MemoryBufferSizeInKbLimit)]]})}validatorTriggers(){return["useSimpleClientHttpFactory","enableProxy","useSystemProxyProperties"]}updateValidators(e){let i=this.restApiCallConfigForm.get("useSimpleClientHttpFactory").value,o=this.restApiCallConfigForm.get("enableProxy").value,C=this.restApiCallConfigForm.get("useSystemProxyProperties").value;o&&!C?(this.restApiCallConfigForm.get("proxyHost").setValidators(o?[u.required]:[]),this.restApiCallConfigForm.get("proxyPort").setValidators(o?[u.required,u.min(1),u.max(65535)]:[])):(this.restApiCallConfigForm.get("proxyHost").setValidators([]),this.restApiCallConfigForm.get("proxyPort").setValidators([]),i?this.restApiCallConfigForm.get("readTimeoutMs").setValidators([]):this.restApiCallConfigForm.get("readTimeoutMs").setValidators([u.min(0),u.max(Gi)])),this.restApiCallConfigForm.get("readTimeoutMs").updateValueAndValidity({emitEvent:e}),this.restApiCallConfigForm.get("proxyHost").updateValueAndValidity({emitEvent:e}),this.restApiCallConfigForm.get("proxyPort").updateValueAndValidity({emitEvent:e}),this.restApiCallConfigForm.get("credentials").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-rest-api-call-config"]],features:[M],decls:48,vars:26,consts:[[1,"flex","flex-col",3,"formGroup"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","restEndpointUrlPattern"],[4,"ngIf"],[1,"mat-block"],["formControlName","requestMethod"],[3,"value",4,"ngFor","ngForOf"],["formControlName","enableProxy"],["formControlName","useSimpleClientHttpFactory",4,"ngIf"],["formControlName","parseToPlainText"],["translate","",1,"tb-hint",2,"padding-bottom","5px"],["formControlName","ignoreRequestBody"],["class","mat-block","subscriptSizing","dynamic",4,"ngIf"],["type","text","min","0","inputmode","numeric","pattern","[0-9]*","matInput","","formControlName","maxParallelRequestsCount",3,"max"],["type","text","min","1","inputmode","numeric","pattern","[0-9]*","matInput","","formControlName","maxInMemoryBufferSizeInKb",3,"max"],["translate","",1,"tb-title"],[1,"tb-hint",3,"innerHTML"],["required","false","formControlName","headers","keyText","rule-node-config.header","keyRequiredText","rule-node-config.header-required","valText","rule-node-config.value","valRequiredText","rule-node-config.value-required"],["formControlName","credentials",3,"disableCertPemCredentials"],[3,"value"],["formControlName","useSimpleClientHttpFactory"],["formControlName","useSystemProxyProperties"],[1,"gt-sm:flex","gt-sm:flex-row","gt-sm:gap-2"],[1,"mat-block","gt-sm:max-w-10%","gt-sm:flex-full"],["formControlName","proxyScheme"],[1,"md-block","gt-sm:max-w-50%","gt-sm:flex-full"],["matInput","","required","","formControlName","proxyHost"],[1,"mat-block","gt-sm:max-w-40%","gt-sm:flex-full"],["matInput","","required","","formControlName","proxyPort","type","number","step","1"],["matInput","","formControlName","proxyUser"],["matInput","","formControlName","proxyPassword"],["type","text","min","0","inputmode","numeric","pattern","[0-9]*","matInput","","formControlName","readTimeoutMs",3,"max"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.endpoint-url-pattern"),n(),f(4,"input",3),g(5,ec,3,3,"mat-error",4),a(6,"mat-hint",2),l(7,"rule-node-config.general-pattern-hint"),n()(),a(8,"mat-form-field",5)(9,"mat-label",2),l(10,"rule-node-config.request-method"),n(),a(11,"mat-select",6),g(12,tc,2,2,"mat-option",7),n()(),a(13,"mat-checkbox",8),l(14),m(15,"translate"),n(),g(16,ic,3,3,"mat-checkbox",9),a(17,"mat-checkbox",10),l(18),m(19,"translate"),n(),a(20,"div",11),l(21,"rule-node-config.parse-to-plain-text-hint"),n(),a(22,"mat-checkbox",12),l(23),m(24,"translate"),n(),g(25,pc,5,4,"div",4)(26,sc,7,2,"mat-form-field",13),a(27,"mat-form-field",1)(28,"mat-label",2),l(29,"rule-node-config.max-parallel-requests-count"),n(),f(30,"input",14),a(31,"mat-hint",2),l(32,"rule-node-config.max-parallel-requests-count-hint"),n(),g(33,dc,3,3,"mat-error",4),n(),a(34,"mat-form-field",1)(35,"mat-label",2),l(36,"rule-node-config.max-response-size"),n(),f(37,"input",15),a(38,"mat-hint",2),l(39,"rule-node-config.max-response-size-hint"),n(),g(40,uc,3,6,"mat-error",4),n(),a(41,"label",16),l(42,"rule-node-config.headers"),n(),f(43,"div",17),m(44,"translate"),m(45,"safe"),f(46,"tb-kv-map-config-old",18)(47,"tb-credentials-config",19),n()),i&2&&(p("formGroup",o.restApiCallConfigForm),r(5),p("ngIf",o.restApiCallConfigForm.get("restEndpointUrlPattern").hasError("required")),r(7),p("ngForOf",o.httpRequestTypes),r(2),c(" ",s(15,15,"rule-node-config.enable-proxy")," "),r(2),p("ngIf",!o.restApiCallConfigForm.get("enableProxy").value),r(2),c(" ",s(19,17,"rule-node-config.parse-to-plain-text")," "),r(5),c(" ",s(24,19,"rule-node-config.ignore-request-body")," "),r(2),p("ngIf",o.restApiCallConfigForm.get("enableProxy").value),r(),p("ngIf",!o.restApiCallConfigForm.get("useSimpleClientHttpFactory").value||o.restApiCallConfigForm.get("enableProxy").value),r(4),p("max",o.IntLimit),r(3),p("ngIf",o.restApiCallConfigForm.get("maxParallelRequestsCount").hasError("max")),r(4),p("max",o.MemoryBufferSizeInKbLimit),r(3),p("ngIf",o.restApiCallConfigForm.get("maxInMemoryBufferSizeInKb").hasError("min")||o.restApiCallConfigForm.get("maxInMemoryBufferSizeInKb").hasError("max")),r(3),p("innerHTML",ae(45,23,s(44,21,"rule-node-config.headers-hint"),"html"),Pe),r(4),p("disableCertPemCredentials",o.restApiCallConfigForm.get("useSimpleClientHttpFactory").value))},dependencies:[z,k,Ge,R,q,B,se,Q,ee,W,O,fe,S,x,A,Ti,_,E,D,gi,Ft,pt,I],encapsulation:2})}}return t})();b();function cc(t,d){if(t&1&&(a(0,"mat-option",22),l(1),n()),t&2){let e=d.$implicit;p("value",e),r(),c(" ",e.toUpperCase()," ")}}function fc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.smtp-host-required")," "))}function gc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.smtp-port-required")," "))}function Cc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.smtp-port-range")," "))}function yc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.smtp-port-range")," "))}function vc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.timeout-required")," "))}function hc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.min-timeout-msec-message")," "))}function bc(t,d){if(t&1&&(a(0,"mat-option",22),l(1),n()),t&2){let e=d.$implicit;p("value",e),r(),c(" ",e," ")}}function Tc(t,d){if(t&1&&(a(0,"mat-form-field",4)(1,"mat-label",5),l(2,"rule-node-config.tls-version"),n(),a(3,"mat-select",23),g(4,bc,2,2,"mat-option",7),n()()),t&2){let e=v(2);r(4),p("ngForOf",e.tlsVersions)}}function xc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.proxy-host-required")," "))}function _c(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.proxy-port-required")," "))}function Sc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.proxy-port-range")," "))}function Fc(t,d){if(t&1&&(a(0,"div")(1,"div",8)(2,"mat-form-field",9)(3,"mat-label",5),l(4,"rule-node-config.proxy-host"),n(),f(5,"input",24),g(6,xc,3,3,"mat-error",11),n(),a(7,"mat-form-field",12)(8,"mat-label",5),l(9,"rule-node-config.proxy-port"),n(),f(10,"input",25),g(11,_c,3,3,"mat-error",11)(12,Sc,3,3,"mat-error",11),n()(),a(13,"mat-form-field",4)(14,"mat-label",5),l(15,"rule-node-config.proxy-user"),n(),f(16,"input",26),n(),a(17,"mat-form-field",4)(18,"mat-label",5),l(19,"rule-node-config.proxy-password"),n(),f(20,"input",27),n()()),t&2){let e=v(2);r(6),p("ngIf",e.sendEmailConfigForm.get("proxyHost").hasError("required")),r(5),p("ngIf",e.sendEmailConfigForm.get("proxyPort").hasError("required")),r(),p("ngIf",e.sendEmailConfigForm.get("proxyPort").hasError("min")||e.sendEmailConfigForm.get("proxyPort").hasError("max"))}}function Ic(t,d){if(t&1&&(a(0,"section",3)(1,"mat-form-field",4)(2,"mat-label",5),l(3,"rule-node-config.smtp-protocol"),n(),a(4,"mat-select",6),g(5,cc,2,2,"mat-option",7),n()(),a(6,"div",8)(7,"mat-form-field",9)(8,"mat-label",5),l(9,"rule-node-config.smtp-host"),n(),f(10,"input",10),g(11,fc,3,3,"mat-error",11),n(),a(12,"mat-form-field",12)(13,"mat-label",5),l(14,"rule-node-config.smtp-port"),n(),f(15,"input",13),g(16,gc,3,3,"mat-error",11)(17,Cc,3,3,"mat-error",11)(18,yc,3,3,"mat-error",11),n()(),a(19,"mat-form-field",4)(20,"mat-label",5),l(21,"rule-node-config.timeout-msec"),n(),f(22,"input",14),g(23,vc,3,3,"mat-error",11)(24,hc,3,3,"mat-error",11),n(),a(25,"mat-checkbox",15),l(26),m(27,"translate"),n(),g(28,Tc,5,1,"mat-form-field",16),a(29,"tb-checkbox",17),l(30),m(31,"translate"),n(),g(32,Fc,21,3,"div",11),a(33,"mat-form-field",18)(34,"mat-label",5),l(35,"rule-node-config.username"),n(),f(36,"input",19),m(37,"translate"),n(),a(38,"mat-form-field",18)(39,"mat-label",5),l(40,"rule-node-config.password"),n(),f(41,"input",20),m(42,"translate"),f(43,"tb-toggle-password",21),n()()),t&2){let e=v();r(5),p("ngForOf",e.smtpProtocols),r(6),p("ngIf",e.sendEmailConfigForm.get("smtpHost").hasError("required")),r(5),p("ngIf",e.sendEmailConfigForm.get("smtpPort").hasError("required")),r(),p("ngIf",e.sendEmailConfigForm.get("smtpPort").hasError("min")),r(),p("ngIf",e.sendEmailConfigForm.get("smtpPort").hasError("max")),r(5),p("ngIf",e.sendEmailConfigForm.get("timeout").hasError("required")),r(),p("ngIf",e.sendEmailConfigForm.get("timeout").hasError("min")),r(2),c(" ",s(27,13,"rule-node-config.enable-tls")," "),r(2),p("ngIf",e.sendEmailConfigForm.get("enableTls").value===!0),r(2),c(" ",s(31,15,"rule-node-config.enable-proxy")," "),r(2),p("ngIf",e.sendEmailConfigForm.get("enableProxy").value),r(4),h("placeholder",s(37,17,"rule-node-config.enter-username")),r(5),h("placeholder",s(42,19,"rule-node-config.enter-password"))}}var Hr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.smtpProtocols=["smtp","smtps"],this.tlsVersions=["TLSv1","TLSv1.1","TLSv1.2","TLSv1.3"]}configForm(){return this.sendEmailConfigForm}onConfigurationSet(e){this.sendEmailConfigForm=this.fb.group({useSystemSmtpSettings:[e?e.useSystemSmtpSettings:!1,[]],smtpProtocol:[e?e.smtpProtocol:null,[]],smtpHost:[e?e.smtpHost:null,[]],smtpPort:[e?e.smtpPort:null,[]],timeout:[e?e.timeout:null,[]],enableTls:[e?e.enableTls:!1,[]],tlsVersion:[e?e.tlsVersion:null,[]],enableProxy:[e?e.enableProxy:!1,[]],proxyHost:[e?e.proxyHost:null,[]],proxyPort:[e?e.proxyPort:null,[]],proxyUser:[e?e.proxyUser:null,[]],proxyPassword:[e?e.proxyPassword:null,[]],username:[e?e.username:null,[]],password:[e?e.password:null,[]]})}validatorTriggers(){return["useSystemSmtpSettings","enableProxy"]}updateValidators(e){let i=this.sendEmailConfigForm.get("useSystemSmtpSettings").value,o=this.sendEmailConfigForm.get("enableProxy").value;i?(this.sendEmailConfigForm.get("smtpProtocol").setValidators([]),this.sendEmailConfigForm.get("smtpHost").setValidators([]),this.sendEmailConfigForm.get("smtpPort").setValidators([]),this.sendEmailConfigForm.get("timeout").setValidators([]),this.sendEmailConfigForm.get("proxyHost").setValidators([]),this.sendEmailConfigForm.get("proxyPort").setValidators([])):(this.sendEmailConfigForm.get("smtpProtocol").setValidators([u.required]),this.sendEmailConfigForm.get("smtpHost").setValidators([u.required]),this.sendEmailConfigForm.get("smtpPort").setValidators([u.required,u.min(1),u.max(65535)]),this.sendEmailConfigForm.get("timeout").setValidators([u.required,u.min(0)]),this.sendEmailConfigForm.get("proxyHost").setValidators(o?[u.required]:[]),this.sendEmailConfigForm.get("proxyPort").setValidators(o?[u.required,u.min(1),u.max(65535)]:[])),this.sendEmailConfigForm.get("smtpProtocol").updateValueAndValidity({emitEvent:e}),this.sendEmailConfigForm.get("smtpHost").updateValueAndValidity({emitEvent:e}),this.sendEmailConfigForm.get("smtpPort").updateValueAndValidity({emitEvent:e}),this.sendEmailConfigForm.get("timeout").updateValueAndValidity({emitEvent:e}),this.sendEmailConfigForm.get("proxyHost").updateValueAndValidity({emitEvent:e}),this.sendEmailConfigForm.get("proxyPort").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-send-email-config"]],features:[M],decls:5,vars:5,consts:[[1,"flex","flex-col",3,"formGroup"],["formControlName","useSystemSmtpSettings"],["class","flex flex-col",4,"ngIf"],[1,"flex","flex-col"],[1,"mat-block"],["translate",""],["formControlName","smtpProtocol"],[3,"value",4,"ngFor","ngForOf"],[1,"gt-sm:flex","gt-sm:flex-row","gt-sm:gap-2"],[1,"mat-block","gt-sm:max-w-60%","gt-sm:flex-full"],["required","","matInput","","formControlName","smtpHost"],[4,"ngIf"],[1,"mat-block","gt-sm:max-w-40%","gt-sm:flex-full"],["required","","type","number","step","1","min","1","max","65535","matInput","","formControlName","smtpPort"],["required","","type","number","step","1","min","0","matInput","","formControlName","timeout"],["formControlName","enableTls"],["class","mat-block",4,"ngIf"],["formControlName","enableProxy"],["floatLabel","always",1,"mat-block"],["matInput","","formControlName","username",3,"placeholder"],["matInput","","type","password","formControlName","password",3,"placeholder"],["matSuffix",""],[3,"value"],["formControlName","tlsVersion"],["matInput","","required","","formControlName","proxyHost"],["matInput","","required","","formControlName","proxyPort","type","number","step","1","min","1","max","65535"],["matInput","","formControlName","proxyUser"],["matInput","","formControlName","proxyPassword"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-checkbox",1),l(2),m(3,"translate"),n(),g(4,Ic,44,21,"section",2),n()),i&2&&(p("formGroup",o.sendEmailConfigForm),r(2),c(" ",s(3,3,"rule-node-config.use-system-smtp-settings")," "),r(2),p("ngIf",o.sendEmailConfigForm.get("useSystemSmtpSettings").value===!1))},dependencies:[z,k,Ro,Ge,R,q,B,Q,oe,ee,W,O,fe,S,x,A,ve,ot,_,E,D,li,I],encapsulation:2})}}return t})();b();function Ec(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.topic-required")," "))}function Mc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.hostname-required")," "))}function Nc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.device-id-required")," "))}function Ac(t,d){if(t&1&&(a(0,"mat-option",17),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.azureIotHubCredentialsTypeTranslationsMap.get(e))," ")}}function Dc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.credentials-type-required")," "))}function Vc(t,d){}function qc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.sas-key-required")," "))}function kc(t,d){if(t&1){let e=pe();a(0,"mat-form-field",5)(1,"mat-label",2),l(2,"rule-node-config.sas-key"),n(),f(3,"input",18)(4,"tb-toggle-password",19),g(5,qc,3,3,"mat-error",4),n(),a(6,"tb-file-input",20),m(7,"translate"),m(8,"translate"),$("fileNameChanged",function(o){ie(e);let C=v();return ne(C.azureIotHubConfigForm.get("credentials.caCertFileName").setValue(o))}),n()}if(t&2){let e=v();r(5),p("ngIf",e.azureIotHubConfigForm.get("credentials.sasKey").hasError("required")),r(),h("label",s(7,4,"rule-node-config.azure-ca-cert")),h("dropLabel",s(8,6,"rule-node-config.drop-file")),p("existingFileName",e.azureIotHubConfigForm.get("credentials.caCertFileName").value)}}function Bc(t,d){if(t&1){let e=pe();a(0,"tb-file-input",20),m(1,"translate"),m(2,"translate"),$("fileNameChanged",function(o){ie(e);let C=v();return ne(C.azureIotHubConfigForm.get("credentials.caCertFileName").setValue(o))}),n(),a(3,"tb-file-input",21),m(4,"translate"),m(5,"translate"),$("fileNameChanged",function(o){ie(e);let C=v();return ne(C.azureIotHubConfigForm.get("credentials.certFileName").setValue(o))}),n(),a(6,"tb-file-input",22),m(7,"translate"),m(8,"translate"),$("fileNameChanged",function(o){ie(e);let C=v();return ne(C.azureIotHubConfigForm.get("credentials.privateKeyFileName").setValue(o))}),n(),a(9,"mat-form-field",5)(10,"mat-label",2),l(11,"rule-node-config.private-key-password"),n(),f(12,"input",23)(13,"tb-toggle-password",19),n()}if(t&2){let e=v();h("label",s(1,9,"rule-node-config.azure-ca-cert")),h("dropLabel",s(2,11,"rule-node-config.drop-file")),p("existingFileName",e.azureIotHubConfigForm.get("credentials.caCertFileName").value),r(3),h("label",s(4,13,"rule-node-config.cert")),h("dropLabel",s(5,15,"rule-node-config.drop-file")),p("existingFileName",e.azureIotHubConfigForm.get("credentials.certFileName").value),r(3),h("label",s(7,17,"rule-node-config.private-key")),h("dropLabel",s(8,19,"rule-node-config.drop-file")),p("existingFileName",e.azureIotHubConfigForm.get("credentials.privateKeyFileName").value)}}var zr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.allAzureIotHubCredentialsTypes=ha,this.azureIotHubCredentialsTypeTranslationsMap=ba}configForm(){return this.azureIotHubConfigForm}onConfigurationSet(e){this.azureIotHubConfigForm=this.fb.group({topicPattern:[e?e.topicPattern:null,[u.required]],host:[e?e.host:null,[u.required]],port:[e?e.port:null,[u.required,u.min(1),u.max(65535)]],connectTimeoutSec:[e?e.connectTimeoutSec:null,[u.required,u.min(1),u.max(200)]],clientId:[e?e.clientId:null,[u.required]],cleanSession:[e?e.cleanSession:!1,[]],ssl:[e?e.ssl:!1,[]],credentials:this.fb.group({type:[e&&e.credentials?e.credentials.type:null,[u.required]],sasKey:[e&&e.credentials?e.credentials.sasKey:null,[]],caCert:[e&&e.credentials?e.credentials.caCert:null,[]],caCertFileName:[e&&e.credentials?e.credentials.caCertFileName:null,[]],privateKey:[e&&e.credentials?e.credentials.privateKey:null,[]],privateKeyFileName:[e&&e.credentials?e.credentials.privateKeyFileName:null,[]],cert:[e&&e.credentials?e.credentials.cert:null,[]],certFileName:[e&&e.credentials?e.credentials.certFileName:null,[]],password:[e&&e.credentials?e.credentials.password:null,[]]})})}prepareOutputConfig(e){let i=e.credentials.type;return i==="sas"&&(e.credentials={type:i,sasKey:e.credentials.sasKey,caCert:e.credentials.caCert,caCertFileName:e.credentials.caCertFileName}),e}validatorTriggers(){return["credentials.type"]}updateValidators(e){let i=this.azureIotHubConfigForm.get("credentials"),o=i.get("type").value;switch(e&&i.reset({type:o},{emitEvent:!1}),i.get("sasKey").setValidators([]),i.get("privateKey").setValidators([]),i.get("privateKeyFileName").setValidators([]),i.get("cert").setValidators([]),i.get("certFileName").setValidators([]),o){case"sas":i.get("sasKey").setValidators([u.required]);break;case"cert.PEM":i.get("privateKey").setValidators([u.required]),i.get("privateKeyFileName").setValidators([u.required]),i.get("cert").setValidators([u.required]),i.get("certFileName").setValidators([u.required]);break}i.get("sasKey").updateValueAndValidity({emitEvent:e}),i.get("privateKey").updateValueAndValidity({emitEvent:e}),i.get("privateKeyFileName").updateValueAndValidity({emitEvent:e}),i.get("cert").updateValueAndValidity({emitEvent:e}),i.get("certFileName").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-azure-iot-hub-config"]],features:[M],decls:37,vars:10,consts:[[1,"flex","flex-col",3,"formGroup"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","topicPattern"],[4,"ngIf"],[1,"mat-block"],["required","","matInput","","formControlName","host"],["required","","matInput","","formControlName","clientId","autocomplete","new-clientId"],[1,"tb-mqtt-credentials-panel-group"],["translate","",1,"tb-required"],["formGroupName","credentials",1,"flex","flex-col"],["formControlName","type","required",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex","flex-col",3,"ngSwitch"],["ngSwitchCase","anonymous"],["ngSwitchCase","sas"],["ngSwitchCase","cert.PEM"],[3,"value"],["type","password","required","","matInput","","formControlName","sasKey","autocomplete","new-password"],["matSuffix",""],["formControlName","caCert","inputId","caCertSelect","noFileText","rule-node-config.no-file",3,"fileNameChanged","existingFileName","label","dropLabel"],["formControlName","cert","inputId","CertSelect","required","","requiredAsError","","noFileText","rule-node-config.no-file",3,"fileNameChanged","existingFileName","label","dropLabel"],["formControlName","privateKey","inputId","privateKeySelect","required","","requiredAsError","","noFileText","rule-node-config.no-file",2,"padding-bottom","8px",3,"fileNameChanged","existingFileName","label","dropLabel"],["type","password","matInput","","formControlName","password","autocomplete","new-password"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.topic"),n(),f(4,"input",3),g(5,Ec,3,3,"mat-error",4),a(6,"mat-hint",2),l(7,"rule-node-config.general-pattern-hint"),n()(),a(8,"mat-form-field",5)(9,"mat-label",2),l(10,"rule-node-config.hostname"),n(),f(11,"input",6),g(12,Mc,3,3,"mat-error",4),n(),a(13,"mat-form-field",5)(14,"mat-label",2),l(15,"rule-node-config.device-id"),n(),f(16,"input",7),g(17,Nc,3,3,"mat-error",4),n(),a(18,"mat-accordion")(19,"mat-expansion-panel",8)(20,"mat-expansion-panel-header")(21,"mat-panel-title",9),l(22,"rule-node-config.credentials"),n(),a(23,"mat-panel-description"),l(24),m(25,"translate"),n()(),a(26,"section",10)(27,"mat-form-field",5)(28,"mat-label",2),l(29,"rule-node-config.credentials-type"),n(),a(30,"mat-select",11),g(31,Ac,3,4,"mat-option",12),n(),g(32,Dc,3,3,"mat-error",4),n(),a(33,"section",13),g(34,Vc,0,0,"ng-template",14)(35,kc,9,8,"ng-template",15)(36,Bc,14,21,"ng-template",16),n()()()()()),i&2&&(p("formGroup",o.azureIotHubConfigForm),r(5),p("ngIf",o.azureIotHubConfigForm.get("topicPattern").hasError("required")),r(7),p("ngIf",o.azureIotHubConfigForm.get("host").hasError("required")),r(5),p("ngIf",o.azureIotHubConfigForm.get("clientId").hasError("required")),r(7),c(" ",s(25,8,o.azureIotHubCredentialsTypeTranslationsMap.get(o.azureIotHubConfigForm.get("credentials.type").value))," "),r(7),p("ngForOf",o.allAzureIotHubCredentialsTypes),r(),p("ngIf",o.azureIotHubConfigForm.get("credentials.type").hasError("required")),r(),p("ngSwitch",o.azureIotHubConfigForm.get("credentials.type").value))},dependencies:[z,k,Xi,Zi,R,q,B,se,Q,oe,ee,W,Ao,it,nt,rt,rn,O,S,x,A,_,E,Vt,Ii,D,li,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .tb-mqtt-credentials-panel-group[_ngcontent-%COMP%]{margin:0 6px}']})}}return t})();b();function Oc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.numbers-to-template-required")," "))}function Rc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.sms-message-template-required")," "))}function Lc(t,d){t&1&&f(0,"tb-sms-provider-configuration",9)}var Qr=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.sendSmsConfigForm}onConfigurationSet(e){this.sendSmsConfigForm=this.fb.group({numbersToTemplate:[e?e.numbersToTemplate:null,[u.required]],smsMessageTemplate:[e?e.smsMessageTemplate:null,[u.required]],useSystemSmsSettings:[e?e.useSystemSmsSettings:!1,[]],smsProviderConfiguration:[e?e.smsProviderConfiguration:null,[]]})}validatorTriggers(){return["useSystemSmsSettings"]}updateValidators(e){this.sendSmsConfigForm.get("useSystemSmsSettings").value?this.sendSmsConfigForm.get("smsProviderConfiguration").setValidators([]):this.sendSmsConfigForm.get("smsProviderConfiguration").setValidators([u.required]),this.sendSmsConfigForm.get("smsProviderConfiguration").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-send-sms-config"]],features:[M],decls:20,vars:13,consts:[[1,"flex","flex-col",3,"formGroup"],["subscriptSizing","dynamic",1,"mat-block"],["translate",""],["required","","matInput","","formControlName","numbersToTemplate"],[4,"ngIf"],[3,"innerHTML"],["required","","matInput","","formControlName","smsMessageTemplate","rows","6"],["formControlName","useSystemSmsSettings"],["formControlName","smsProviderConfiguration","required","",4,"ngIf"],["formControlName","smsProviderConfiguration","required",""]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.numbers-to-template"),n(),f(4,"input",3),g(5,Oc,3,3,"mat-error",4),f(6,"mat-hint",5),m(7,"translate"),m(8,"safe"),n(),a(9,"mat-form-field",1)(10,"mat-label",2),l(11,"rule-node-config.sms-message-template"),n(),f(12,"textarea",6),g(13,Rc,3,3,"mat-error",4),a(14,"mat-hint",2),l(15,"rule-node-config.general-pattern-hint"),n()(),a(16,"mat-checkbox",7),l(17),m(18,"translate"),n(),g(19,Lc,1,0,"tb-sms-provider-configuration",8),n()),i&2&&(p("formGroup",o.sendSmsConfigForm),r(5),p("ngIf",o.sendSmsConfigForm.get("numbersToTemplate").hasError("required")),r(),p("innerHTML",ae(8,8,s(7,6,"rule-node-config.numbers-to-template-hint"),"html"),Pe),r(7),p("ngIf",o.sendSmsConfigForm.get("smsMessageTemplate").hasError("required")),r(4),c(" ",s(18,11,"rule-node-config.use-system-sms-settings")," "),r(2),p("ngIf",o.sendSmsConfigForm.get("useSystemSmsSettings").value===!1))},dependencies:[k,Ge,R,q,B,se,Q,O,S,x,A,_,E,D,ea,pt,I],encapsulation:2})}}return t})();b();function Pc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.message-template-required")," "))}function wc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.slack-api-token-required")," "))}function Gc(t,d){if(t&1&&(a(0,"mat-form-field",11)(1,"mat-label",2),l(2,"rule-node-config.slack-api-token"),n(),f(3,"input",12),g(4,wc,3,3,"mat-error",4),n()),t&2){let e=v();r(4),p("ngIf",e.slackConfigForm.get("botToken").hasError("required"))}}function jc(t,d){if(t&1&&(a(0,"mat-radio-button",13),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.slackChanelTypesTranslateMap.get(e))," ")}}var Jr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.slackChanelTypes=Object.keys(Jo),this.slackChanelTypesTranslateMap=$o}configForm(){return this.slackConfigForm}onConfigurationSet(e){this.slackConfigForm=this.fb.group({botToken:[e?e.botToken:null],useSystemSettings:[e?e.useSystemSettings:!1],messageTemplate:[e?e.messageTemplate:null,[u.required]],conversationType:[e?e.conversationType:null,[u.required]],conversation:[e?e.conversation:null,[u.required]]})}validatorTriggers(){return["useSystemSettings"]}updateValidators(e){this.slackConfigForm.get("useSystemSettings").value?this.slackConfigForm.get("botToken").clearValidators():this.slackConfigForm.get("botToken").setValidators([u.required]),this.slackConfigForm.get("botToken").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-slack-config"]],features:[M],decls:18,vars:12,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"mat-block","flex-1"],["translate",""],["required","","matInput","","formControlName","messageTemplate"],[4,"ngIf"],["formControlName","useSystemSettings"],["class","mat-block",4,"ngIf"],[1,"tb-title"],["formControlName","conversationType"],[3,"value",4,"ngFor","ngForOf"],["formControlName","conversation","required","",3,"token","slackChanelType"],[1,"mat-block"],["required","","matInput","","formControlName","botToken"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.message-template"),n(),f(4,"input",3),g(5,Pc,3,3,"mat-error",4),a(6,"mat-hint",2),l(7,"rule-node-config.general-pattern-hint"),n()(),a(8,"mat-checkbox",5),l(9),m(10,"translate"),n(),g(11,Gc,5,1,"mat-form-field",6),a(12,"label",7),l(13),m(14,"translate"),n(),a(15,"mat-radio-group",8),g(16,jc,3,4,"mat-radio-button",9),n(),f(17,"tb-slack-conversation-autocomplete",10),n()),i&2&&(p("formGroup",o.slackConfigForm),r(5),p("ngIf",o.slackConfigForm.get("messageTemplate").hasError("required")),r(4),c(" ",s(10,8,"rule-node-config.use-system-slack-settings")," "),r(2),p("ngIf",!o.slackConfigForm.get("useSystemSettings").value),r(2),V(s(14,10,"notification.slack-chanel-type")),r(3),p("ngForOf",o.slackChanelTypes),r(),p("token",o.slackConfigForm.get("useSystemSettings").value?"":o.slackConfigForm.get("botToken").value)("slackChanelType",o.slackConfigForm.get("conversationType").value))},dependencies:[z,k,Ge,R,q,B,se,Q,qo,ko,O,S,x,A,_,E,D,Xo,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .tb-title[_ngcontent-%COMP%]{display:block;padding-bottom:6px}[_nghost-%COMP%]     .mat-mdc-radio-group{display:flex;flex-direction:row;margin-bottom:22px;gap:12px}[_nghost-%COMP%]     .mat-mdc-radio-group .mat-mdc-radio-button{flex:1 1 100%;padding:4px;border:1px solid rgba(0,0,0,.12);border-radius:6px}@media screen and (max-width: 599px){[_nghost-%COMP%]     .mat-mdc-radio-group{flex-direction:column}}']})}}return t})();b();function Uc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.function-name-required")," "))}function Kc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.aws-access-key-id-required")," "))}function Hc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.aws-secret-access-key-required")," "))}function zc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.aws-region-required")," "))}function Qc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.connection-timeout-required")," "))}function Jc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.connection-timeout-min")," "))}function $c(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.request-timeout-required")," "))}function Yc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.request-timeout-min")," "))}var $r=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.lambdaConfigForm}onConfigurationSet(e){this.lambdaConfigForm=this.fb.group({functionName:[e?e.functionName:null,[u.required]],qualifier:[e?e.qualifier:null,[]],accessKey:[e?e.accessKey:null,[u.required]],secretKey:[e?e.secretKey:null,[u.required]],region:[e?e.region:null,[u.required]],connectionTimeout:[e?e.connectionTimeout:null,[u.required,u.min(0)]],requestTimeout:[e?e.requestTimeout:null,[u.required,u.min(0)]],tellFailureIfFuncThrowsExc:[e?e.tellFailureIfFuncThrowsExc:!1,[]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-external-node-lambda-config"]],features:[M],decls:71,vars:28,consts:[[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],[1,"tb-form-panel","stroked"],[1,"tb-form-row","no-padding","no-border"],["translate","",1,"tb-form-panel-title","tb-required"],["popupHelpLink","rulenode/node-templatization-doc",3,"hintText"],[1,"tb-standard-fields"],[1,"mat-block"],["required","","matInput","","formControlName","functionName"],[4,"ngIf"],["matInput","","formControlName","qualifier"],["translate",""],["expanded","",1,"tb-settings"],["required","","matInput","","formControlName","accessKey"],["required","","matInput","","formControlName","secretKey"],["required","","matInput","","formControlName","region"],[1,"tb-form-panel","stroked","no-padding"],[1,"tb-settings"],[2,"padding","16px"],[1,"tb-form-panel","no-border","no-padding","no-gap",2,"margin-top","0"],[1,"tb-form-row","no-border","same-padding","tb-standard-fields"],[1,"flex"],["type","number","required","","min","0","matInput","","formControlName","connectionTimeout"],["matSuffix","","aria-hidden","false","aria-label","help-icon","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],["type","number","required","","min","0","matInput","","formControlName","requestTimeout"],[1,"tb-form-row","no-border",2,"margin-bottom","16px",3,"tb-hint-tooltip-icon"],["formControlName","tellFailureIfFuncThrowsExc",1,"mat-slide"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),l(4,"rule-node-config.function-configuration"),n()(),f(5,"tb-example-hint",4),a(6,"div",5)(7,"mat-form-field",6)(8,"mat-label"),l(9),m(10,"translate"),n(),f(11,"input",7),g(12,Uc,3,3,"mat-error",8),n(),a(13,"mat-form-field",6)(14,"mat-label"),l(15),m(16,"translate"),n(),f(17,"input",9),a(18,"mat-hint",10),l(19,"rule-node-config.qualifier-hint"),n()()()(),a(20,"div",1)(21,"mat-expansion-panel",11)(22,"mat-expansion-panel-header")(23,"mat-panel-title",3),l(24,"rule-node-config.aws-credentials"),n()(),a(25,"div",5)(26,"mat-form-field",6)(27,"mat-label",10),l(28,"rule-node-config.aws-access-key-id"),n(),f(29,"input",12),g(30,Kc,3,3,"mat-error",8),n(),a(31,"mat-form-field",6)(32,"mat-label",10),l(33,"rule-node-config.aws-secret-access-key"),n(),f(34,"input",13),g(35,Hc,3,3,"mat-error",8),n(),a(36,"mat-form-field",6)(37,"mat-label",10),l(38,"rule-node-config.aws-region"),n(),f(39,"input",14),g(40,zc,3,3,"mat-error",8),n()()()(),a(41,"div",15)(42,"mat-expansion-panel",16)(43,"mat-expansion-panel-header",17)(44,"mat-panel-title",10),l(45,"rule-node-config.advanced-settings"),n()(),a(46,"div",18)(47,"div",19)(48,"mat-form-field",20)(49,"mat-label",10),l(50,"rule-node-config.connection-timeout"),n(),f(51,"input",21),g(52,Qc,3,3,"mat-error",8)(53,Jc,3,3,"mat-error",8),a(54,"mat-icon",22),m(55,"translate"),l(56,"help"),n()(),a(57,"mat-form-field",20)(58,"mat-label",10),l(59,"rule-node-config.request-timeout"),n(),f(60,"input",23),g(61,$c,3,3,"mat-error",8)(62,Yc,3,3,"mat-error",8),a(63,"mat-icon",22),m(64,"translate"),l(65,"help"),n()()(),a(66,"div",24),m(67,"translate"),a(68,"mat-slide-toggle",25),l(69),m(70,"translate"),n()()()()()()),i&2&&(p("formGroup",o.lambdaConfigForm),r(5),p("hintText","rule-node-config.template-rules-hint"),r(4),V(s(10,16,"rule-node-config.function-name")),r(3),p("ngIf",o.lambdaConfigForm.get("functionName").hasError("required")),r(3),V(s(16,18,"rule-node-config.qualifier")),r(15),p("ngIf",o.lambdaConfigForm.get("accessKey").hasError("required")),r(5),p("ngIf",o.lambdaConfigForm.get("secretKey").hasError("required")),r(5),p("ngIf",o.lambdaConfigForm.get("region").hasError("required")),r(12),p("ngIf",o.lambdaConfigForm.get("connectionTimeout").hasError("required")),r(),p("ngIf",o.lambdaConfigForm.get("connectionTimeout").hasError("min")),r(),h("matTooltip",s(55,20,"rule-node-config.connection-timeout-hint")),r(7),p("ngIf",o.lambdaConfigForm.get("requestTimeout").hasError("required")),r(),p("ngIf",o.lambdaConfigForm.get("requestTimeout").hasError("min")),r(),h("matTooltip",s(64,22,"rule-node-config.request-timeout-hint")),r(3),h("tb-hint-tooltip-icon",s(67,24,"rule-node-config.tell-failure-aws-lambda-hint")),r(3),c(" ",s(70,26,"rule-node-config.tell-failure-aws-lambda")," "))},dependencies:[k,X,R,q,B,se,Q,oe,Z,de,it,nt,rt,O,fe,S,x,A,ve,_,E,D,ge,Te,I],encapsulation:2})}}return t})();var Mn=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=We({type:t})}static{this.\u0275inj=Ye({imports:[ke,Be,Mt,ft]})}}return t})();(function(){Ze(Mn,{declarations:[Rr,Lr,$r,Pr,wr,Gr,jr,Ur,Kr,Hr,zr,Qr,Jr],imports:[ke,Be,Mt,ft],exports:[Rr,Lr,$r,Pr,wr,Gr,jr,Ur,Kr,Hr,zr,Qr,Jr]})})();b();b();function Wc(t,d){if(t&1&&(a(0,"span"),l(1),m(2,"translate"),n()),t&2){let e=v();r(),c(" ",s(2,1,e.originatorSourceTranslationMap.get(e.changeOriginatorConfigForm.get("originatorSource").value))," ")}}function Xc(t,d){if(t&1&&(a(0,"mat-option",8)(1,"span",9),l(2),m(3,"translate"),n(),f(4,"br"),a(5,"small",10),l(6),m(7,"translate"),n()()),t&2){let e=d.$implicit,i=v();p("value",e),r(2),c(" ",s(3,3,i.originatorSourceTranslationMap.get(e))," "),r(4),c(" ",s(7,5,i.originatorSourceDescTranslationMap.get(e))," ")}}function Zc(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.entity-name-pattern-required")," "))}function ef(t,d){if(t&1&&(a(0,"div",11),f(1,"tb-example-hint",12),a(2,"div",13),f(3,"tb-entity-type-select",14),a(4,"mat-form-field",15)(5,"mat-label",2),l(6,"rule-node-config.entity-name-pattern"),n(),f(7,"input",16),g(8,Zc,3,3,"mat-error",4),n()()()),t&2){let e=v();r(),p("hintText","rule-node-config.entity-name-pattern-hint"),r(2),p("allowedEntityTypes",e.allowedEntityTypes),r(5),p("ngIf",e.changeOriginatorConfigForm.get("entityNamePattern").hasError("required")||e.changeOriginatorConfigForm.get("entityNamePattern").hasError("pattern"))}}function tf(t,d){t&1&&f(0,"tb-relations-query-config",17)}var Yr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.originatorSource=dt,this.originatorSources=Object.keys(dt),this.originatorSourceTranslationMap=ma,this.originatorSourceDescTranslationMap=sa,this.allowedEntityTypes=[Y.DEVICE,Y.ASSET,Y.ENTITY_VIEW,Y.USER,Y.EDGE]}configForm(){return this.changeOriginatorConfigForm}onConfigurationSet(e){this.changeOriginatorConfigForm=this.fb.group({originatorSource:[e?e.originatorSource:null,[u.required]],entityType:[e?e.entityType:null,[]],entityNamePattern:[e?e.entityNamePattern:null,[]],relationsQuery:[e?e.relationsQuery:null,[]]})}validatorTriggers(){return["originatorSource"]}updateValidators(e){let i=this.changeOriginatorConfigForm.get("originatorSource").value;i===dt.RELATED?this.changeOriginatorConfigForm.get("relationsQuery").setValidators([u.required]):this.changeOriginatorConfigForm.get("relationsQuery").setValidators([]),i===dt.ENTITY?(this.changeOriginatorConfigForm.get("entityType").setValidators([u.required]),this.changeOriginatorConfigForm.get("entityNamePattern").setValidators([u.required,u.pattern(/.*\S.*/)])):(this.changeOriginatorConfigForm.get("entityType").patchValue(null,{emitEvent:e}),this.changeOriginatorConfigForm.get("entityNamePattern").patchValue(null,{emitEvent:e}),this.changeOriginatorConfigForm.get("entityType").setValidators([]),this.changeOriginatorConfigForm.get("entityNamePattern").setValidators([])),this.changeOriginatorConfigForm.get("relationsQuery").updateValueAndValidity({emitEvent:e}),this.changeOriginatorConfigForm.get("entityType").updateValueAndValidity({emitEvent:e}),this.changeOriginatorConfigForm.get("entityNamePattern").updateValueAndValidity({emitEvent:e})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-transformation-node-change-originator-config"]],features:[M],decls:10,vars:5,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],["subscriptSizing","dynamic","hideRequiredMarker","",1,"mat-block"],["translate",""],["formControlName","originatorSource","required",""],[4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["class","tb-form-panel stroked no-padding-bottom",4,"ngIf"],["required","","formControlName","relationsQuery",4,"ngIf"],[3,"value"],["matListItemTitle",""],["matListItemMeta","",2,"color","inherit"],[1,"tb-form-panel","stroked","no-padding-bottom"],["popupHelpLink","rulenode/change_originator_node_fields_templatization",3,"hintText"],[1,"tb-form-row","no-border","no-padding","tb-standard-fields"],["showLabel","","required","","formControlName","entityType",1,"mat-mdc-form-field","flex",3,"allowedEntityTypes"],[1,"flex"],["required","","matInput","","formControlName","entityNamePattern"],["required","","formControlName","relationsQuery"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label",2),l(3,"rule-node-config.new-originator"),n(),a(4,"mat-select",3)(5,"mat-select-trigger"),g(6,Wc,3,3,"span",4),n(),g(7,Xc,8,7,"mat-option",5),n()(),g(8,ef,9,3,"div",6)(9,tf,1,0,"tb-relations-query-config",7),n()),i&2&&(p("formGroup",o.changeOriginatorConfigForm),r(6),p("ngIf",o.originatorSourceTranslationMap.get(o.changeOriginatorConfigForm.get("originatorSource").value)),r(),p("ngForOf",o.originatorSources),r(),p("ngIf",o.changeOriginatorConfigForm.get("originatorSource").value===o.originatorSource.ENTITY),r(),p("ngIf",o.changeOriginatorConfigForm.get("originatorSource").value===o.originatorSource.RELATED))},dependencies:[z,k,ri,R,q,B,Q,ee,ii,W,un,cn,O,S,x,A,_,E,D,fi,Te,I],encapsulation:2})}}return t})();b();var nf=["jsFuncComponent"],rf=["tbelFuncComponent"],za=()=>["msg","metadata","msgType"];function of(t,d){t&1&&f(0,"tb-script-lang",7)}function af(t,d){if(t&1){let e=pe();a(0,"tb-js-func",8,0)(2,"button",9),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",10),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(4,za)),r(2),h("matTooltip",s(3,2,e.testScriptLabel))}}function lf(t,d){if(t&1){let e=pe();a(0,"tb-js-func",11,1)(2,"button",9),m(3,"translate"),$("click",function(){ie(e);let o=v();return ne(o.testScript())}),a(4,"mat-icon",10),l(5,"bug_report"),n()()()}if(t&2){let e=v();p("functionArgs",he(6,za))("disableUndefinedCheck",!0)("scriptLanguage",e.scriptLanguage.TBEL),r(2),h("matTooltip",s(3,4,e.testScriptLabel))}}var Wr=(()=>{class t extends N{constructor(e,i,o){super(),this.fb=e,this.nodeScriptTestService=i,this.translate=o,this.tbelEnabled=Ct(this.store).tbelEnabled,this.scriptLanguage=J,this.changeScript=new gt,this.hasScript=!0,this.testScriptLabel="rule-node-config.test-transformer-function"}configForm(){return this.scriptConfigForm}onConfigurationSet(e){this.scriptConfigForm=this.fb.group({scriptLang:[e?e.scriptLang:J.JS,[u.required]],jsScript:[e?e.jsScript:null,[u.required]],tbelScript:[e?e.tbelScript:null,[]]})}validatorTriggers(){return["scriptLang"]}updateValidators(e){let i=this.scriptConfigForm.get("scriptLang").value;i===J.TBEL&&!this.tbelEnabled&&(i=J.JS,this.scriptConfigForm.get("scriptLang").patchValue(i,{emitEvent:!1}),setTimeout(()=>{this.scriptConfigForm.updateValueAndValidity({emitEvent:!0})})),this.scriptConfigForm.get("jsScript").setValidators(i===J.JS?[u.required]:[]),this.scriptConfigForm.get("jsScript").updateValueAndValidity({emitEvent:e}),this.scriptConfigForm.get("tbelScript").setValidators(i===J.TBEL?[u.required]:[]),this.scriptConfigForm.get("tbelScript").updateValueAndValidity({emitEvent:e})}prepareInputConfig(e){return e&&(e.scriptLang||(e.scriptLang=J.JS)),e}testScript(e){let i=this.scriptConfigForm.get("scriptLang").value,o=i===J.JS?"jsScript":"tbelScript",C=i===J.JS?"rulenode/transformation_node_script_fn":"rulenode/tbel/transformation_node_script_fn",H=this.scriptConfigForm.get(o).value;this.nodeScriptTestService.testNodeScript(H,"update",this.translate.instant("rule-node-config.transformer"),"Transform",["msg","metadata","msgType"],this.ruleNodeId,C,i,e).subscribe(Ce=>{Ce&&(this.scriptConfigForm.get(o).setValue(Ce),this.changeScript.emit())})}onValidate(){this.scriptConfigForm.get("scriptLang").value===J.JS&&this.jsFuncComponent.validateOnSubmit()}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(ht),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-transformation-node-script-config"]],viewQuery:function(i,o){if(i&1&&(De(nf,5),De(rf,5)),i&2){let C;Ve(C=qe())&&(o.jsFuncComponent=C.first),Ve(C=qe())&&(o.tbelFuncComponent=C.first)}},features:[M],decls:8,vars:7,consts:[["jsFuncComponent",""],["tbelFuncComponent",""],[3,"formGroup"],["formControlName","scriptLang",4,"ngIf"],["formControlName","jsScript","functionName","Transform","helpId","rulenode/transformation_node_script_fn","noValidate","true",3,"functionArgs",4,"ngIf"],["formControlName","tbelScript","functionName","Transform","helpId","rulenode/tbel/transformation_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage",4,"ngIf"],["mat-button","","mat-raised-button","","color","primary",3,"click"],["formControlName","scriptLang"],["formControlName","jsScript","functionName","Transform","helpId","rulenode/transformation_node_script_fn","noValidate","true",3,"functionArgs"],["toolbarSuffixButton","","mat-icon-button","","matTooltipPosition","above",1,"tb-mat-32",3,"click","matTooltip"],["color","primary",1,"material-icons"],["formControlName","tbelScript","functionName","Transform","helpId","rulenode/tbel/transformation_node_script_fn","noValidate","true",3,"functionArgs","disableUndefinedCheck","scriptLanguage"]],template:function(i,o){i&1&&(a(0,"section",2),g(1,of,1,0,"tb-script-lang",3)(2,af,6,5,"tb-js-func",4)(3,lf,6,7,"tb-js-func",5),a(4,"div")(5,"button",6),$("click",function(){return o.testScript()}),l(6),m(7,"translate"),n()()()),i&2&&(p("formGroup",o.scriptConfigForm),r(),p("ngIf",o.tbelEnabled),r(),p("ngIf",o.scriptConfigForm.get("scriptLang").value===o.scriptLanguage.JS),r(),p("ngIf",o.scriptConfigForm.get("scriptLang").value===o.scriptLanguage.TBEL),r(3),c(" ",s(7,5,o.testScriptLabel)," "))},dependencies:[k,vt,we,_e,X,Z,S,x,_,E,Et,I],encapsulation:2})}}return t})();b();var pf=()=>({maxWidth:"820px"});function mf(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.from-template-required")," "))}function sf(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.to-template-required")," "))}function df(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.subject-template-required")," "))}function uf(t,d){if(t&1&&(a(0,"span"),l(1),m(2,"translate"),n()),t&2){let e=v();r(),c(" ",s(2,1,e.getBodyTypeName())," ")}}function cf(t,d){if(t&1&&(a(0,"mat-option",24)(1,"span",25),l(2),m(3,"translate"),n(),f(4,"br"),a(5,"small",26),l(6),m(7,"translate"),n()()),t&2){let e=d.$implicit;p("value",e.value),r(2),c(" ",s(3,3,e.name)," "),r(4),c(" ",s(7,5,e.description)," ")}}function ff(t,d){t&1&&(a(0,"mat-form-field",18)(1,"mat-label",5),l(2,"rule-node-config.body-type-template"),n(),f(3,"input",27),a(4,"mat-hint",5),l(5,"rule-node-config.mail-body-types.after-template-evaluation-hint"),n()())}function gf(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.body-template-required")," "))}var Xr=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.mailBodyTypes=[{name:"rule-node-config.mail-body-types.plain-text",description:"rule-node-config.mail-body-types.plain-text-description",value:"false"},{name:"rule-node-config.mail-body-types.html",description:"rule-node-config.mail-body-types.html-text-description",value:"true"},{name:"rule-node-config.mail-body-types.use-body-type-template",description:"rule-node-config.mail-body-types.dynamic-text-description",value:"dynamic"}]}configForm(){return this.toEmailConfigForm}onConfigurationSet(e){this.toEmailConfigForm=this.fb.group({fromTemplate:[e?e.fromTemplate:null,[u.required]],toTemplate:[e?e.toTemplate:null,[u.required]],ccTemplate:[e?e.ccTemplate:null,[]],bccTemplate:[e?e.bccTemplate:null,[]],subjectTemplate:[e?e.subjectTemplate:null,[u.required]],mailBodyType:[e?e.mailBodyType:null],isHtmlTemplate:[e?e.isHtmlTemplate:null,[u.required]],bodyTemplate:[e?e.bodyTemplate:null,[u.required]]})}prepareInputConfig(e){return{fromTemplate:F(e?.fromTemplate)?e.fromTemplate:null,toTemplate:F(e?.toTemplate)?e.toTemplate:null,ccTemplate:F(e?.ccTemplate)?e.ccTemplate:null,bccTemplate:F(e?.bccTemplate)?e.bccTemplate:null,subjectTemplate:F(e?.subjectTemplate)?e.subjectTemplate:null,mailBodyType:F(e?.mailBodyType)?e.mailBodyType:null,isHtmlTemplate:F(e?.isHtmlTemplate)?e.isHtmlTemplate:null,bodyTemplate:F(e?.bodyTemplate)?e.bodyTemplate:null}}updateValidators(e){this.toEmailConfigForm.get("mailBodyType").value==="dynamic"?this.toEmailConfigForm.get("isHtmlTemplate").enable({emitEvent:!1}):this.toEmailConfigForm.get("isHtmlTemplate").disable({emitEvent:!1}),this.toEmailConfigForm.get("isHtmlTemplate").updateValueAndValidity({emitEvent:e})}validatorTriggers(){return["mailBodyType"]}getBodyTypeName(){return this.mailBodyTypes.find(e=>e.value===this.toEmailConfigForm.get("mailBodyType").value).name}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-transformation-node-to-email-config"]],features:[M],decls:59,vars:19,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],[1,"tb-form-panel","stroked"],["translate","",1,"tb-form-panel-title"],[1,"tb-form-row","no-border","no-padding","tb-standard-fields"],["subscriptSizing","dynamic",1,"flex"],["translate",""],["required","","matInput","","formControlName","fromTemplate"],["align","start"],["align","end"],[1,"input-bottom-double-hint"],["hintMode","","tb-help-popup-placement","right","trigger-style","letter-spacing:0.25px; font-size:12px;",1,"see-example",3,"tb-help-popup","tb-help-popup-style","trigger-text"],[4,"ngIf"],[1,"tb-form-panel","no-padding","no-border"],["popupHelpLink","rulenode/to_email_node_fields_templatization",3,"hintText"],[1,"flex"],["required","","matInput","","formControlName","toTemplate","cdkTextareaAutosize","","cdkAutosizeMinRows","1",1,"tb-enable-vertical-resize"],["matInput","","formControlName","ccTemplate","cdkTextareaAutosize","","cdkAutosizeMinRows","1",1,"tb-enable-vertical-resize"],["matInput","","formControlName","bccTemplate","cdkTextareaAutosize","","cdkAutosizeMinRows","1",1,"tb-enable-vertical-resize"],[1,"mat-block"],["required","","matInput","","formControlName","subjectTemplate","cdkTextareaAutosize","","cdkAutosizeMinRows","1",1,"tb-enable-vertical-resize"],["formControlName","mailBodyType"],[3,"value",4,"ngFor","ngForOf"],["class","mat-block",4,"ngIf"],["required","","matInput","","formControlName","bodyTemplate","cdkTextareaAutosize","","cdkAutosizeMinRows","2",1,"tb-enable-vertical-resize"],[3,"value"],["matListItemTitle",""],["matListItemMeta","",2,"color","inherit"],["required","","matInput","","formControlName","isHtmlTemplate"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2),l(3,"rule-node-config.email-sender"),n(),a(4,"div",3)(5,"mat-form-field",4)(6,"mat-label",5),l(7,"rule-node-config.from-template"),n(),f(8,"input",6),a(9,"mat-hint",7),l(10),m(11,"translate"),n(),a(12,"mat-hint",8)(13,"div",9),f(14,"div",10),m(15,"translate"),n()(),g(16,mf,3,3,"mat-error",11),n()()(),a(17,"div",1)(18,"div",12)(19,"div",2),l(20,"rule-node-config.recipients"),n(),f(21,"tb-example-hint",13),n(),a(22,"div",3)(23,"mat-form-field",14)(24,"mat-label",5),l(25,"rule-node-config.to-template"),n(),f(26,"textarea",15),g(27,sf,3,3,"mat-error",11),n(),a(28,"mat-form-field",14)(29,"mat-label",5),l(30,"rule-node-config.cc-template"),n(),f(31,"textarea",16),n(),a(32,"mat-form-field",14)(33,"mat-label",5),l(34,"rule-node-config.bcc-template"),n(),f(35,"textarea",17),n()()(),a(36,"div",1)(37,"div",2),l(38,"rule-node-config.message-subject-and-content"),n(),f(39,"tb-example-hint",13),a(40,"section")(41,"mat-form-field",18)(42,"mat-label",5),l(43,"rule-node-config.subject-template"),n(),f(44,"textarea",19),g(45,df,3,3,"mat-error",11),n(),a(46,"mat-form-field",18)(47,"mat-label",5),l(48,"rule-node-config.mail-body-type"),n(),a(49,"mat-select",20)(50,"mat-select-trigger"),g(51,uf,3,3,"span",11),n(),g(52,cf,8,7,"mat-option",21),n()(),g(53,ff,6,0,"mat-form-field",22),a(54,"mat-form-field",18)(55,"mat-label",5),l(56,"rule-node-config.body-template"),n(),f(57,"textarea",23),g(58,gf,3,3,"mat-error",11),n()()()()),i&2&&(p("formGroup",o.toEmailConfigForm),r(10),c(" ",s(11,14,"rule-node-config.email-from-template-hint")," "),r(4),h("tb-help-popup","rulenode/to_email_node_fields_templatization"),h("trigger-text",s(15,16,"rule-node-config.key-val.see-examples")),p("tb-help-popup-style",he(18,pf)),r(2),p("ngIf",o.toEmailConfigForm.get("fromTemplate").hasError("required")),r(5),p("hintText","rule-node-config.recipients-block-main-hint"),r(6),p("ngIf",o.toEmailConfigForm.get("toTemplate").hasError("required")),r(12),p("hintText","rule-node-config.kv-map-pattern-hint"),r(6),p("ngIf",o.toEmailConfigForm.get("subjectTemplate").hasError("required")),r(6),p("ngIf",o.toEmailConfigForm.get("mailBodyType").value),r(),p("ngForOf",o.mailBodyTypes),r(),p("ngIf",o.toEmailConfigForm.get("mailBodyType").value==="dynamic"),r(5),p("ngIf",o.toEmailConfigForm.get("bodyTemplate").hasError("required")))},dependencies:[z,k,ni,R,q,B,se,Q,Vo,ee,ii,W,un,cn,O,S,x,A,_,E,D,Te,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .input-bottom-double-hint[_ngcontent-%COMP%]{display:inline-flex}[_nghost-%COMP%]   .input-bottom-double-hint[_ngcontent-%COMP%]   .see-example[_ngcontent-%COMP%]{flex-shrink:0;padding-right:16px}[_nghost-%COMP%]   textarea.tb-enable-vertical-resize[_ngcontent-%COMP%]{resize:vertical}']})}}return t})();b();var Zr=(()=>{class t extends N{constructor(e,i){super(),this.fb=e,this.translate=i,this.copyFrom=[],this.translation=_a;for(let o of this.translation.keys())this.copyFrom.push({value:o,name:this.translate.instant(this.translation.get(o))})}onConfigurationSet(e){this.copyKeysConfigForm=this.fb.group({copyFrom:[e.copyFrom,[u.required]],keys:[e?e.keys:null,[u.required]]})}configForm(){return this.copyKeysConfigForm}prepareInputConfig(e){let i;return F(e?.fromMetadata)?i=e.copyFrom?ye.METADATA:ye.DATA:F(e?.copyFrom)?i=e.copyFrom:i=ye.DATA,{keys:F(e?.keys)?e.keys:null,copyFrom:i}}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-transformation-node-copy-keys-config"]],features:[M],decls:10,vars:17,consts:[[1,"tb-form-panel","no-padding","no-border",3,"formGroup"],["formControlName","copyFrom",3,"labelText","translation"],["required","","formControlName","keys",1,"mat-block",3,"label","placeholder","requiredText"],["matSuffix","","aria-hidden","false","aria-label","help-icon","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"]],template:function(i,o){i&1&&(a(0,"section",0),f(1,"tb-msg-metadata-chip",1),m(2,"translate"),a(3,"tb-string-items-list",2),m(4,"translate"),m(5,"translate"),m(6,"translate"),a(7,"mat-icon",3),m(8,"translate"),l(9," help "),n()()()),i&2&&(p("formGroup",o.copyKeysConfigForm),r(),p("labelText",s(2,7,"rule-node-config.key-val.copy-key-values-from"))("translation",o.translation),r(2),p("label",s(4,9,"rule-node-config.keys"))("placeholder",s(5,11,"rule-node-config.add-key"))("requiredText",s(6,13,"rule-node-config.key-val.at-least-one-key-error")),r(4),h("matTooltip",s(8,15,"rule-node-config.use-regular-expression-hint")))},dependencies:[It,X,oe,Z,S,x,A,_,E,Le,I],encapsulation:2})}}return t})();b();function Cf(t,d){if(t&1&&(a(0,"tb-toggle-option",7),l(1),n()),t&2){let e=d.$implicit;p("value",e.value),r(),c(" ",e.name," ")}}var eo=(()=>{class t extends N{constructor(e,i){super(),this.fb=e,this.translate=i,this.renameIn=[],this.translation=Sa;for(let o of this.translation.keys())this.renameIn.push({value:o,name:this.translate.instant(this.translation.get(o))})}configForm(){return this.renameKeysConfigForm}onConfigurationSet(e){this.renameKeysConfigForm=this.fb.group({renameIn:[e?e.renameIn:null,[u.required]],renameKeysMapping:[e?e.renameKeysMapping:null,[u.required]]})}prepareInputConfig(e){let i;return F(e?.fromMetadata)?i=e.fromMetadata?ye.METADATA:ye.DATA:F(e?.renameIn)?i=e?.renameIn:i=ye.DATA,{renameKeysMapping:F(e?.renameKeysMapping)?e.renameKeysMapping:null,renameIn:i}}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-transformation-node-rename-keys-config"]],features:[M],decls:15,vars:24,consts:[[1,"tb-form-panel","stroked",3,"formGroup"],["translate","",1,"tb-form-panel-title"],[1,"fx-centered"],[1,"fetch-to-data-toggle"],["formControlName","renameIn","appearance","fill",1,"fetch-to-data-toggle"],[3,"value",4,"ngFor","ngForOf"],["required","","formControlName","renameKeysMapping","uniqueKeyValuePairValidator","",3,"labelText","requiredText","keyText","keyRequiredText","valText","valRequiredText"],[3,"value"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1),l(2,"rule-node-config.rename-keys-in"),n(),a(3,"div",2)(4,"div",3)(5,"tb-toggle-select",4),g(6,Cf,2,2,"tb-toggle-option",5),n()()(),f(7,"tb-kv-map-config",6),m(8,"translate"),m(9,"translate"),m(10,"translate"),m(11,"translate"),m(12,"translate"),m(13,"translate"),m(14,"translate"),n()),i&2&&(p("formGroup",o.renameKeysConfigForm),r(6),p("ngForOf",o.renameIn),r(),ho("labelText","",s(8,10,o.translation.get(o.renameKeysConfigForm.get("renameIn").value))," ",s(9,12,"rule-node-config.keys-mapping"),""),h("requiredText",s(10,14,"rule-node-config.attr-mapping-required")),h("keyText",s(11,16,"rule-node-config.current-key-name")),h("keyRequiredText",s(12,18,"rule-node-config.key-name-required")),h("valText",s(13,20,"rule-node-config.new-key-name")),h("valRequiredText",s(14,22,"rule-node-config.new-key-name-required")))},dependencies:[z,S,x,A,_,E,D,Qe,Je,lt,I],styles:['@charset "UTF-8";[_nghost-%COMP%]   .fetch-to-data-toggle[_ngcontent-%COMP%]{max-width:420px;width:100%}[_nghost-%COMP%]   .fx-centered[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-around}']})}}return t})();b();function yf(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),V(s(2,1,"rule-node-config.json-path-expression-required")))}var to=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.jsonPathConfigForm}onConfigurationSet(e){this.jsonPathConfigForm=this.fb.group({jsonPath:[e?e.jsonPath:null,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-transformation-node-json-path-config"]],features:[M],decls:10,vars:8,consts:[[3,"formGroup"],["subscriptSizing","dynamic",1,"mat-block"],["matInput","","formControlName","jsonPath","required",""],[4,"ngIf"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label"),l(3),m(4,"translate"),n(),f(5,"input",2),a(6,"mat-hint"),l(7),m(8,"translate"),n(),g(9,yf,3,3,"mat-error",3),n()()),i&2&&(p("formGroup",o.jsonPathConfigForm),r(3),V(s(4,4,"rule-node-config.json-path-expression")),r(4),V(s(8,6,"rule-node-config.json-path-expression-hint")),r(2),p("ngIf",o.jsonPathConfigForm.get("jsonPath").hasError("required")))},dependencies:[k,R,q,B,se,Q,O,S,x,A,_,E,I],encapsulation:2})}}return t})();b();var io=(()=>{class t extends N{constructor(e,i){super(),this.fb=e,this.translate=i,this.deleteFrom=[],this.translation=bn;for(let o of this.translation.keys())this.deleteFrom.push({value:o,name:this.translate.instant(this.translation.get(o))})}onConfigurationSet(e){this.deleteKeysConfigForm=this.fb.group({deleteFrom:[e.deleteFrom,[u.required]],keys:[e?e.keys:null,[u.required]]})}prepareInputConfig(e){let i;return F(e?.fromMetadata)?i=e.fromMetadata?ye.METADATA:ye.DATA:F(e?.deleteFrom)?i=e?.deleteFrom:i=ye.DATA,{keys:F(e?.keys)?e.keys:null,deleteFrom:i}}configForm(){return this.deleteKeysConfigForm}static{this.\u0275fac=function(i){return new(i||t)(y(w),y(le))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-transformation-node-delete-keys-config"]],features:[M],decls:10,vars:16,consts:[[1,"tb-form-panel","no-border","no-padding",3,"formGroup"],["formControlName","deleteFrom",3,"labelText"],["required","","formControlName","keys",1,"mat-block",3,"label","placeholder","requiredText"],["matSuffix","","aria-hidden","false","aria-label","help-icon","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"]],template:function(i,o){i&1&&(a(0,"section",0),f(1,"tb-msg-metadata-chip",1),m(2,"translate"),a(3,"tb-string-items-list",2),m(4,"translate"),m(5,"translate"),m(6,"translate"),a(7,"mat-icon",3),m(8,"translate"),l(9," help "),n()()()),i&2&&(p("formGroup",o.deleteKeysConfigForm),r(),p("labelText",s(2,6,"rule-node-config.key-val.delete-key-values-from")),r(2),p("label",s(4,8,"rule-node-config.keys"))("placeholder",s(5,10,"rule-node-config.add-key"))("requiredText",s(6,12,"rule-node-config.key-val.at-least-one-key-error")),r(4),h("matTooltip",s(8,14,"rule-node-config.use-regular-expression-delete-hint")))},dependencies:[It,X,oe,Z,S,x,A,_,E,Le,I],encapsulation:2})}}return t})();b();function vf(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.interval-required")," "))}function hf(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.interval-min-error")," "))}function bf(t,d){if(t&1&&(a(0,"tb-toggle-option",18),l(1),m(2,"translate"),n()),t&2){let e=d.$implicit,i=v();p("value",e),r(),c(" ",s(2,2,i.deduplicationStrategiesTranslations.get(e))," ")}}function Tf(t,d){t&1&&f(0,"tb-example-hint",19),t&2&&p("hintText","rule-node-config.strategy-all-hint")}function xf(t,d){t&1&&f(0,"tb-example-hint",20),t&2&&p("hintText","rule-node-config.strategy-first-hint")}function _f(t,d){t&1&&f(0,"tb-example-hint",20),t&2&&p("hintText","rule-node-config.strategy-last-hint")}function Sf(t,d){t&1&&(a(0,"div"),f(1,"tb-output-message-type-autocomplete",21),n())}function Ff(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-pending-msgs-required")," "))}function If(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-pending-msgs-max-error")," "))}function Ef(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-pending-msgs-min-error")," "))}function Mf(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-retries-required")," "))}function Nf(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-retries-max-error")," "))}function Af(t,d){t&1&&(a(0,"mat-error"),l(1),m(2,"translate"),n()),t&2&&(r(),c(" ",s(2,1,"rule-node-config.max-retries-min-error")," "))}var no=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.deduplicationStrategie=bt,this.deduplicationStrategies=Object.keys(this.deduplicationStrategie),this.deduplicationStrategiesTranslations=Pi}configForm(){return this.deduplicationConfigForm}onConfigurationSet(e){this.deduplicationConfigForm=this.fb.group({interval:[F(e?.interval)?e.interval:null,[u.required,u.min(1)]],strategy:[F(e?.strategy)?e.strategy:null,[u.required]],outMsgType:[F(e?.outMsgType)?e.outMsgType:null,[u.required]],maxPendingMsgs:[F(e?.maxPendingMsgs)?e.maxPendingMsgs:null,[u.required,u.min(1),u.max(1e3)]],maxRetries:[F(e?.maxRetries)?e.maxRetries:null,[u.required,u.min(0),u.max(100)]]})}prepareInputConfig(e){return e||(e={}),e.outMsgType||(e.outMsgType="POST_TELEMETRY_REQUEST"),super.prepareInputConfig(e)}updateValidators(e){this.deduplicationConfigForm.get("strategy").value===this.deduplicationStrategie.ALL?this.deduplicationConfigForm.get("outMsgType").enable({emitEvent:!1}):this.deduplicationConfigForm.get("outMsgType").disable({emitEvent:!1}),this.deduplicationConfigForm.get("outMsgType").updateValueAndValidity({emitEvent:e})}validatorTriggers(){return["strategy"]}static{this.\u0275fac=function(i){return new(i||t)(y(w))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-transformation-node-deduplication-config"]],features:[M],decls:49,vars:32,consts:[[3,"formGroup"],[1,"mat-block"],["type","number","required","","matInput","","formControlName","interval"],[4,"ngIf"],["matSuffix","","aria-hidden","false","aria-label","help-icon","color","primary",1,"help-icon","margin-8","cursor-pointer",3,"matTooltip"],[1,"tb-form-panel","no-padding","no-border"],[1,"tb-form-panel","stroked"],["translate","",1,"tb-form-panel-title","tb-required"],["formControlName","strategy","appearance","fill",1,"fetch-to-data-toggle"],[3,"value",4,"ngFor","ngForOf"],[3,"hintText",4,"ngIf"],["textAlign","'center'",3,"hintText",4,"ngIf"],[1,"tb-settings"],["translate",""],[1,"tb-form-row","no-border","no-padding","tb-standard-fields"],[1,"flex"],["type","number","required","","matInput","","formControlName","maxPendingMsgs"],["type","number","required","","matInput","","formControlName","maxRetries"],[3,"value"],[3,"hintText"],["textAlign","'center'",3,"hintText"],["required","","formControlName","outMsgType"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"mat-form-field",1)(2,"mat-label"),l(3),m(4,"translate"),n(),f(5,"input",2),g(6,vf,3,3,"mat-error",3)(7,hf,3,3,"mat-error",3),a(8,"mat-icon",4),m(9,"translate"),l(10,"help"),n()(),a(11,"div",5)(12,"div",6)(13,"div",7),l(14,"rule-node-config.strategy"),n(),a(15,"tb-toggle-select",8),g(16,bf,3,4,"tb-toggle-option",9),n(),g(17,Tf,1,1,"tb-example-hint",10)(18,xf,1,1,"tb-example-hint",11)(19,_f,1,1,"tb-example-hint",11)(20,Sf,2,0,"div",3),n(),a(21,"section",6)(22,"mat-expansion-panel",12)(23,"mat-expansion-panel-header")(24,"mat-panel-title",13),l(25,"rule-node-config.advanced-settings"),n()(),a(26,"div",14)(27,"mat-form-field",15)(28,"mat-label"),l(29),m(30,"translate"),n(),f(31,"input",16),g(32,Ff,3,3,"mat-error",3)(33,If,3,3,"mat-error",3)(34,Ef,3,3,"mat-error",3),a(35,"mat-icon",4),m(36,"translate"),l(37,"help"),n()(),a(38,"mat-form-field",15)(39,"mat-label"),l(40),m(41,"translate"),n(),f(42,"input",17),g(43,Mf,3,3,"mat-error",3)(44,Nf,3,3,"mat-error",3)(45,Af,3,3,"mat-error",3),a(46,"mat-icon",4),m(47,"translate"),l(48,"help"),n()()()()()()()),i&2&&(p("formGroup",o.deduplicationConfigForm),r(3),V(s(4,20,"rule-node-config.interval")),r(3),p("ngIf",o.deduplicationConfigForm.get("interval").hasError("required")),r(),p("ngIf",o.deduplicationConfigForm.get("interval").hasError("min")),r(),h("matTooltip",s(9,22,"rule-node-config.interval-hint")),r(8),p("ngForOf",o.deduplicationStrategies),r(),p("ngIf",o.deduplicationConfigForm.get("strategy").value==="ALL"),r(),p("ngIf",o.deduplicationConfigForm.get("strategy").value==="FIRST"),r(),p("ngIf",o.deduplicationConfigForm.get("strategy").value==="LAST"),r(),p("ngIf",o.deduplicationConfigForm.get("strategy").value===o.deduplicationStrategie.ALL),r(9),V(s(30,24,"rule-node-config.max-pending-msgs")),r(3),p("ngIf",o.deduplicationConfigForm.get("maxPendingMsgs").hasError("required")),r(),p("ngIf",o.deduplicationConfigForm.get("maxPendingMsgs").hasError("max")),r(),p("ngIf",o.deduplicationConfigForm.get("maxPendingMsgs").hasError("min")),r(),h("matTooltip",s(36,26,"rule-node-config.max-pending-msgs-hint")),r(5),V(s(41,28,"rule-node-config.max-retries")),r(3),p("ngIf",o.deduplicationConfigForm.get("maxRetries").hasError("required")),r(),p("ngIf",o.deduplicationConfigForm.get("maxRetries").hasError("max")),r(),p("ngIf",o.deduplicationConfigForm.get("maxRetries").hasError("min")),r(),h("matTooltip",s(47,30,"rule-node-config.max-retries-hint")))},dependencies:[z,k,X,R,q,B,Q,oe,Z,it,nt,rt,O,fe,S,x,A,_,E,D,Qe,Je,Ut,Te,I],encapsulation:2})}}return t})();var Nn=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=We({type:t})}static{this.\u0275inj=Ye({imports:[ke,Be,ft]})}}return t})();(function(){Ze(Nn,{declarations:[Yr,Wr,Xr,Zr,eo,to,io,no],imports:[ke,Be,ft],exports:[Yr,Wr,Xr,Zr,eo,to,io,no]})})();b();b();var Df=t=>[t],ro=(()=>{class t extends N{constructor(e){super(),this.fb=e,this.entityType=Y}configForm(){return this.ruleChainInputConfigForm}onConfigurationSet(e){this.ruleChainInputConfigForm=this.fb.group({forwardMsgToDefaultRuleChain:[e?e?.forwardMsgToDefaultRuleChain:!1,[]],ruleChainId:[e?e.ruleChainId:null,[u.required]]})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-flow-node-rule-chain-input-config"]],features:[M],decls:8,vars:12,consts:[[1,"flex","flex-col",3,"formGroup"],[1,"tb-form-panel","no-padding","no-border"],[1,"tb-form-row","no-border",3,"tb-hint-tooltip-icon"],["formControlName","forwardMsgToDefaultRuleChain",1,"mat-slide"],["required","","formControlName","ruleChainId",3,"excludeEntityIds","entityType","entitySubtype"]],template:function(i,o){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2),m(3,"translate"),a(4,"mat-slide-toggle",3),l(5),m(6,"translate"),n()(),f(7,"tb-entity-autocomplete",4),n()()),i&2&&(p("formGroup",o.ruleChainInputConfigForm),r(2),h("tb-hint-tooltip-icon",s(3,6,"rule-node-config.forward-msg-default-rule-chain-tooltip")),r(3),c(" ",s(6,8,"rule-node-config.forward-msg-default-rule-chain")," "),r(2),p("excludeEntityIds",Fe(10,Df,o.ruleChainId))("entityType",o.entityType.RULE_CHAIN)("entitySubtype",o.ruleChainType))},dependencies:[Cn,de,S,x,A,_,E,ge,I],encapsulation:2})}}return t})();b();var oo=(()=>{class t extends N{constructor(e){super(),this.fb=e}configForm(){return this.ruleChainOutputConfigForm}onConfigurationSet(e){this.ruleChainOutputConfigForm=this.fb.group({})}static{this.\u0275fac=function(i){return new(i||t)(y(G))}}static{this.\u0275cmp=T({type:t,selectors:[["tb-flow-node-rule-chain-output-config"]],features:[M],decls:3,vars:4,consts:[[1,"flex","flex-col",3,"formGroup"],[3,"innerHTML"]],template:function(i,o){i&1&&(a(0,"section",0),f(1,"div",1),m(2,"translate"),n()),i&2&&(p("formGroup",o.ruleChainOutputConfigForm),r(),h("innerHTML",s(2,2,"rule-node-config.output-node-name-hint"),Pe))},dependencies:[x,_,I],encapsulation:2})}}return t})();var An=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=We({type:t})}static{this.\u0275inj=Ye({imports:[ke,Be]})}}return t})();(function(){Ze(An,{declarations:[ro,oo],imports:[ke,Be],exports:[ro,oo]})})();var Dn=(()=>{class t{constructor(e){this.ruleChainService=e,this.ruleChainService.registerSystemRuleNodeConfigModule(this.constructor)}static{this.\u0275fac=function(i){return new(i||t)(so(Lo))}}static{this.\u0275mod=We({type:t})}static{this.\u0275inj=Ye({imports:[ke,Be,Fn,In,En,Mn,Nn,An]})}}return t})();(function(){Ze(Dn,{declarations:[On],imports:[ke,Be],exports:[Fn,In,En,Mn,Nn,An,On]})})();var Vf=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=We({type:t})}static{this.\u0275inj=Ye({imports:[ke,Be,Bn,Dn,Mt]})}}return t})();(function(){Ze(Vf,{declarations:[oa,ia,na,ra,ta,aa,la,pa],imports:[ke,Be,Zo,Bn,Dn,Mt]})})();export{Vf as RuleChainPageModule};
