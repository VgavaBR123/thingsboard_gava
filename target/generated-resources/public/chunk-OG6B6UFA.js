import{Id as te,M as X,N as C,T as d,Za as j,aa as S,ba as V,ee as D,y as q}from"./chunk-HA3FE6NY.js";import{Ag as _,Bg as Z,Cg as J,Dg as z,Eh as ee,Fa as y,Ia as F,Jg as G,Lg as h,Ma as p,Vg as E,Yf as B,Zg as Y,_f as O,be as K,bf as U,e as P,hg as Q,jg as b,kg as x,mb as k,nh as v,oa as N,sf as L,sg as H,te as W,tf as w,vb as I,xe as $}from"./chunk-PQ6EZO2H.js";import{i as c}from"./chunk-GHMOB5KC.js";c();c();var R=new F("WindowToken"),m=class{get nativeWindow(){throw new Error("Not implemented.")}},de=(()=>{class a extends m{constructor(){super()}get nativeWindow(){return window}static{this.\u0275fac=function(t){return new(t||a)}}static{this.\u0275prov=y({token:a,factory:a.\u0275fac})}}return a})();function ce(a,f){return $(f)?a.nativeWindow:new Object}var ue={provide:m,useClass:de},pe={provide:R,useFactory:ce,deps:[m,I]},be=[ue,pe];c();var re={red:{50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},pink:{50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",A100:"#ff80ab",A200:"#ff4081",A400:"#f50057",A700:"#c51162"},purple:{50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},"deep-purple":{50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",A100:"#b388ff",A200:"#7c4dff",A400:"#651fff",A700:"#6200ea"},indigo:{50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",A100:"#8c9eff",A200:"#536dfe",A400:"#3d5afe",A700:"#304ffe"},blue:{50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},"light-blue":{50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},cyan:{50:"#e0f7fa",100:"#b2ebf2",200:"#80deea",300:"#4dd0e1",400:"#26c6da",500:"#00bcd4",600:"#00acc1",700:"#0097a7",800:"#00838f",900:"#006064",A100:"#84ffff",A200:"#18ffff",A400:"#00e5ff",A700:"#00b8d4"},teal:{50:"#e0f2f1",100:"#b2dfdb",200:"#80cbc4",300:"#4db6ac",400:"#26a69a",500:"#009688",600:"#00897b",700:"#00796b",800:"#00695c",900:"#004d40",A100:"#a7ffeb",A200:"#64ffda",A400:"#1de9b6",A700:"#00bfa5"},green:{50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},"light-green":{50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",A100:"#ccff90",A200:"#b2ff59",A400:"#76ff03",A700:"#64dd17"},lime:{50:"#f9fbe7",100:"#f0f4c3",200:"#e6ee9c",300:"#dce775",400:"#d4e157",500:"#cddc39",600:"#c0ca33",700:"#afb42b",800:"#9e9d24",900:"#827717",A100:"#f4ff81",A200:"#eeff41",A400:"#c6ff00",A700:"#aeea00"},yellow:{50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",A100:"#ffff8d",A200:"#ffff00",A400:"#ffea00",A700:"#ffd600"},amber:{50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00",A100:"#ffe57f",A200:"#ffd740",A400:"#ffc400",A700:"#ffab00"},orange:{50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},"deep-orange":{50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",A100:"#ff9e80",A200:"#ff6e40",A400:"#ff3d00",A700:"#dd2c00"},brown:{50:"#efebe9",100:"#d7ccc8",200:"#bcaaa4",300:"#a1887f",400:"#8d6e63",500:"#795548",600:"#6d4c41",700:"#5d4037",800:"#4e342e",900:"#3e2723",A100:"#d7ccc8",A200:"#bcaaa4",A400:"#8d6e63",A700:"#5d4037"},grey:{50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#ffffff",A200:"#000000",A400:"#303030",A700:"#616161"},"blue-grey":{50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",400:"#78909c",500:"#607d8b",600:"#546e7a",700:"#455a64",800:"#37474f",900:"#263238",A100:"#cfd8dc",A200:"#b0bec5",A400:"#78909c",A700:"#455a64"}},g=new Array,ae=["blue","green","red","amber","blue-grey","purple","light-green","indigo","pink","yellow","light-blue","orange","deep-purple","lime","teal","brown","cyan","deep-orange","grey"],M=["500","A700","600","700","800","900","300","400","A200","A400"];for(let a of Object.keys(re)){let f=re[a];for(let e of Object.keys(f))if(M.indexOf(e)>-1){let t=f[e],r=ee(t),n=r.isDark(),i={value:r.toHexString(),group:a,label:e,isDark:n};g.push(i)}}g.sort((a,f)=>{let e=M.indexOf(a.label),t=M.indexOf(f.label),r=e-t;if(r===0){let n=ae.indexOf(a.group),i=ae.indexOf(f.group);r=n-i}return r});c();var l=function(){this.cssImportStatements=[],this.cssKeyframeStatements=[],this.cssRegex=new RegExp("([\\s\\S]*?){([\\s\\S]*?)}","gi"),this.cssMediaQueryRegex="((@media [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.cssKeyframeRegex="((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.combinedCSSRegex="((\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",this.cssCommentsRegex="(\\/\\*[\\s\\S]*?\\*\\/)",this.cssImportStatementRegex=new RegExp("@import .*?;","gi")};l.prototype.stripComments=function(a){var f=new RegExp(this.cssCommentsRegex,"gi");return a.replace(f,"")};l.prototype.parseCSS=function(a){if(a===void 0)return[];for(var f=[];;){var e=this.cssImportStatementRegex.exec(a);if(e!==null)this.cssImportStatements.push(e[0]),f.push({selector:"@imports",type:"imports",styles:e[0]});else break}a=a.replace(this.cssImportStatementRegex,"");for(var t=new RegExp(this.cssKeyframeRegex,"gi"),r;r=t.exec(a),r!==null;)f.push({selector:"@keyframes",type:"keyframes",styles:r[0]});a=a.replace(t,"");for(var n=new RegExp(this.combinedCSSRegex,"gi");r=n.exec(a),r!==null;){var i="";r[2]===void 0?i=r[5].split(`\r
`).join(`
`).trim():i=r[2].split(`\r
`).join(`
`).trim();var s=new RegExp(this.cssCommentsRegex,"gi"),o=s.exec(i);if(o!==null&&(i=i.replace(s,"").trim()),i.indexOf("@media")!==-1){var u={selector:i,type:"media",subStyles:this.parseCSS(r[3]+`
}`)};o!==null&&(u.comments=o[0]),f.push(u)}else{var oe=this.parseRules(r[6]),A={selector:i,rules:oe};i==="@font-face"&&(A.type="font-face"),o!==null&&(A.comments=o[0]),f.push(A)}}return f};l.prototype.parseRules=function(a){a=a.split(`\r
`).join(`
`);var f=[];a=a.split(/;(?![^\(]*\))/);for(var e=0;e<a.length;e++){var t=a[e];if(t=t.trim(),t.indexOf(":")!==-1){t=t.split(":");var r=t[0].trim(),n=t.slice(1).join(":").trim();if(r.length<1||n.length<1)continue;f.push({directive:r,value:n})}else t.trim().substr(0,7)=="base64,"?f[f.length-1].value+=t.trim():t.length>0&&f.push({directive:"",value:t,defective:!0})}return f};l.prototype.findCorrespondingRule=function(a,f,e){e===void 0&&(e=!1);for(var t=!1,r=0;r<a.length&&!(a[r].directive==f&&(t=a[r],e===a[r].value));r++);return t};l.prototype.findBySelector=function(a,f,e){e===void 0&&(e=!1);for(var t=[],r=0;r<a.length;r++)e===!1?a[r].selector===f&&t.push(a[r]):a[r].selector.indexOf(f)!==-1&&t.push(a[r]);if(t.length<2)return t;var n=t[0];for(r=1;r<t.length;r++)this.intelligentCSSPush([n],t[r]);return[n]};l.prototype.deleteBySelector=function(a,f){for(var e=[],t=0;t<a.length;t++)a[t].selector!==f&&e.push(a[t]);return e};l.prototype.compressCSS=function(a){for(var f=[],e={},t=0;t<a.length;t++){var r=a[t];if(e[r.selector]!==!0){var n=this.findBySelector(a,r.selector);n.length!==0&&(f.push(n[0]),e[r.selector]=!0)}}return f};l.prototype.cssDiff=function(a,f){if(a.selector!==f.selector||a.type==="media"||f.type==="media")return!1;for(var e={selector:a.selector,rules:[]},t,r,n=0;n<a.rules.length;n++)t=a.rules[n],r=this.findCorrespondingRule(f.rules,t.directive,t.value),(r===!1||t.value!==r.value)&&e.rules.push(t);for(var i=0;i<f.rules.length;i++)r=f.rules[i],t=this.findCorrespondingRule(a.rules,r.directive),t===!1&&(r.type="DELETED",e.rules.push(r));return e.rules.length===0?!1:e};l.prototype.intelligentMerge=function(a,f,e){e===void 0&&(e=!1);for(var t=0;t<f.length;t++)this.intelligentCSSPush(a,f[t],e);for(t=0;t<a.length;t++){var r=a[t];r.type==="media"||r.type==="keyframes"||(r.rules=this.compactRules(r.rules))}};l.prototype.intelligentCSSPush=function(a,f,e){var t=f.selector,r=!1;if(e===void 0&&(e=!1),e===!1){for(var n=0;n<a.length;n++)if(a[n].selector===f.selector){r=a[n];break}}else for(var i=a.length-1;i>-1;i--)if(a[i].selector===f.selector){r=a[i];break}if(r===!1)a.push(f);else if(f.type!=="media")for(var s=0;s<f.rules.length;s++){var o=f.rules[s],u=this.findCorrespondingRule(r.rules,o.directive);u===!1?r.rules.push(o):o.type=="DELETED"?u.type="DELETED":u.value=o.value}else r.subStyles=f.subStyles};l.prototype.compactRules=function(a){for(var f=[],e=0;e<a.length;e++)a[e].type!=="DELETED"&&f.push(a[e]);return f};l.prototype.getCSSForEditor=function(a,f){f===void 0&&(f=0);var e="";a===void 0&&(a=this.css);for(var t=0;t<a.length;t++)a[t].type=="imports"&&(e+=a[t].styles+`

`);for(t=0;t<a.length;t++){var r=a[t];if(r.selector!==void 0){var n="";r.comments!==void 0&&(n=r.comments+`
`),r.type=="media"?(e+=n+r.selector+`{
`,e+=this.getCSSForEditor(r.subStyles,f+1),e+=`}

`):r.type!=="keyframes"&&r.type!=="imports"&&(e+=this.getSpaces(f)+n+r.selector+` {
`,e+=this.getCSSOfRules(r.rules,f+1),e+=this.getSpaces(f)+`}

`)}}for(t=0;t<a.length;t++)a[t].type=="keyframes"&&(e+=a[t].styles+`

`);return e};l.prototype.getImports=function(a){for(var f=[],e=0;e<a.length;e++)a[e].type=="imports"&&f.push(a[e].styles);return f};l.prototype.getCSSOfRules=function(a,f){for(var e="",t=0;t<a.length;t++)a[t]!==void 0&&(a[t].defective===void 0?e+=this.getSpaces(f)+a[t].directive+" : "+a[t].value+`;
`:e+=this.getSpaces(f)+a[t].value+`;
`);return e||`
`};l.prototype.getSpaces=function(a){for(var f="",e=0;e<a*4;e++)f+=" ";return f};l.prototype.applyNamespacing=function(a,f){var e=a,t="."+this.cssPreviewNamespace;f!==void 0&&(t=f),typeof a=="string"&&(e=this.parseCSS(a));for(var r=0;r<e.length;r++){var n=e[r];if(!(n.selector.indexOf("@font-face")>-1||n.selector.indexOf("keyframes")>-1||n.selector.indexOf("@import")>-1||n.selector.indexOf(".form-all")>-1||n.selector.indexOf("#stage")>-1))if(n.type!=="media"){for(var i=n.selector.split(","),s=[],o=0;o<i.length;o++)i[o].indexOf(".supernova")===-1?s.push(t+" "+i[o]):s.push(i[o]);n.selector=s.join(",")}else n.subStyles=this.applyNamespacing(n.subStyles,f)}return e};l.prototype.clearNamespacing=function(a,f){f===void 0&&(f=!1);var e=a,t="."+this.cssPreviewNamespace;typeof a=="string"&&(e=this.parseCSS(a));for(var r=0;r<e.length;r++){var n=e[r];if(n.type!=="media"){for(var i=n.selector.split(","),s=[],o=0;o<i.length;o++)s.push(i[o].split(t+" ").join(""));n.selector=s.join(",")}else n.subStyles=this.clearNamespacing(n.subStyles,!0)}return f===!1?this.getCSSForEditor(e):e};l.prototype.createStyleElement=function(a,f,e){if(e===void 0&&(e=!1),this.testMode===!1&&e!=="nonamespace"&&(f=this.applyNamespacing(f)),typeof f!="string"&&(f=this.getCSSForEditor(f)),e===!0&&(f=this.getCSSForEditor(this.parseCSS(f))),this.testMode!==!1)return this.testMode("create style #"+a,f);var t=document.getElementById(a);t&&t.parentNode.removeChild(t);var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.id=a,n.type="text/css",r.appendChild(n),n.styleSheet&&!n.sheet?n.styleSheet.cssText=f:n.appendChild(document.createTextNode(f))};var ne=l;var he=new RegExp(`{${w}:[^{}]+}`,"g"),ie={Sin:"return Math.round(1000*Math.sin(time/5000));",Cos:"return Math.round(1000*Math.cos(time/5000));",Random:`var value = prevValue + Math.random() * 100 - 50;
var multiplier = Math.pow(10, 2 || 0);
var value = Math.round(value * multiplier) / multiplier;
if (value < -1000) {
	value = -1000;
} else if (value > 1000) {
	value = 1000;
}
return value;`},se=[];for(let a of Object.keys(ie))se.push(a);var fe=[d.createdTime.keyName,d.originator.keyName,d.type.keyName,d.severity.keyName,d.status.keyName],_e=(()=>{class a{constructor(e,t,r,n,i){this.window=e,this.document=t,this.zone=r,this.datePipe=n,this.translate=i,this.iframeMode=!1,this.widgetEditMode=!1,this.editWidgetInfo=null,this.defaultDataKey={name:"f(x)",type:S.function,label:"Sin",color:this.getMaterialColor(0),funcBody:this.getPredefinedFunctionBody("Sin"),settings:{},_hash:Math.random()},this.defaultDatasource={type:D.function,name:D.function,dataKeys:[h(this.defaultDataKey)]},this.defaultAlarmDataKeys=[];let s=null;try{s=e.frameElement}catch{}if(s){this.iframeMode=!0;let o=s.getAttribute("data-widget");o&&o.length&&(this.editWidgetInfo=JSON.parse(o),this.widgetEditMode=!0)}}getPredefinedFunctionsList(){return se}getPredefinedFunctionBody(e){return ie[e]}getDefaultDatasource(e){let t=h(this.defaultDatasource);return e?.length&&(t.dataKeys[0].settings=te(e)),t}initDefaultAlarmDataKeys(){for(let e=0;e<fe.length;e++){let t=fe[e],r={name:t,type:S.alarm,label:this.translate.instant(d[t].name),color:this.getMaterialColor(e),settings:{},_hash:Math.random()};this.defaultAlarmDataKeys.push(r)}}getDefaultAlarmDataKeys(){return this.defaultAlarmDataKeys.length||this.initDefaultAlarmDataKeys(),h(this.defaultAlarmDataKeys)}defaultAlarmFieldContent(e,t){if(b(t)){let r=d[e.name];if(r){if(r.time)return t?this.datePipe.transform(t,"yyyy-MM-dd HH:mm:ss"):"";if(r===d.severity)return this.translate.instant(X.get(t));if(r===d.status)return C.get(t)?this.translate.instant(C.get(t)):t;if(r===d.originatorType)return this.translate.instant(U.get(t).type);if(r.value===d.assignee.value)return""}return t}return""}processWidgetException(e){let t=this.parseException(e,-6);if(t.message?.startsWith("NG0")&&(t.message=`${this.translate.instant("widget.widget-template-error")}<br/>
                       <br/><i>${this.translate.instant("dialog.error-message-title")}</i><br/><br/>${t.message}`),this.widgetEditMode){let r={type:"widgetException",data:t};this.window.parent.postMessage(JSON.stringify(r),"*")}return t}parseException(e,t){return B(e,t)}customTranslation(e,t=e){if(e&&H(e))if(e.includes(`{${w}`)){let r=e.match(he),n=e;for(let i of r){let s=i.substring(6,i.length-1);n=n.replace(i,this.doTranslate(s,i))}return n}else return this.doTranslate(e,t,L);else return e}doTranslate(e,t,r){let n,i;r?i=r+e:i=e;let s=this.translate.instant(i);return s!==i?n=s+"":n=t,n}guid(){return E()}getMaterialColor(e){let t=e%g.length;return g[t].value}createKey(e,t,r=-1){let n;if(t===S.alarm&&!e.label){let s=d[e.name];s&&(n=this.translate.instant(s.name))}n||(n=e.label||e.name);let i={name:e.name,type:t,label:n,funcBody:e.funcBody,settings:{},_hash:Math.random()};return e.units&&(i.units=e.units),b(e.decimals)&&(i.decimals=e.decimals),e.color?i.color=e.color:r>-1&&(i.color=this.getMaterialColor(r)),O(e.postFuncBody)&&(i.usePostProcessing=!0,i.postFuncBody=e.postFuncBody),i}createLabelFromDatasource(e,t){return Y(e,t)}generateColors(e){let t=0;e.forEach(r=>{r.dataKeys.forEach(n=>{n.color||(n.color=this.getMaterialColor(t)),t++})})}stringToHslColor(e,t,r){if(e&&e.length)return`hsl(${G(e)%360}, ${t}%, ${r}%)`}currentPerfTime(){return this.window.performance&&this.window.performance.now?this.window.performance.now():Date.now()}getQueryParam(e,t=this.window.location.href){e=e.replace(/[\[\]]/g,"\\$&");let n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}removeQueryParams(e){let t=this.window.location.search;for(let n of e)t=this.updateUrlQueryString(t,n,null);let r=[v(),this.window.location.pathname].join("");this.window.history.replaceState({},"",r+t)}updateQueryParam(e,t){let r=[v(),this.window.location.pathname].join(""),n=this.window.location.search,i=this.updateUrlQueryString(n,e,t);this.window.history.replaceState({},"",r+i)}updateUrlQueryString(e,t,r){let n="",i="";if(r!==null&&(n=t+"="+r),e){let s=new RegExp("([?&])"+t+"[^&]*");e.match(s)!==null?(n&&(n="$1"+n),i=e.replace(s,n),i.startsWith("&")&&(i="?"+i.substring(1))):n&&(i=e+"&"+n)}else n&&(i="?"+n);return i}baseUrl(){return v()}deepClone(e,t){return h(e,t)}isUndefined(e){return Q(e)}isDefined(e){return b(e)}isDefinedAndNotNull(e){return x(e)}defaultValue(e,t){return x(e)?e:t}getEntityIdFromDatasource(e){return{id:e.entityId,entityType:e.entityType}}subscribeToEntityTelemetry(e,t,r=V.LATEST_TELEMETRY,n=null){!t&&e.datasources.length>0&&(t=this.getEntityIdFromDatasource(e.datasources[0]));let i=j.createEntityAttributesSubscription(e.telemetryWsService,t,r,e.ngZone,n);return e.telemetrySubscribers||(e.telemetrySubscribers=[]),e.telemetrySubscribers.push(i),i.subscribe(),i.attributeData$.pipe(N(1),P())}objToBase64(e){return _(e)}base64toString(e){return Z(e)}objToBase64URI(e){return J(e)}base64toObj(e){return z(e)}applyCssToElement(e,t,r,n){let i=new ne;i.testMode=!1;let s=`${r}-${E()}`;return i.cssPreviewNamespace=s,i.createStyleElement(s,n),e.addClass(t,s),s}clearCssElement(e,t,r){r&&e.removeClass(r,t);let n=this.document.getElementById(t);n&&n.parentNode.removeChild(n)}static{this.\u0275fac=function(t){return new(t||a)(p(R),p(K),p(k),p(W),p(q))}}static{this.\u0275prov=y({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{R as a,m as b,de as c,ce as d,ue as e,pe as f,be as g,re as h,g as i,ne as j,_e as k};
