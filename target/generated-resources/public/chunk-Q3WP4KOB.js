import{a as _}from"./chunk-DFNQZZG4.js";import{Bc as W,Jc as D}from"./chunk-HA3FE6NY.js";import{Eh as S,hg as F,jg as B,kg as Y,mh as L}from"./chunk-PQ6EZO2H.js";import{a as v,b as R,g as O,i as P}from"./chunk-GHMOB5KC.js";P();var V=O(_());var j=V.GenericOptions,U=V.BaseGauge,N=R(v({},j),{gaugeType:"arc",gaugeWithScale:.75,dashThickness:0,roundedLineCap:!1,gaugeColor:"#777",barColorProcessor:D.fromSettings(W("blue")),symbol:"",hideValue:!1,hideMinMax:!1,fontTitle:"Roboto",fontValue:"Roboto",fontMinMaxSize:10,fontMinMaxStyle:"normal",fontMinMaxWeight:"500",colorMinMax:"#eee",fontMinMax:"Roboto",fontLabelSize:8,fontLabelStyle:"normal",fontLabelWeight:"500",colorLabel:"#eee",fontLabel:"Roboto",neonGlowBrightness:0,colorTicks:"gray",tickWidth:4,ticks:[],isMobile:!1});U.initialize("CanvasDigitalGauge",N);var C=class{static font(a,i,l){return a["font"+i+"Style"]+" "+a["font"+i+"Weight"]+" "+a["font"+i+"Size"]*l+"px "+a["font"+i]}static normalizedValue(a){let i=a.value,l=a.minValue,r=a.maxValue,s=(r-l)*.01;return{normal:i<l?l:i>r?r:i,indented:i<l?l-s:i>r?r+s:i}}static verifyError(a){if(!(a instanceof DOMException&&a.result===2152923147))throw a}},G=(()=>{class t extends U{static{this.heightCache={}}constructor(i){i=v(v({},N),i||{}),super(t.configure(i)),this.initValueClone()}static configure(i){i.value>i.maxValue&&(i.value=i.maxValue),i.value<i.minValue&&(i.value=i.minValue),i.gaugeType==="donut"&&(Y(i.donutStartAngle)||(i.donutStartAngle=1.5*Math.PI),Y(i.donutEndAngle)||(i.donutEndAngle=i.donutStartAngle+2*Math.PI)),i.ticksValue=[];for(let l of i.ticks)l!==null&&i.ticksValue.push(t.normalizeValue(l,i.minValue,i.maxValue));return i.neonGlowBrightness&&(i.neonColorTitle=S(i.colorTitle).brighten(i.neonGlowBrightness).toRgbString(),i.neonColorLabel=S(i.colorLabel).brighten(i.neonGlowBrightness).toRgbString(),i.neonColorValue=S(i.colorValue).brighten(i.neonGlowBrightness).toRgbString(),i.neonColorMinMax=S(i.colorMinMax).brighten(i.neonGlowBrightness).toRgbString()),i}static normalizeValue(i,l,r){let s=(i-l)/(r-l);return s<=0?0:s>=1?1:s}initValueClone(){let i=this.canvas;this.elementValueClone=i.element.cloneNode(!0),this.contextValueClone=this.elementValueClone.getContext("2d"),this.elementValueClone.initialized=!1,this.contextValueClone.translate(i.drawX,i.drawY),this.contextValueClone.save(),this.elementProgressClone=i.element.cloneNode(!0),this.contextProgressClone=this.elementProgressClone.getContext("2d"),this.elementProgressClone.initialized=!1,this.contextProgressClone.translate(i.drawX,i.drawY),this.contextProgressClone.save()}destroy(){this.contextValueClone=null,this.elementValueClone=null,this.contextProgressClone=null,this.elementProgressClone=null,super.destroy()}update(i){this.canvas.onRedraw=null;let l=super.update(i);return this.initValueClone(),this.canvas.onRedraw=this.draw.bind(this),this.draw(),l}set timestamp(i){this.options.timestamp=i,this.draw()}get timestamp(){return this.options.timestamp}draw(){try{let i=this.canvas;if(!i.drawWidth||!i.drawHeight)return this;let[l,r,s,e]=[-i.drawX,-i.drawY,i.drawWidth,i.drawHeight],n=this.options,f=i.elementClone;if(!f.initialized){let o=i.contextClone;o.clearRect(l,r,s,e),o.save();let g=i.context;g.barDimensions=q(o,n,l,r,s,e),this.contextValueClone.barDimensions=g.barDimensions,this.contextProgressClone.barDimensions=g.barDimensions,J(o,n),K(o,n),n.showUnitTitle&&A(o,n,n.unitTitle,"labelY"),Q(o,n),f.initialized=!0}let d=!1;if(!this.elementValueClone.initialized||B(this._value)&&this.elementValueClone.renderedValue!==this._value||n.showTimestamp&&this.elementValueClone.renderedTimestamp!==this.timestamp){B(this._value)&&(this.elementValueClone.renderedValue=this._value),F(this.elementValueClone.renderedValue)&&(this.elementValueClone.renderedValue=this.value);let o=this.contextValueClone;o.clearRect(l,r,s,e),o.drawImage(i.elementClone,l,r,s,e),Z(o,n,this.elementValueClone.renderedValue),n.showTimestamp&&(A(o,n,n.labelTimestamp,"timeseriesLabelY"),this.elementValueClone.renderedTimestamp=this.timestamp),this.elementValueClone.initialized=!0,d=!0}let h=(C.normalizedValue(n).normal-n.minValue)/(n.maxValue-n.minValue),u=h.toFixed(3);if(!this.elementProgressClone.initialized||this.elementProgressClone.renderedProgress!==u||d){let o=this.contextProgressClone;o.clearRect(l,r,s,e),o.drawImage(this.elementValueClone,l,r,s,e),Number(u)>0&&x(o,n,h),this.elementProgressClone.initialized=!0,this.elementProgressClone.renderedProgress=u}this.canvas.commit(),i.context.clearRect(l,r,s,e),i.context.drawImage(this.elementProgressClone,l,r,s,e),super.draw()}catch(i){C.verifyError(i)}return this}getValueColor(){if(this.contextProgressClone){let i=this.contextProgressClone.currentColor,l=this.options;if(!i){l.barColorProcessor.update(l.value);let r=S(l.barColorProcessor.color);l.neonGlowBrightness?i=r.brighten(l.neonGlowBrightness).toRgbString():i=r.toRgbString()}return i}else return"#000"}}return t})();function q(t,a,i,l,r,s){t.barDimensions={baseX:i,baseY:l,width:r,height:s};let e=t.barDimensions,n=1;a.gaugeType==="horizontalBar"?n=a.title===""?2.5:2:a.gaugeType==="verticalBar"?n=a.hideMinMax?.35:.5:a.gaugeType==="arc"&&(n=1.5),r/s>n?(e.width=s*n,e.height=s):(e.width=r,e.height=r/n),e.origBaseX=e.baseX,e.origBaseY=e.baseY,e.baseX+=(r-e.width)/2,e.baseY+=(s-e.height)/2,a.gaugeType==="donut"?e.fontSizeFactor=Math.max(e.width,e.height)/125:a.gaugeType==="verticalBar"||a.gaugeType==="arc"&&a.title===""?e.fontSizeFactor=Math.max(e.width,e.height)/150:e.fontSizeFactor=Math.max(e.width,e.height)/200;let d=a.gaugeWidthScale;if(a.neonGlowBrightness&&(a.fontTitleHeight=M(a,"Title",e.fontSizeFactor),a.fontLabelHeight=M(a,"Label",e.fontSizeFactor),a.fontValueHeight=M(a,"Value",e.fontSizeFactor),a.fontMinMaxHeight=M(a,"MinMax",e.fontSizeFactor)),a.gaugeType==="donut"){if(e.Ro=e.width/2-e.width/20,e.Cy=e.baseY+e.height/2,a.title&&typeof a.title=="string"&&a.title.length>0){let h=M(a,"Title",e.fontSizeFactor).height;h+=e.fontSizeFactor*2,e.titleY=e.baseY+h,h+=e.fontSizeFactor*2,e.Cy+=h/2,e.Ro-=h/2}e.Ri=e.Ro-e.width/6.666666666666667*d*1.2,e.Cx=e.baseX+e.width/2}else a.gaugeType==="arc"?(a.title&&typeof a.title=="string"&&a.title.length>0?(e.Ro=e.width/2-e.width/7,e.Ri=e.Ro-e.width/6.666666666666667*d):(e.Ro=e.width/2-e.fontSizeFactor*4,e.Ri=e.Ro-e.width/6.666666666666667*d*1.2),e.Cx=e.baseX+e.width/2,e.Cy=e.baseY+e.height/1.25):a.gaugeType==="verticalBar"?(e.Ro=e.width/2-e.width/10,e.Ri=e.Ro-e.width/6.666666666666667*d*(a.hideMinMax?4:2.5)):(e.Ro=e.width/2-e.width/10,e.Ri=e.Ro-e.width/6.666666666666667*d);if(e.strokeWidth=e.Ro-e.Ri,e.Rm=e.Ri+e.strokeWidth*.5,e.fontValueBaseline="alphabetic",e.fontMinMaxBaseline="alphabetic",e.fontMinMaxAlign="center",a.gaugeType==="donut")if(e.fontValueBaseline="middle",a.showUnitTitle||a.showTimestamp){let h=M(a,"Value",e.fontSizeFactor).height,u=M(a,"Label",e.fontSizeFactor).height,o=h+u;e.labelY=e.Cy+o/2,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),e.valueY=e.Cy-o/2+h/2}else e.valueY=e.Cy;else if(a.gaugeType==="arc")e.titleY=e.Cy-e.Ro-12*e.fontSizeFactor,e.valueY=e.Cy,e.labelY=e.Cy+(8+a.fontLabelSize)*e.fontSizeFactor,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),e.minY=e.maxY=e.labelY,a.roundedLineCap&&(e.minY+=e.strokeWidth/2,e.maxY+=e.strokeWidth/2),e.minX=e.Cx-e.Rm,e.maxX=e.Cx+e.Rm;else if(a.gaugeType==="horizontalBar")if(e.titleY=e.baseY+4*e.fontSizeFactor+(a.title===""?0:a.fontTitleSize*e.fontSizeFactor),e.titleBottom=e.titleY+(a.title===""?0:4)*e.fontSizeFactor,e.valueY=e.titleBottom+(a.hideValue?0:a.fontValueSize*e.fontSizeFactor),e.barTop=e.valueY+8*e.fontSizeFactor,e.barBottom=e.barTop+e.strokeWidth,a.hideMinMax&&!a.showUnitTitle&&!a.showTimestamp)e.labelY=e.barBottom,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),e.barLeft=e.origBaseX+a.fontMinMaxSize/3*e.fontSizeFactor,e.barRight=e.origBaseX+r+-a.fontMinMaxSize/3*e.fontSizeFactor;else{t.font=C.font(a,"MinMax",e.fontSizeFactor);let h=t.measureText(a.minValue+"").width,u=t.measureText(a.maxValue+"").width,o=Math.max(h,u);e.minX=e.origBaseX+o/2+a.fontMinMaxSize/3*e.fontSizeFactor,e.maxX=e.origBaseX+r+-o/2-a.fontMinMaxSize/3*e.fontSizeFactor,e.barLeft=e.minX,e.barRight=e.maxX,e.labelY=e.barBottom+(8+a.fontLabelSize)*e.fontSizeFactor,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),e.minY=e.maxY=e.labelY}else a.gaugeType==="verticalBar"&&(e.titleY=e.baseY+((a.title===""?0:a.fontTitleSize)+8)*e.fontSizeFactor,e.titleBottom=e.titleY+(a.title===""?0:4)*e.fontSizeFactor,e.valueY=e.titleBottom+(a.hideValue?0:a.fontValueSize*e.fontSizeFactor),e.barTop=e.valueY+8*e.fontSizeFactor,e.labelY=e.baseY+e.height,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),a.showUnitTitle||a.showTimestamp?e.barBottom=e.labelY-a.fontLabelSize*e.fontSizeFactor:e.barBottom=e.labelY,e.minX=e.maxX=e.baseX+e.width/2+e.strokeWidth/2+a.fontMinMaxSize/3*e.fontSizeFactor,e.minY=e.barBottom,e.maxY=e.barTop,e.fontMinMaxBaseline="middle",e.fontMinMaxAlign="left");if(a.dashThickness){let h;a.gaugeType==="donut"?h=Math.PI*e.Rm*2:a.gaugeType==="arc"?h=Math.PI*e.Rm:a.gaugeType==="horizontalBar"?h=e.barRight-e.barLeft:a.gaugeType==="verticalBar"&&(h=e.barBottom-e.barTop);let u=Math.floor(h/(a.dashThickness*e.fontSizeFactor));a.gaugeType==="donut"?u=(u|1)-1:u=u-1|1,e.dashLength=Math.ceil(h/u)}return e}function y(t,a,i){return t.showUnitTitle?a+t.fontLabelSize*i*1.2:a}function M(t,a,i){let l="font-style:"+t["font"+a+"Style"]+";font-weight:"+t["font"+a+"Weight"]+";font-size:"+t["font"+a+"Size"]*i+"px;font-family:"+t["font"+a],r=G.heightCache[l];if(!r){let s={fontFamily:t["font"+a],fontSize:t["font"+a+"Size"]*i+"px",fontWeight:t["font"+a+"Weight"],fontStyle:t["font"+a+"Style"]},e=$("<span>Hg</span>").css(s),n=$('<div style="display: inline-block; width: 1px; height: 0;"></div>'),f=$("<div></div>");f.append(e,n),$("body").append(f);try{r={},n.css({verticalAlign:"baseline"}),r.ascent=n.offset().top-e.offset().top,n.css({verticalAlign:"bottom"}),r.height=n.offset().top-e.offset().top,r.descent=r.height-r.ascent}finally{f.remove()}G.heightCache[l]=r}return r}function J(t,a){let{barLeft:i,barRight:l,barTop:r,barBottom:s,width:e,baseX:n,strokeWidth:f}=t.barDimensions;t.barDimensions.dashLength&&t.setLineDash([t.barDimensions.dashLength]),t.beginPath(),t.strokeStyle=a.gaugeColor,t.lineWidth=f,a.roundedLineCap&&(t.lineCap="round"),a.gaugeType==="donut"?(t.arc(t.barDimensions.Cx,t.barDimensions.Cy,t.barDimensions.Rm,a.donutStartAngle,a.donutEndAngle),t.stroke()):a.gaugeType==="arc"?(t.arc(t.barDimensions.Cx,t.barDimensions.Cy,t.barDimensions.Rm,Math.PI,2*Math.PI),t.stroke()):a.gaugeType==="horizontalBar"?(t.moveTo(i,r+f/2),t.lineTo(l,r+f/2),t.stroke()):a.gaugeType==="verticalBar"&&(t.moveTo(n+e/2,s),t.lineTo(n+e/2,r),t.stroke())}function z(t,a,i,l,r,s){t.fillStyle=a[(a.neonGlowBrightness?"neonColor":"color")+i],t.fillText(l,r,s)}function K(t,a){if(!a.title||typeof a.title!="string")return;let{titleY:i,width:l,baseX:r,fontSizeFactor:s}=t.barDimensions,e=Math.round(r+l/2),n=i;t.save(),t.textAlign="center",t.font=C.font(a,"Title",s),t.lineWidth=0,z(t,a,"Title",a.title.toUpperCase(),e,n),t.restore()}function A(t,a,i,l){if(!i||i==="")return;let{baseX:r,width:s,fontSizeFactor:e}=t.barDimensions,n=Math.round(r+s/2),f=t.barDimensions[l];t.save(),t.textAlign="center",t.font=C.font(a,"Label",e),t.lineWidth=0,z(t,a,"Label",i,n,f),t.restore()}function Q(t,a){if(a.hideMinMax||a.gaugeType==="donut")return;let{minY:i,maxY:l,minX:r,maxX:s,fontSizeFactor:e,fontMinMaxAlign:n,fontMinMaxBaseline:f}=t.barDimensions;t.save(),t.textAlign=n,t.textBaseline=f,t.font=C.font(a,"MinMax",e),t.lineWidth=0,z(t,a,"MinMax",a.minValue+"",r,i),z(t,a,"MinMax",a.maxValue+"",s,l),t.restore()}function Z(t,a,i){if(a.hideValue)return;let{valueY:l,baseX:r,width:s,fontSizeFactor:e,fontValueBaseline:n}=t.barDimensions,f=Math.round(r+s/2),d=l,h=a.valueText||L(i,a.valueDec);h+=a.symbol,t.save(),t.textAlign="center",t.textBaseline=n,t.font=C.font(a,"Value",e),t.lineWidth=0,z(t,a,"Value",h,f,d),t.restore()}function X(t,a,i,l,r,s,e,n,f,d,h){t.setLineDash([]);let u=s-l,o=.55,g=u*o;t.lineWidth=u+g;let b=o/(2*o+2),m=t.createRadialGradient(a,i,l-g/2,a,i,s+g/2),c=S(e).setAlpha(.5).toRgbString(),T=S(e).setAlpha(0).toRgbString();m.addColorStop(0,T),m.addColorStop(b,c),m.addColorStop(1-b,c),m.addColorStop(1,T),t.strokeStyle=m,t.beginPath();let w=.01*Math.PI;f?t.arc(a,i,r,d-w,d+(h-d)*n+w):t.arc(a,i,r,Math.PI-w,Math.PI+Math.PI*n+w),t.stroke()}function I(t,a,i,l,r,s,e,n){t.setLineDash([]);let f=.55,d=e*f;t.lineWidth=e+d;let h=f/(2*f+2),u=n?a-t.lineWidth/2:0,o=n?0:i-t.lineWidth/2,g=n?a+t.lineWidth/2:0,b=n?0:i+t.lineWidth/2,m=t.createLinearGradient(u,o,g,b),c=S(s).setAlpha(.5).toRgbString(),T=S(s).setAlpha(0).toRgbString();m.addColorStop(0,T),m.addColorStop(h,c),m.addColorStop(1-h,c),m.addColorStop(1,T),t.strokeStyle=m;let w=n?0:.05*t.lineWidth,k=n?.05*t.lineWidth:0;t.beginPath(),t.moveTo(a-w,i+k),t.lineTo(l+w,r-k),t.stroke()}function H(t,a,i,l,r,s,e,n,f,d,h){if(!a.length)return;let u=e-r;t.beginPath(),t.lineWidth=h,t.strokeStyle=d;for(let o of a){let g=n+o*f,b=i+(r+u)*Math.cos(g),m=l+(r+u)*Math.sin(g),c=i+r*Math.cos(g),T=l+r*Math.sin(g);t.moveTo(b,m),t.lineTo(c,T)}t.stroke()}function E(t,a,i,l,r,s,e,n,f){if(a.length){t.beginPath(),t.lineWidth=f,t.strokeStyle=n;for(let d of a){let h=d*r;e?(t.moveTo(i-s/2,l+h-r),t.lineTo(i+s/2,l+h-r)):(t.moveTo(i+h,l),t.lineTo(i+h,l+s))}t.stroke()}}function x(t,a,i){let l;t.save(),a.barColorProcessor.update(a.value);let r=S(a.barColorProcessor.color);a.neonGlowBrightness?t.currentColor=l=r.brighten(a.neonGlowBrightness).toRgbString():t.currentColor=t.strokeStyle=r.toRgbString();let{barLeft:s,barRight:e,barTop:n,baseX:f,width:d,barBottom:h,Cx:u,Cy:o,Rm:g,Ro:b,Ri:m,strokeWidth:c}=t.barDimensions;t.barDimensions.dashLength&&t.setLineDash([t.barDimensions.dashLength]),t.lineWidth=c,a.roundedLineCap?t.lineCap="round":t.lineCap="butt",a.gaugeType==="donut"?(a.neonGlowBrightness&&(t.strokeStyle=l),t.beginPath(),t.arc(u,o,g,a.donutStartAngle,a.donutStartAngle+(a.donutEndAngle-a.donutStartAngle)*i),t.stroke(),a.neonGlowBrightness&&!a.isMobile&&X(t,u,o,m,g,b,l,i,!0,a.donutStartAngle,a.donutEndAngle),H(t,a.ticksValue,u,o,m,g,b,a.donutStartAngle,a.donutEndAngle-a.donutStartAngle,a.colorTicks,a.tickWidth)):a.gaugeType==="arc"?(a.neonGlowBrightness&&(t.strokeStyle=l),t.beginPath(),t.arc(u,o,g,Math.PI,Math.PI+Math.PI*i),t.stroke(),a.neonGlowBrightness&&!a.isMobile&&X(t,u,o,m,g,b,l,i,!1),H(t,a.ticksValue,u,o,m,g,b,Math.PI,Math.PI,a.colorTicks,a.tickWidth)):a.gaugeType==="horizontalBar"?(a.neonGlowBrightness&&(t.strokeStyle=l),t.beginPath(),t.moveTo(s,n+c/2),t.lineTo(s+(e-s)*i,n+c/2),t.stroke(),a.neonGlowBrightness&&!a.isMobile&&I(t,s,n+c/2,s+(e-s)*i,n+c/2,l,c,!1),E(t,a.ticksValue,s,n,e-s,c,!1,a.colorTicks,a.tickWidth)):a.gaugeType==="verticalBar"&&(a.neonGlowBrightness&&(t.strokeStyle=l),t.beginPath(),t.moveTo(f+d/2,h),t.lineTo(f+d/2,h-(h-n)*i),t.stroke(),a.neonGlowBrightness&&!a.isMobile&&I(t,f+d/2,h,f+d/2,h-(h-n)*i,l,c,!0),E(t,a.ticksValue,f+d/2,n,n-h,c,!0,a.colorTicks,a.tickWidth)),t.restore()}export{C as a,G as b};
